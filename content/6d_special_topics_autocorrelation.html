<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="NIMBLE Development Team" />
  <title>Autocorrelation Functions in NIMBLE</title>
  <style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
  <script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
  <style type="text/css">
body
{
margin: 0 0 0 0;
padding: 0 0 0 0;
width: 100%;
height: 100%;
color: black;
background-color: white;
font-family: "Gill Sans MT", "Gill Sans", GillSans, sans-serif;
font-size: 14pt;
}
div.toolbar {
position: fixed; z-index: 200;
top: auto; bottom: 0; left: 0; right: 0;
height: 1.2em; text-align: right;
padding-left: 1em;
padding-right: 1em; font-size: 60%;
color: DimGray;
background-color: rgb(240,240,240);
border-top: solid 1px rgb(180,180,180);
}
div.toolbar span.copyright {
color: DimGray;
margin-left: 0.5em;
}
div.initial_prompt {
position: absolute;
z-index: 1000;
bottom: 1.2em;
width: 100%;
background-color: rgb(200,200,200);
opacity: 0.35;
background-color: rgb(200,200,200, 0.35);
cursor: pointer;
}
div.initial_prompt p.help {
text-align: center;
}
div.initial_prompt p.close {
text-align: right;
font-style: italic;
}
div.slidy_toc {
position: absolute;
z-index: 300;
width: 60%;
max-width: 30em;
height: 30em;
overflow: auto;
top: auto;
right: auto;
left: 4em;
bottom: 4em;
padding: 1em;
background: rgb(240,240,240);
border-style: solid;
border-width: 2px;
font-size: 60%;
}
div.slidy_toc .toc_heading {
text-align: center;
width: 100%;
margin: 0;
margin-bottom: 1em;
border-bottom-style: solid;
border-bottom-color: rgb(180,180,180);
border-bottom-width: 1px;
}
div.slide {
z-index: 20;
margin: 0 0 0 0;
padding-top: 0;
padding-bottom: 0;
padding-left: 20px;
padding-right: 20px;
border-width: 0;
clear: both;
top: 0;
bottom: 0;
left: 0;
right: 0;
line-height: 120%;
background-color: transparent;
}
div.background {
display: none;
}
div.handout {
margin-left: 20px;
margin-right: 20px;
}
div.slide.titlepage {
text-align: center;
}
div.slide.titlepage h1 {
padding-top: 10%;
margin-right: 0;
}
div.slide h1 {
padding-left: 0;
padding-right: 20pt;
padding-top: 4pt;
padding-bottom: 4pt;
margin-top: 0;
margin-left: 0;
margin-right: 60pt;
margin-bottom: 0.5em;
display: block; font-size: 160%;
line-height: 1.2em;
background: transparent;
}
@media screen and (max-device-width: 1024px)
{
div.slide { font-size: 100%; }
}
@media screen and (max-device-width: 800px)
{
div.slide { font-size: 200%; }
div.slidy_toc {
top: 1em;
left: 1em;
right: auto;
width: 80%;
font-size: 180%;
}
}
div.toc-heading {
width: 100%;
border-bottom: solid 1px rgb(180,180,180);
margin-bottom: 1em;
text-align: center;
}
img {
image-rendering: optimize-quality;
}
pre {
font-size: 80%;
font-weight: bold;
line-height: 120%;
padding-top: 0.2em;
padding-bottom: 0.2em;
padding-left: 1em;
padding-right: 1em;
border-style: solid;
border-left-width: 1em;
border-top-width: thin;
border-right-width: thin;
border-bottom-width: thin;
border-color: #95ABD0;
color: #00428C;
background-color: #E4E5E7;
}
li pre { margin-left: 0; }
blockquote { font-style: italic }
img { background-color: transparent }
p.copyright { font-size: smaller }
.center { text-align: center }
.footnote { font-size: smaller; margin-left: 2em; }
a img { border-width: 0; border-style: none }
a:visited { color: navy }
a:link { color: navy }
a:hover { color: red; text-decoration: underline }
a:active { color: red; text-decoration: underline }
a {text-decoration: none}
.toolbar a:link {color: blue}
.toolbar a:visited {color: blue}
.toolbar a:active {color: red}
.toolbar a:hover {color: red}
ul { list-style-type: square; }
ul ul { list-style-type: disc; }
ul ul ul { list-style-type: circle; }
ul ul ul ul { list-style-type: disc; }
li { margin-left: 0.5em; margin-top: 0.5em; }
li li { font-size: 85%; font-style: italic }
li li li { font-size: 85%; font-style: normal }
div dt
{
margin-left: 0;
margin-top: 1em;
margin-bottom: 0.5em;
font-weight: bold;
}
div dd
{
margin-left: 2em;
margin-bottom: 0.5em;
}
p,pre,ul,ol,blockquote,h2,h3,h4,h5,h6,dl,table {
margin-left: 1em;
margin-right: 1em;
}
p.subhead { font-weight: bold; margin-top: 2em; }
.smaller { font-size: smaller }
.bigger { font-size: 130% }
td,th { padding: 0.2em }
ul {
margin: 0.5em 1.5em 0.5em 1.5em;
padding: 0;
}
ol {
margin: 0.5em 1.5em 0.5em 1.5em;
padding: 0;
}
ul { list-style-type: square; }
ul ul { list-style-type: disc; }
ul ul ul { list-style-type: circle; }
ul ul ul ul { list-style-type: disc; }
ul li { list-style: square;
margin: 0.1em 0em 0.6em 0;
padding: 0 0 0 0;
line-height: 140%;
}
ol li { margin: 0.1em 0em 0.6em 1.5em;
padding: 0 0 0 0px;
line-height: 140%;
list-style-type: decimal;
}
li ul li { font-size: 85%; font-style: italic;
list-style-type: disc;
background: transparent;
padding: 0 0 0 0;
}
li li ul li { font-size: 85%; font-style: normal;
list-style-type: circle;
background: transparent;
padding: 0 0 0 0;
}
li li li ul li {
list-style-type: disc;
background: transparent;
padding: 0 0 0 0;
}
li ol li {
list-style-type: decimal;
}
li li ol li {
list-style-type: decimal;
}

ol.outline li:hover { cursor: pointer }
ol.outline li.nofold:hover { cursor: default }
ul.outline li:hover { cursor: pointer }
ul.outline li.nofold:hover { cursor: default }
ol.outline { list-style:decimal; }
ol.outline ol { list-style-type:lower-alpha }
ol.outline li.nofold {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAIACAMzMzOvr/ywAAAAACQAJAAACD4SPoRvG614Dctb4MEMcFAA7) no-repeat 0px 0.5em;
}
ol.outline li.unfolded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACEYyPoivG614LAlg7ZZbxoR8UADs=) no-repeat 0px 0.5em;
}
ol.outline li.folded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACFIyPoiu2sJyCyoF7W3hxz850CFIAADs=) no-repeat 0px 0.5em;
}
ol.outline li.unfolded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACEYSPoivG614DIlg7ZZbxoQ8UADs=) no-repeat 0px 0.5em;
}
ol.outline li.folded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACFISPoiu2sZyCyoV7G3hxz850CFIAADs=) no-repeat 0px 0.5em;
}
ul.outline li.nofold {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAIACAMzMzOvr/ywAAAAACQAJAAACD4SPoRvG614Dctb4MEMcFAA7) no-repeat 0px 0.5em;
}
ul.outline li.unfolded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACEYyPoivG614LAlg7ZZbxoR8UADs=) no-repeat 0px 0.5em;
}
ul.outline li.folded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACFIyPoiu2sJyCyoF7W3hxz850CFIAADs=) no-repeat 0px 0.5em;
}
ul.outline li.unfolded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACEYSPoivG614DIlg7ZZbxoQ8UADs=) no-repeat 0px 0.5em;
}
ul.outline li.folded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACFISPoiu2sZyCyoV7G3hxz850CFIAADs=) no-repeat 0px 0.5em;
}

a.titleslide { font-weight: bold; font-style: italic }

img.hidden { display: none; visibility: hidden }
div.initial_prompt { display: none; visibility: hidden }
div.slide {
visibility: visible;
position: inherit;
}
div.handout {
border-top-style: solid;
border-top-width: thin;
border-top-color: black;
}
@media screen {
.hidden { display: none; visibility: visible }
div.slide.hidden { display: block; visibility: visible }
div.handout.hidden { display: block; visibility: visible }
div.background { display: none; visibility: hidden }
body.single_slide div.initial_prompt { display: block; visibility: visible }
body.single_slide div.background { display: block; visibility: visible }
body.single_slide div.background.hidden { display: none; visibility: hidden }
body.single_slide .invisible { visibility: hidden }
body.single_slide .hidden { display: none; visibility: hidden }
body.single_slide div.slide { position: absolute }
body.single_slide div.handout { display: none; visibility: hidden }
}
@media print {
.hidden { display: block; visibility: visible }
div.slide pre { font-size: 60%; padding-left: 0.5em; }
div.toolbar { display: none; visibility: hidden; }
div.slidy_toc { display: none; visibility: hidden; }
div.background { display: none; visibility: hidden; }
div.slide { page-break-before: always }

div.slide.first-slide { page-break-before: avoid }
}


.jslider table {
margin-left: 0em;
margin-right: 0em;
}

table.dataTable, .shiny-datatable-output div {
font-size: 14pt;
}

.dataTables_info, .dataTables_paginate {
font-size: 19px;
}

pre.sourceCode, code.sourceCode {
font-size: 80%;
}

label, button, input, select, textarea {
font-size: 14pt;
}

ul.nav, ul.nav li {
list-style-type: none;
}
</style>
  <script src="data:application/javascript;base64,Lyogc2xpZHkuanMKCiAgIENvcHlyaWdodCAoYykgMjAwNS0yMDEzIFczQyAoTUlULCBFUkNJTSwgS2VpbyksIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAgIFczQyBsaWFiaWxpdHksIHRyYWRlbWFyaywgZG9jdW1lbnQgdXNlIGFuZCBzb2Z0d2FyZSBsaWNlbnNpbmcKICAgcnVsZXMgYXBwbHksIHNlZToKCiAgIGh0dHA6Ly93d3cudzMub3JnL0NvbnNvcnRpdW0vTGVnYWwvY29weXJpZ2h0LWRvY3VtZW50cwogICBodHRwOi8vd3d3LnczLm9yZy9Db25zb3J0aXVtL0xlZ2FsL2NvcHlyaWdodC1zb2Z0d2FyZQoKICAgRGVmaW5lcyBzaW5nbGUgbmFtZSAidzNjX3NsaWR5IiBpbiBnbG9iYWwgbmFtZXNwYWNlCiAgIEFkZHMgZXZlbnQgaGFuZGxlcnMgd2l0aG91dCB0cmFtcGxpbmcgb24gYW55IG90aGVycwoqLwoKLy8gdGhlIHNsaWR5IG9iamVjdCBpbXBsZW1lbnRhdGlvbgp2YXIgdzNjX3NsaWR5ID0gewogIC8vIGNsYXNzaWZ5IHdoaWNoIGtpbmQgb2YgYnJvd3NlciB3ZSdyZSBydW5uaW5nIHVuZGVyCiAgbnNfcG9zOiAodHlwZW9mIHdpbmRvdy5wYWdlWU9mZnNldCE9J3VuZGVmaW5lZCcpLAogIGtodG1sOiAoKG5hdmlnYXRvci51c2VyQWdlbnQpLmluZGV4T2YoIktIVE1MIikgPj0gMCA/IHRydWUgOiBmYWxzZSksCiAgb3BlcmE6ICgobmF2aWdhdG9yLnVzZXJBZ2VudCkuaW5kZXhPZigiT3BlcmEiKSA+PSAwID8gdHJ1ZSA6IGZhbHNlKSwKICBpcGFkOiAoKG5hdmlnYXRvci51c2VyQWdlbnQpLmluZGV4T2YoImlQYWQiKSA+PSAwID8gdHJ1ZSA6IGZhbHNlKSwKICBpcGhvbmU6ICgobmF2aWdhdG9yLnVzZXJBZ2VudCkuaW5kZXhPZigiaVBob25lIikgPj0gMCA/IHRydWUgOiBmYWxzZSksCiAgYW5kcm9pZDogKChuYXZpZ2F0b3IudXNlckFnZW50KS5pbmRleE9mKCJBbmRyb2lkIikgPj0gMCA/IHRydWUgOiBmYWxzZSksCiAgaWU6ICh0eXBlb2YgZG9jdW1lbnQuYWxsICE9ICJ1bmRlZmluZWQiICYmICF0aGlzLm9wZXJhKSwKICBpZTY6ICghdGhpcy5uc19wb3MgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDYiKSAhPSAtMSksCiAgaWU3OiAoIXRoaXMubnNfcG9zICYmIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTVNJRSA3IikgIT0gLTEpLAogIGllODogKCF0aGlzLm5zX3BvcyAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1TSUUgOCIpICE9IC0xKSwKICBpZTk6ICghdGhpcy5uc19wb3MgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDkiKSAhPSAtMSksCgogIC8vIGRhdGEgZm9yIHN3aXBlIGFuZCBkb3VibGUgdGFwIGRldGVjdGlvbiBvbiB0b3VjaCBzY3JlZW5zCiAgbGFzdF90YXA6IDAsCiAgcHJldl90YXA6IDAsCiAgc3RhcnRfeDogMCwKICBzdGFydF95OiAwLAogIGRlbHRhX3g6IDAsCiAgZGVsdGFfeTogMCwKCiAgLy8gYXJlIHdlIHJ1bm5pbmcgYXMgWEhUTUw/IChkb2Vzbid0IHdvcmsgb24gT3BlcmEpCiAgaXNfeGh0bWw6IC94bWwvLnRlc3QoZG9jdW1lbnQuY29udGVudFR5cGUpLAoKICBzbGlkZV9udW1iZXI6IDAsIC8vIGludGVnZXIgc2xpZGUgY291bnQ6IDAsIDEsIDIsIC4uLgogIHNsaWRlX251bWJlcl9lbGVtZW50OiBudWxsLCAvLyBlbGVtZW50IGNvbnRhaW5pbmcgc2xpZGUgbnVtYmVyCiAgc2xpZGVzOiBbXSwgLy8gc2V0IHRvIGFycmF5IG9mIHNsaWRlIGRpdidzCiAgbm90ZXM6IFtdLCAvLyBzZXQgdG8gYXJyYXkgb2YgaGFuZG91dCBkaXYncwogIGJhY2tncm91bmRzOiBbXSwgLy8gc2V0IHRvIGFycmF5IG9mIGJhY2tncm91bmQgZGl2J3MKICBvYnNlcnZlcnM6IFtdLCAvLyBsaXN0IG9mIG9ic2VydmVyIGZ1bmN0aW9ucwogIHRvb2xiYXI6IG51bGwsIC8vIGVsZW1lbnQgY29udGFpbmluZyB0b29sYmFyCiAgdGl0bGU6IG51bGwsIC8vIGRvY3VtZW50IHRpdGxlCiAgbGFzdF9zaG93bjogbnVsbCwgLy8gbGFzdCBpbmNyZW1lbnRhbGx5IHNob3duIGl0ZW0KICBlb3M6IG51bGwsICAvLyBzcGFuIGVsZW1lbnQgZm9yIGVuZCBvZiBzbGlkZSBpbmRpY2F0b3IKICB0b2M6IG51bGwsIC8vIHRhYmxlIG9mIGNvbnRlbnRzCiAgb3V0bGluZTogbnVsbCwgLy8gb3V0bGluZSBlbGVtZW50IHdpdGggdGhlIGZvY3VzCiAgc2VsZWN0ZWRfdGV4dF9sZW46IDAsIC8vIGxlbmd0aCBvZiBkcmFnIHNlbGVjdGlvbiBvbiBkb2N1bWVudAogIHZpZXdfYWxsOiAwLCAgLy8gMSB0byB2aWV3IGFsbCBzbGlkZXMgKyBoYW5kb3V0cwogIHdhbnRfdG9vbGJhcjogdHJ1ZSwgIC8vIHVzZXIgcHJlZmVyZW5jZSB0byBzaG93L2hpZGUgdG9vbGJhcgogIG1vdXNlX2NsaWNrX2VuYWJsZWQ6IHRydWUsIC8vIGVuYWJsZXMgbGVmdCBjbGljayBmb3IgbmV4dCBzbGlkZQogIHNjcm9sbF9oYWNrOiAwLCAvLyBJRSB3b3JrIGFyb3VuZCBmb3IgcG9zaXRpb246IGZpeGVkCiAgZGlzYWJsZV9zbGlkZV9jbGljazogZmFsc2UsICAvLyB1c2VkIGJ5IGNsaWNrZWQgYW5jaG9ycwoKICBsYW5nOiAiZW4iLCAvLyB1cGRhdGVkIHRvIGxhbmd1YWdlIHNwZWNpZmllZCBieSBodG1sIGZpbGUKCiAgaGVscF9hbmNob3I6IG51bGwsIC8vIHVzZWQgZm9yIGtleWJvYXJkIGZvY3VzIGhhY2sgaW4gc2hvd1Rvb2xiYXIoKQogIGhlbHBfcGFnZTogImh0dHA6Ly93d3cudzMub3JnL1RhbGtzL1Rvb2xzL1NsaWR5Mi9oZWxwL2hlbHAuaHRtbCIsCiAgaGVscF90ZXh0OiAiTmF2aWdhdGUgd2l0aCBtb3VzZSBjbGljaywgc3BhY2UgYmFyLCBDdXJzb3IgTGVmdC9SaWdodCwgIiArCiAgICAgICAgICAgICAib3IgUGcgVXAgYW5kIFBnIERuLiBVc2UgUyBhbmQgQiB0byBjaGFuZ2UgZm9udCBzaXplLiIsCgogIHNpemVfaW5kZXg6IDAsCiAgc2l6ZV9hZGp1c3RtZW50OiAwLAogIHNpemVzOiAgbmV3IEFycmF5KCIxMHB0IiwgIjEycHQiLCAiMTRwdCIsICIxNnB0IiwgIjE4cHQiLCAiMjBwdCIsCiAgICAgICAgICAgICAgICAgICAgIjIycHQiLCAiMjRwdCIsICIyNnB0IiwgIjI4cHQiLCAiMzBwdCIsICIzMnB0IiksCgogIC8vIG5lZWRlZCBmb3IgZWZmaWNpZW50IHJlc2l6aW5nCiAgbGFzdF93aWR0aDogMCwKICBsYXN0X2hlaWdodDogMCwKCgogIC8vIE5lZWRlZCBmb3IgY3Jvc3MgYnJvd3NlciBzdXBwb3J0IGZvciByZWxhdGl2ZSB3aWR0aC9oZWlnaHQgb24KICAvLyBvYmplY3QgZWxlbWVudHMuIFRoZSB3b3JrIGFyb3VuZCBpcyB0byBzYXZlIHdpZHRoL2hlaWdodCBhdHRyaWJ1dGVzCiAgLy8gYW5kIHRoZW4gdG8gcmVjb21wdXRlIGFic29sdXRlIHdpZHRoL2hlaWdodCBkaW1lbnNpb25zIG9uIHJlc2l6aW5nCiAgIG9iamVjdHM6IFtdLAoKICAvLyBhdHRhY2ggaW5pdGlhbGlhdGlvbiBldmVudCBoYW5kbGVycwogIHNldF91cDogZnVuY3Rpb24gKCkgewogICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHsgdzNjX3NsaWR5LmluaXQoKTsgfTsKICAgIGlmICh0eXBlb2Ygd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgIT0gInVuZGVmaW5lZCIpCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgaW5pdCwgZmFsc2UpOwogICAgZWxzZQogICAgICB3aW5kb3cuYXR0YWNoRXZlbnQoIm9ubG9hZCIsIGluaXQpOwogIH0sCgogIGhpZGVfc2xpZGVzOiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoZG9jdW1lbnQuYm9keSAmJiAhdzNjX3NsaWR5LmluaXRpYWxpemVkKQogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnZpc2liaWxpdHkgPSAiaGlkZGVuIjsKICAgIGVsc2UKICAgICAgc2V0VGltZW91dCh3M2Nfc2xpZHkuaGlkZV9zbGlkZXMsIDUwKTsKICB9LAoKICAvLyBoYWNrIHRvIHBlcnN1YWRlIElFIHRvIGNvbXB1dGUgY29ycmVjdCBkb2N1bWVudCBoZWlnaHQKICAvLyBhcyBuZWVkZWQgZm9yIHNpbXVsYXRpbmcgZml4ZWQgcG9zaXRpb25pbmcgb2YgdG9vbGJhcgogIGllX2hhY2s6IGZ1bmN0aW9uICgpIHsKICAgIHdpbmRvdy5yZXNpemVCeSgwLC0xKTsKICAgIHdpbmRvdy5yZXNpemVCeSgwLCAxKTsKICB9LAoKICBpbml0OiBmdW5jdGlvbiAoKSB7CiAgICAvL2FsZXJ0KCJzbGlkeSBzdGFydGluZyB0ZXN0IDEwIik7CiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnZpc2liaWxpdHkgPSAidmlzaWJsZSI7CiAgICB0aGlzLmluaXRfbG9jYWxpemF0aW9uKCk7CiAgICB0aGlzLmFkZF90b29sYmFyKCk7CiAgICB0aGlzLndyYXBfaW1wbGljaXRfc2xpZGVzKCk7CiAgICB0aGlzLmNvbGxlY3Rfc2xpZGVzKCk7CiAgICB0aGlzLmNvbGxlY3Rfbm90ZXMoKTsKICAgIHRoaXMuY29sbGVjdF9iYWNrZ3JvdW5kcygpOwogICAgdGhpcy5vYmplY3RzID0gZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgib2JqZWN0Iik7CiAgICB0aGlzLnBhdGNoX2FuY2hvcnMoKTsKICAgIHRoaXMuc2xpZGVfbnVtYmVyID0gdGhpcy5maW5kX3NsaWRlX251bWJlcihsb2NhdGlvbi5ocmVmKTsKICAgIHdpbmRvdy5vZmZzY3JlZW5idWZmZXJpbmcgPSB0cnVlOwogICAgdGhpcy5zaXplX2FkanVzdG1lbnQgPSB0aGlzLmZpbmRfc2l6ZV9hZGp1c3QoKTsKICAgIHRoaXMudGltZV9sZWZ0ID0gdGhpcy5maW5kX2R1cmF0aW9uKCk7CiAgICB0aGlzLmhpZGVfaW1hZ2VfdG9vbGJhcigpOyAgLy8gc3VwcHJlc3MgSUUgaW1hZ2UgdG9vbGJhciBwb3B1cAogICAgdGhpcy5pbml0X291dGxpbmVyKCk7ICAvLyBhY3RpdmF0ZSBmb2xkL3VuZm9sZCBzdXBwb3J0CiAgICB0aGlzLnRpdGxlID0gZG9jdW1lbnQudGl0bGU7CiAgICB0aGlzLmtleWJvYXJkbGVzcyA9ICh0aGlzLmlwYWR8fHRoaXMuaXBob25lfHx0aGlzLmFuZHJvaWQpOwoKICAgIGlmICh0aGlzLmtleWJvYXJkbGVzcykKICAgIHsKICAgICAgdzNjX3NsaWR5LnJlbW92ZV9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpCiAgICAgIHRoaXMud2FudF90b29sYmFyID0gMDsKICAgIH0KCiAgICAvLyB3b3JrIGFyb3VuZCBmb3Igb3BlcmEgYnVnCiAgICB0aGlzLmlzX3hodG1sID0gKGRvY3VtZW50LmJvZHkudGFnTmFtZSA9PSAiQk9EWSIgPyBmYWxzZSA6IHRydWUpOwoKICAgIGlmICh0aGlzLnNsaWRlcy5sZW5ndGggPiAwKQogICAgewogICAgICB2YXIgc2xpZGUgPSB0aGlzLnNsaWRlc1t0aGlzLnNsaWRlX251bWJlcl07CiAgIAogICAgICBpZiAodGhpcy5zbGlkZV9udW1iZXIgPiAwKQogICAgICB7CiAgICAgICAgdGhpcy5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoInZpc2libGUiKTsKICAgICAgICB0aGlzLmxhc3Rfc2hvd24gPSB0aGlzLnByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW0obnVsbCk7CiAgICAgICAgdGhpcy5zZXRfZW9zX3N0YXR1cyh0cnVlKTsKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICB0aGlzLmxhc3Rfc2hvd24gPSBudWxsOwogICAgICAgIHRoaXMuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJoaWRkZW4iKTsKICAgICAgICB0aGlzLnNldF9lb3Nfc3RhdHVzKCF0aGlzLm5leHRfaW5jcmVtZW50YWxfaXRlbSh0aGlzLmxhc3Rfc2hvd24pKTsKICAgICAgfQoKICAgICAgdGhpcy5zZXRfbG9jYXRpb24oKTsKICAgICAgdGhpcy5hZGRfY2xhc3ModGhpcy5zbGlkZXNbMF0sICJmaXJzdC1zbGlkZSIpOwogICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZShzbGlkZSk7CiAgICB9CgogICAgdGhpcy50b2MgPSB0aGlzLnRhYmxlX29mX2NvbnRlbnRzKCk7CgogICAgdGhpcy5hZGRfaW5pdGlhbF9wcm9tcHQoKTsKCiAgICAvLyBiaW5kIGV2ZW50IGhhbmRsZXJzIHdpdGhvdXQgaW50ZXJmZXJpbmcgd2l0aCBjdXN0b20gcGFnZSBzY3JpcHRzCiAgICAvLyBUYXAgZXZlbnRzIGJlaGF2ZSB0b28gd2VpcmRseSB0byBzdXBwb3J0IGNsaWNrcyByZWxpYWJseSBvbgogICAgLy8gaVBob25lIGFuZCBpUGFkLCBzbyBleGNsdWRlIHRoZXNlIGZyb20gY2xpY2sgaGFuZGxlcgoKICAgIGlmICghdGhpcy5rZXlib2FyZGxlc3MpCiAgICB7CiAgICAgIHRoaXMuYWRkX2xpc3RlbmVyKGRvY3VtZW50LmJvZHksICJjbGljayIsIHRoaXMubW91c2VfYnV0dG9uX2NsaWNrKTsKICAgICAgdGhpcy5hZGRfbGlzdGVuZXIoZG9jdW1lbnQuYm9keSwgIm1vdXNlZG93biIsIHRoaXMubW91c2VfYnV0dG9uX2Rvd24pOwogICAgfQoKICAgIHRoaXMuYWRkX2xpc3RlbmVyKGRvY3VtZW50LCAia2V5ZG93biIsIHRoaXMua2V5X2Rvd24pOwogICAgdGhpcy5hZGRfbGlzdGVuZXIoZG9jdW1lbnQsICJrZXlwcmVzcyIsIHRoaXMua2V5X3ByZXNzKTsKICAgIHRoaXMuYWRkX2xpc3RlbmVyKHdpbmRvdywgInJlc2l6ZSIsIHRoaXMucmVzaXplZCk7CiAgICB0aGlzLmFkZF9saXN0ZW5lcih3aW5kb3csICJzY3JvbGwiLCB0aGlzLnNjcm9sbGVkKTsKICAgIHRoaXMuYWRkX2xpc3RlbmVyKHdpbmRvdywgInVubG9hZCIsIHRoaXMudW5sb2FkZWQpOwoKICAgIHRoaXMuYWRkX2xpc3RlbmVyKGRvY3VtZW50LCAiZ2VzdHVyZWNoYW5nZSIsIGZ1bmN0aW9uICgpCiAgICB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwoKICAgIHRoaXMuYXR0YWNoX3RvdWNoX2hhbmRlcnModGhpcy5zbGlkZXMpOwoKICAgIC8vIHRoaXMgc2VlbXMgdG8gYmUgYSBkZWJ1Z2dpbmcgaGFjawogICAgLy9pZiAoIWRvY3VtZW50LmJvZHkub25jbGljaykKICAgIC8vICBkb2N1bWVudC5ib2R5Lm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7IH07CgogICAgdGhpcy5zaW5nbGVfc2xpZGVfdmlldygpOwoKICAgIC8vdGhpcy5zZXRfbG9jYXRpb24oKTsKCiAgICB0aGlzLnJlc2l6ZWQoKTsKCiAgICBpZiAodGhpcy5pZTcpCiAgICAgIHNldFRpbWVvdXQodzNjX3NsaWR5LmllX2hhY2ssIDEwMCk7CgogICAgdGhpcy5zaG93X3Rvb2xiYXIoKTsKCiAgICAvLyBmb3IgYmFjayBidXR0b24gZGV0ZWN0aW9uCiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IHczY19zbGlkeS5jaGVja19sb2NhdGlvbigpOyB9LCAyMDApOwogICAgdzNjX3NsaWR5LmluaXRpYWxpemVkID0gdHJ1ZTsKICB9LAoKICAvLyBjcmVhdGUgZGl2IGVsZW1lbnQgd2l0aCBsaW5rcyB0byBlYWNoIHNsaWRlCiAgdGFibGVfb2ZfY29udGVudHM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciB0b2MgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJkaXYiKTsKICAgIHRoaXMuYWRkX2NsYXNzKHRvYywgInNsaWR5X3RvYyBoaWRkZW4iKTsKICAgIC8vdG9jLnNldEF0dHJpYnV0ZSgidGFiaW5kZXgiLCAiMCIpOwoKICAgIHZhciBoZWFkaW5nID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiZGl2Iik7CiAgICB0aGlzLmFkZF9jbGFzcyhoZWFkaW5nLCAidG9jLWhlYWRpbmciKTsKICAgIGhlYWRpbmcuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgiVGFibGUgb2YgQ29udGVudHMiKTsKCiAgICB0b2MuYXBwZW5kQ2hpbGQoaGVhZGluZyk7CiAgICB2YXIgcHJldmlvdXMgPSBudWxsOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zbGlkZXMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIHZhciB0aXRsZSA9IHRoaXMuaGFzX2NsYXNzKHRoaXMuc2xpZGVzW2ldLCAidGl0bGUiKTsKICAgICAgdmFyIG51bSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKChpICsgMSkgKyAiLiAiKTsKCiAgICAgIHRvYy5hcHBlbmRDaGlsZChudW0pOwoKICAgICAgdmFyIGEgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJhIik7CiAgICAgIGEuc2V0QXR0cmlidXRlKCJocmVmIiwgIiMoIiArIChpKzEpICsgIikiKTsKCiAgICAgIGlmICh0aXRsZSkKICAgICAgICB0aGlzLmFkZF9jbGFzcyhhLCAidGl0bGVzbGlkZSIpOwoKICAgICAgdmFyIG5hbWUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLnNsaWRlX25hbWUoaSkpOwogICAgICBhLmFwcGVuZENoaWxkKG5hbWUpOwogICAgICBhLm9uY2xpY2sgPSB3M2Nfc2xpZHkudG9jX2NsaWNrOwogICAgICBhLm9ua2V5ZG93biA9IHczY19zbGlkeS50b2Nfa2V5X2Rvd247CiAgICAgIGEucHJldmlvdXMgPSBwcmV2aW91czsKCiAgICAgIGlmIChwcmV2aW91cykKICAgICAgICBwcmV2aW91cy5uZXh0ID0gYTsKCiAgICAgIHRvYy5hcHBlbmRDaGlsZChhKTsKCiAgICAgIGlmIChpID09IDApCiAgICAgICAgdG9jLmZpcnN0ID0gYTsKCiAgICAgIGlmIChpIDwgdGhpcy5zbGlkZXMubGVuZ3RoIC0gMSkKICAgICAgewogICAgICAgIHZhciBiciA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImJyIik7CiAgICAgICAgdG9jLmFwcGVuZENoaWxkKGJyKTsKICAgICAgfQoKICAgICAgcHJldmlvdXMgPSBhOwogICAgfQoKICAgIHRvYy5mb2N1cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuZmlyc3QpCiAgICAgICAgdGhpcy5maXJzdC5mb2N1cygpOwogICAgfQoKICAgIHRvYy5vbm1vdXNldXAgPSB3M2Nfc2xpZHkubW91c2VfYnV0dG9uX3VwOwoKICAgIHRvYy5vbmNsaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgZXx8KGU9d2luZG93LmV2ZW50KTsKCiAgICAgIGlmICh3M2Nfc2xpZHkuc2VsZWN0ZWRfdGV4dF9sZW4gPD0gMCkKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfdGFibGVfb2ZfY29udGVudHModHJ1ZSk7CgogICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihlKTsKICAgIAogICAgICBpZiAoZS5jYW5jZWwgIT0gdW5kZWZpbmVkKQogICAgICAgIGUuY2FuY2VsID0gdHJ1ZTsKICAgICAgCiAgICAgIGlmIChlLnJldHVyblZhbHVlICE9IHVuZGVmaW5lZCkKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgIAogICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKHRvYywgZG9jdW1lbnQuYm9keS5maXJzdENoaWxkKTsKICAgIHJldHVybiB0b2M7CiAgfSwKCiAgaXNfc2hvd25fdG9jOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gIXczY19zbGlkeS5oYXNfY2xhc3ModzNjX3NsaWR5LnRvYywgImhpZGRlbiIpOwogIH0sCgogIHNob3dfdGFibGVfb2ZfY29udGVudHM6IGZ1bmN0aW9uICgpIHsKICAgIHczY19zbGlkeS5yZW1vdmVfY2xhc3ModzNjX3NsaWR5LnRvYywgImhpZGRlbiIpOwogICAgdmFyIHRvYyA9IHczY19zbGlkeS50b2M7CiAgICB0b2MuZm9jdXMoKTsKCiAgICBpZiAodzNjX3NsaWR5LmllNyAmJiB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID09IDApCiAgICAgIHNldFRpbWVvdXQodzNjX3NsaWR5LmllX2hhY2ssIDEwMCk7CiAgfSwKCiAgaGlkZV90YWJsZV9vZl9jb250ZW50czogZnVuY3Rpb24gKGZvY3VzKSB7CiAgICB3M2Nfc2xpZHkuYWRkX2NsYXNzKHczY19zbGlkeS50b2MsICJoaWRkZW4iKTsKCiAgICBpZiAoZm9jdXMgJiYgIXczY19zbGlkeS5vcGVyYSAmJgogICAgICAgICF3M2Nfc2xpZHkuaGFzX2NsYXNzKHczY19zbGlkeS50b2MsICJoaWRkZW4iKSkKICAgICAgdzNjX3NsaWR5LnNldF9mb2N1cygpOwogIH0sCgogIHRvZ2dsZV90YWJsZV9vZl9jb250ZW50czogZnVuY3Rpb24gKCkgewogICAgaWYgKHczY19zbGlkeS5pc19zaG93bl90b2MoKSkKICAgICAgdzNjX3NsaWR5LmhpZGVfdGFibGVfb2ZfY29udGVudHModHJ1ZSk7CiAgICBlbHNlCiAgICAgIHczY19zbGlkeS5zaG93X3RhYmxlX29mX2NvbnRlbnRzKCk7CiAgfSwKCiAgLy8gY2FsbGVkIG9uIGNsaWNraW5nIHRvYyBlbnRyeQogIHRvY19jbGljazogZnVuY3Rpb24gKGUpIHsKICAgIGlmICghZSkKICAgICAgZSA9IHdpbmRvdy5ldmVudDsKCiAgICB2YXIgdGFyZ2V0ID0gdzNjX3NsaWR5LmdldF90YXJnZXQoZSk7CgogICAgaWYgKHRhcmdldCAmJiB0YXJnZXQubm9kZVR5cGUgPT0gMSkKICAgIHsKICAgICAgdmFyIHVyaSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoImhyZWYiKTsKCiAgICAgIGlmICh1cmkpCiAgICAgIHsKICAgICAgICAvL2FsZXJ0KCJnb2luZyB0byAiICsgdXJpKTsKICAgICAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgIHczY19zbGlkeS5oaWRlX3NsaWRlKHNsaWRlKTsKICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID0gdzNjX3NsaWR5LmZpbmRfc2xpZGVfbnVtYmVyKHVyaSk7CiAgICAgICAgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgIHczY19zbGlkeS5sYXN0X3Nob3duID0gbnVsbDsKICAgICAgICB3M2Nfc2xpZHkuc2V0X2xvY2F0aW9uKCk7CiAgICAgICAgdzNjX3NsaWR5LnNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbCgiaGlkZGVuIik7CiAgICAgICAgdzNjX3NsaWR5LnNldF9lb3Nfc3RhdHVzKCF3M2Nfc2xpZHkubmV4dF9pbmNyZW1lbnRhbF9pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKSk7CiAgICAgICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgICAgIC8vdGFyZ2V0LmZvY3VzKCk7CgogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgIGlmICghdzNjX3NsaWR5Lm9wZXJhKQogICAgICAgICAgICB3M2Nfc2xpZHkuc2V0X2ZvY3VzKCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlKQogICAgICAgIHsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB3M2Nfc2xpZHkuaGlkZV90YWJsZV9vZl9jb250ZW50cyh0cnVlKTsKICAgIGlmICh3M2Nfc2xpZHkuaWU3KSB3M2Nfc2xpZHkuaWVfaGFjaygpOwogICAgdzNjX3NsaWR5LnN0b3BfcHJvcGFnYXRpb24oZSk7CiAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChlKTsKICB9LAoKICAvLyBjYWxsZWQgb25rZXlkb3duIGZvciB0b2MgZW50cnkKICB0b2Nfa2V5X2Rvd246IGZ1bmN0aW9uIChldmVudCkgewogICAgdmFyIGtleTsKCiAgICBpZiAoIWV2ZW50KQogICAgICB2YXIgZXZlbnQgPSB3aW5kb3cuZXZlbnQ7CgogICAgLy8ga2x1ZGdlIGFyb3VuZCBOUy9JRSBkaWZmZXJlbmNlcyAKICAgIGlmICh3aW5kb3cuZXZlbnQpCiAgICAgIGtleSA9IHdpbmRvdy5ldmVudC5rZXlDb2RlOwogICAgZWxzZSBpZiAoZXZlbnQud2hpY2gpCiAgICAgIGtleSA9IGV2ZW50LndoaWNoOwogICAgZWxzZQogICAgICByZXR1cm4gdHJ1ZTsgLy8gWWlrZXMhIHVua25vd24gYnJvd3NlcgoKICAgIC8vIGlnbm9yZSBldmVudCBpZiBrZXkgdmFsdWUgaXMgemVybwogICAgLy8gYXMgZm9yIGFsdCBvbiBPcGVyYSBhbmQgS29ucXVlcm9yCiAgICBpZiAoIWtleSkKICAgICAgcmV0dXJuIHRydWU7CgogICAgLy8gY2hlY2sgZm9yIGNvbmN1cnJlbnQgY29udHJvbC9jb21tYW5kL2FsdCBrZXkKICAgIC8vIGJ1dCBhcmUgdGhlc2Ugb25seSBwcmVzZW50IG9uIG1vdXNlIGV2ZW50cz8KCiAgICBpZiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5hbHRLZXkpCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGlmIChrZXkgPT0gMTMpCiAgICB7CiAgICAgIHZhciB1cmkgPSB0aGlzLmdldEF0dHJpYnV0ZSgiaHJlZiIpOwoKICAgICAgaWYgKHVyaSkKICAgICAgewogICAgICAgIC8vYWxlcnQoImdvaW5nIHRvICIgKyB1cmkpOwogICAgICAgdmFyIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICB3M2Nfc2xpZHkuaGlkZV9zbGlkZShzbGlkZSk7CiAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IHczY19zbGlkeS5maW5kX3NsaWRlX251bWJlcih1cmkpOwogICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IG51bGw7CiAgICAgICAgdzNjX3NsaWR5LnNldF9sb2NhdGlvbigpOwogICAgICAgIHczY19zbGlkeS5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoImhpZGRlbiIpOwogICAgICAgIHczY19zbGlkeS5zZXRfZW9zX3N0YXR1cyghdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbSh3M2Nfc2xpZHkubGFzdF9zaG93bikpOwogICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgICAvL3RhcmdldC5mb2N1cygpOwoKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICBpZiAoIXczY19zbGlkeS5vcGVyYSkKICAgICAgICAgICAgdzNjX3NsaWR5LnNldF9mb2N1cygpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkKICAgICAgICB7CiAgICAgICAgfQogICAgICB9CgogICAgICB3M2Nfc2xpZHkuaGlkZV90YWJsZV9vZl9jb250ZW50cyh0cnVlKTsKCiAgICAgIGlmIChzZWxmLmllNykKICAgICAgIHczY19zbGlkeS5pZV9oYWNrKCk7CgogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CgogICAgaWYgKGtleSA9PSA0MCAmJiB0aGlzLm5leHQpCiAgICB7CiAgICAgIHRoaXMubmV4dC5mb2N1cygpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CgogICAgaWYgKGtleSA9PSAzOCAmJiB0aGlzLnByZXZpb3VzKQogICAgewogICAgICB0aGlzLnByZXZpb3VzLmZvY3VzKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICB0b3VjaHN0YXJ0OiBmdW5jdGlvbiAoZSkKICB7CiAgICAvLyBhIGRvdWJsZSB0b3VjaCBvZnRlbiBzdGFydHMgd2l0aCBhCiAgICAvLyBzaW5nbGUgdG91Y2ggZHVlIHRvIGZpbmdlcnMgdG91Y2hpbmcKICAgIC8vIGRvd24gYXQgc2xpZ2h0bHkgZGlmZmVyZW50IHRpbWVzCiAgICAvLyB0aHVzIGF2b2lkIGNhbGxpbmcgcHJldmVudERlZmF1bHQgaGVyZQogICAgdGhpcy5wcmV2X3RhcCA9IHRoaXMubGFzdF90YXA7CiAgICB0aGlzLmxhc3RfdGFwID0gKG5ldyBEYXRlKS5nZXRUaW1lKCk7CgogICAgdmFyIHRhcF9kZWxheSA9IHRoaXMubGFzdF90YXAgLSB0aGlzLnByZXZfdGFwOwoKICAgIGlmICh0YXBfZGVsYXkgPD0gMjAwKQogICAgewogICAgICAvLyBkb3VibGUgdGFwCiAgICB9CgogICAgdmFyIHRvdWNoID0gZS50b3VjaGVzWzBdOwoKICAgIHRoaXMucGFnZVggPSB0b3VjaC5wYWdlWDsKICAgIHRoaXMucGFnZVkgPSB0b3VjaC5wYWdlWTsKICAgIHRoaXMuc2NyZWVuWCA9IHRvdWNoLnNjcmVlblg7CiAgICB0aGlzLnNjcmVlblkgPSB0b3VjaC5zY3JlZW5ZOwogICAgdGhpcy5jbGllbnRYID0gdG91Y2guY2xpZW50WDsKICAgIHRoaXMuY2xpZW50WSA9IHRvdWNoLmNsaWVudFk7CgogICAgdGhpcy5kZWx0YV94ID0gdGhpcy5kZWx0YV95ID0gMDsKICB9LAoKICB0b3VjaG1vdmU6IGZ1bmN0aW9uIChlKQogIHsKICAgIC8vIG92ZXJyaWRlIG5hdGl2ZSBnZXN0dXJlcyBmb3Igc2luZ2xlIHRvdWNoCiAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpCiAgICAgIHJldHVybjsKCiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB2YXIgdG91Y2ggPSBlLnRvdWNoZXNbMF07CiAgICB0aGlzLmRlbHRhX3ggPSB0b3VjaC5wYWdlWCAtIHRoaXMucGFnZVg7CiAgICB0aGlzLmRlbHRhX3kgPSB0b3VjaC5wYWdlWSAtIHRoaXMucGFnZVk7CiAgfSwKCiAgdG91Y2hlbmQ6IGZ1bmN0aW9uIChlKQogIHsKICAgIC8vIGRlZmF1bHQgYmVoYXZpb3IgZm9yIG11bHRpLXRvdWNoCiAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpCiAgICAgIHJldHVybjsKCiAgICB2YXIgZGVsYXkgPSAobmV3IERhdGUpLmdldFRpbWUoKSAtIHRoaXMubGFzdF90YXA7CiAgICB2YXIgZHggPSB0aGlzLmRlbHRhX3g7CiAgICB2YXIgZHkgPSB0aGlzLmRlbHRhX3k7CiAgICB2YXIgYWJzX2R4ID0gTWF0aC5hYnMoZHgpOwogICAgdmFyIGFic19keSA9IE1hdGguYWJzKGR5KTsKCiAgICBpZiAoZGVsYXkgPCA1MDAgJiYgKGFic19keCA+IDEwMCB8fCBhYnNfZHkgPiAxMDApKQogICAgewogICAgICBpZiAoYWJzX2R4ID4gMC41ICogYWJzX2R5KQogICAgICB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBpZiAoZHggPCAwKQogICAgICAgICAgdzNjX3NsaWR5Lm5leHRfc2xpZGUodHJ1ZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgdzNjX3NsaWR5LnByZXZpb3VzX3NsaWRlKHRydWUpOwogICAgICB9CiAgICAgIGVsc2UgaWYgKGFic19keSA+IDIgKiBhYnNfZHgpCiAgICAgIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdzNjX3NsaWR5LnRvZ2dsZV90YWJsZV9vZl9jb250ZW50cygpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLy8gIyMjIE9CU09MRVRFICMjIwogIGJlZm9yZV9wcmludDogZnVuY3Rpb24gKCkgewogICAgdGhpcy5zaG93X2FsbF9zbGlkZXMoKTsKICAgIHRoaXMuaGlkZV90b29sYmFyKCk7CiAgICBhbGVydCgiYmVmb3JlIHByaW50Iik7CiAgfSwKCiAgLy8gIyMjIE9CU09MRVRFICMjIwogIGFmdGVyX3ByaW50OiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIXRoaXMudmlld19hbGwpCiAgICB7CiAgICAgIHRoaXMuc2luZ2xlX3NsaWRlX3ZpZXcoKTsKICAgICAgdGhpcy5zaG93X3Rvb2xiYXIoKTsKICAgIH0KICAgIGFsZXJ0KCJhZnRlciBwcmludCIpOwogIH0sCgogIC8vICMjIyBPQlNPTEVURSAjIyMKICBwcmludF9zbGlkZXM6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuYmVmb3JlX3ByaW50KCk7CiAgICB3aW5kb3cucHJpbnQoKTsKICAgIHRoaXMuYWZ0ZXJfcHJpbnQoKTsKICB9LAoKICAvLyAjIyMgT0JTT0xFVEUgPz8gIyMjCiAgdG9nZ2xlX3ZpZXc6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLnZpZXdfYWxsKQogICAgewogICAgICB0aGlzLnNpbmdsZV9zbGlkZV92aWV3KCk7CiAgICAgIHRoaXMuc2hvd190b29sYmFyKCk7CiAgICAgIHRoaXMudmlld19hbGwgPSAwOwogICAgfQogICAgZWxzZQogICAgewogICAgICB0aGlzLnNob3dfYWxsX3NsaWRlcygpOwogICAgICB0aGlzLmhpZGVfdG9vbGJhcigpOwogICAgICB0aGlzLnZpZXdfYWxsID0gMTsKICAgIH0KICB9LAoKICAvLyBwcmVwYXJlIGZvciBwcmludGluZyAgIyMjIE9CU09MRVRFICMjIwogIHNob3dfYWxsX3NsaWRlczogZnVuY3Rpb24gKCkgewogICAgdGhpcy5yZW1vdmVfY2xhc3MoZG9jdW1lbnQuYm9keSwgInNpbmdsZV9zbGlkZSIpOwogICAgdGhpcy5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoInZpc2libGUiKTsKICB9LAoKICAvLyByZXN0b3JlIGFmdGVyIHByaW50aW5nICAjIyMgT0JTT0xFVEUgIyMjCiAgc2luZ2xlX3NsaWRlX3ZpZXc6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuYWRkX2NsYXNzKGRvY3VtZW50LmJvZHksICJzaW5nbGVfc2xpZGUiKTsKICAgIHRoaXMuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJ2aXNpYmxlIik7CiAgICB0aGlzLmxhc3Rfc2hvd24gPSB0aGlzLnByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW0obnVsbCk7CiAgfSwKCiAgLy8gc3VwcHJlc3MgSUUncyBpbWFnZSB0b29sYmFyIHBvcCB1cAogIGhpZGVfaW1hZ2VfdG9vbGJhcjogZnVuY3Rpb24gKCkgewogICAgaWYgKCF0aGlzLm5zX3BvcykKICAgIHsKICAgICAgdmFyIGltYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJJTUciKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW1hZ2VzLmxlbmd0aDsgKytpKQogICAgICAgIGltYWdlc1tpXS5zZXRBdHRyaWJ1dGUoImdhbGxlcnlpbWciLCAibm8iKTsKICAgIH0KICB9LAoKICB1bmxvYWRlZDogZnVuY3Rpb24gKGUpIHsKICAgIC8vYWxlcnQoInVubG9hZGVkIik7CiAgfSwKCiAgLy8gU2FmYXJpIGFuZCBLb25xdWVyb3IgZG9uJ3QgeWV0IHN1cHBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSgpCiAgLy8gYW5kIHRoZXkgYWx3YXlzIHJlbG9hZCBwYWdlIHdoZW4gbG9jYXRpb24uaHJlZiBpcyB1cGRhdGVkCiAgaXNfS0hUTUw6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBhZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICByZXR1cm4gKGFnZW50LmluZGV4T2YoIktIVE1MIikgPj0gMCA/IHRydWUgOiBmYWxzZSk7CiAgfSwKCiAgLy8gZmluZCBzbGlkZSBuYW1lIGZyb20gZmlyc3QgaDEgZWxlbWVudAogIC8vIGRlZmF1bHQgdG8gZG9jdW1lbnQgdGl0bGUgKyBzbGlkZSBudW1iZXIKICBzbGlkZV9uYW1lOiBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHZhciBuYW1lID0gbnVsbDsKICAgIHZhciBzbGlkZSA9IHRoaXMuc2xpZGVzW2luZGV4XTsKCiAgICB2YXIgaGVhZGluZyA9IHRoaXMuZmluZF9oZWFkaW5nKHNsaWRlKTsKCiAgICBpZiAoaGVhZGluZykKICAgICAgbmFtZSA9IHRoaXMuZXh0cmFjdF90ZXh0KGhlYWRpbmcpOwoKICAgIGlmICghbmFtZSkKICAgICAgbmFtZSA9IHRoaXMudGl0bGUgKyAiKCIgKyAoaW5kZXggKyAxKSArICIpIjsKCiAgICBuYW1lLnJlcGxhY2UoL1wmL2csICImYW1wOyIpOwogICAgbmFtZS5yZXBsYWNlKC9cPC9nLCAiJmx0OyIpOwogICAgbmFtZS5yZXBsYWNlKC9cPi9nLCAiJmd0OyIpOwoKICAgIHJldHVybiBuYW1lOwogIH0sCgogIC8vIGZpbmQgZmlyc3QgaDEgZWxlbWVudCBpbiBET00gdHJlZQogIGZpbmRfaGVhZGluZzogZnVuY3Rpb24gKG5vZGUpIHsKICAgIGlmICghbm9kZSB8fCBub2RlLm5vZGVUeXBlICE9IDEpCiAgICAgIHJldHVybiBudWxsOwoKICAgIGlmIChub2RlLm5vZGVOYW1lID09ICJIMSIgfHwgbm9kZS5ub2RlTmFtZSA9PSAiaDEiKQogICAgICByZXR1cm4gbm9kZTsKCiAgICB2YXIgY2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7CgogICAgd2hpbGUgKGNoaWxkKQogICAgewogICAgICBub2RlID0gdGhpcy5maW5kX2hlYWRpbmcoY2hpbGQpOwoKICAgICAgaWYgKG5vZGUpCiAgICAgICAgcmV0dXJuIG5vZGU7CgogICAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0sCgogIC8vIHJlY3Vyc2l2ZWx5IGV4dHJhY3QgdGV4dCBmcm9tIERPTSB0cmVlCiAgZXh0cmFjdF90ZXh0OiBmdW5jdGlvbiAobm9kZSkgewogICAgaWYgKCFub2RlKQogICAgICByZXR1cm4gIiI7CgogICAgLy8gdGV4dCBub2RlcwogICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMykKICAgICAgcmV0dXJuIG5vZGUubm9kZVZhbHVlOwoKICAgIC8vIGVsZW1lbnRzCiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxKQogICAgewogICAgICBub2RlID0gbm9kZS5maXJzdENoaWxkOwogICAgICB2YXIgdGV4dCA9ICIiOwoKICAgICAgd2hpbGUgKG5vZGUpCiAgICAgIHsKICAgICAgICB0ZXh0ID0gdGV4dCArIHRoaXMuZXh0cmFjdF90ZXh0KG5vZGUpOwogICAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwogICAgICB9CgogICAgICByZXR1cm4gdGV4dDsKICAgIH0KCiAgICByZXR1cm4gIiI7CiAgfSwKCiAgLy8gZmluZCBjb3B5cmlnaHQgdGV4dCBmcm9tIG1ldGEgZWxlbWVudAogIGZpbmRfY29weXJpZ2h0OiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgbmFtZSwgY29udGVudDsKICAgIHZhciBtZXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm1ldGEiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1ldGEubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIG5hbWUgPSBtZXRhW2ldLmdldEF0dHJpYnV0ZSgibmFtZSIpOwogICAgICBjb250ZW50ID0gbWV0YVtpXS5nZXRBdHRyaWJ1dGUoImNvbnRlbnQiKTsKCiAgICAgIGlmIChuYW1lID09ICJjb3B5cmlnaHQiKQogICAgICAgIHJldHVybiBjb250ZW50OwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0sCgogIGZpbmRfc2l6ZV9hZGp1c3Q6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBuYW1lLCBjb250ZW50LCBvZmZzZXQ7CiAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJtZXRhIik7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRhLmxlbmd0aDsgKytpKQogICAgewogICAgICBuYW1lID0gbWV0YVtpXS5nZXRBdHRyaWJ1dGUoIm5hbWUiKTsKICAgICAgY29udGVudCA9IG1ldGFbaV0uZ2V0QXR0cmlidXRlKCJjb250ZW50Iik7CgogICAgICBpZiAobmFtZSA9PSAiZm9udC1zaXplLWFkanVzdG1lbnQiKQogICAgICAgIHJldHVybiAxICogY29udGVudDsKICAgIH0KCiAgICByZXR1cm4gMTsKICB9LAoKICAvLyA8bWV0YSBuYW1lPSJkdXJhdGlvbiIgY29udGVudD0iMjAiIC8+ICBmb3IgMjAgbWludXRlcwogIGZpbmRfZHVyYXRpb246IGZ1bmN0aW9uICgpIHsKICAgIHZhciBuYW1lLCBjb250ZW50LCBvZmZzZXQ7CiAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJtZXRhIik7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRhLmxlbmd0aDsgKytpKQogICAgewogICAgICBuYW1lID0gbWV0YVtpXS5nZXRBdHRyaWJ1dGUoIm5hbWUiKTsKICAgICAgY29udGVudCA9IG1ldGFbaV0uZ2V0QXR0cmlidXRlKCJjb250ZW50Iik7CgogICAgICBpZiAobmFtZSA9PSAiZHVyYXRpb24iKQogICAgICAgIHJldHVybiA2MDAwMCAqIGNvbnRlbnQ7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfSwKCiAgcmVwbGFjZV9ieV9ub25fYnJlYWtpbmdfc3BhY2U6IGZ1bmN0aW9uIChzdHIpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKQogICAgICBzdHJbaV0gPSAxNjA7CiAgfSwKCiAgLy8gIyMjIENIRUNLIE1FICMjIyBpcyB1c2Ugb2YgImxpIiBva2F5IGZvciB0ZXh0L2h0bWw/CiAgLy8gZm9yIFhIVE1MIGRvIHdlIGFsc28gbmVlZCB0byBzcGVjaWZ5IG5hbWVzcGFjZT8KICBpbml0X291dGxpbmVyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXRlbXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGkiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgKytpKQogICAgewogICAgICB2YXIgdGFyZ2V0ID0gaXRlbXNbaV07CgogICAgICBpZiAoIXRoaXMuaGFzX2NsYXNzKHRhcmdldC5wYXJlbnROb2RlLCAib3V0bGluZSIpKQogICAgICAgIGNvbnRpbnVlOwoKICAgICAgdGFyZ2V0Lm9uY2xpY2sgPSB0aGlzLm91dGxpbmVfY2xpY2s7Ci8qICMjIyBtb3JlIHdvcmsgbmVlZGVkIGZvciBJRTYKICAgICAgaWYgKCF0aGlzLm5zX3BvcykKICAgICAgewogICAgICAgIHRhcmdldC5vbm1vdXNlb3ZlciA9IHRoaXMuaG92ZXJfb3V0bGluZTsKICAgICAgICB0YXJnZXQub25tb3VzZW91dCA9IHRoaXMudW5ob3Zlcl9vdXRsaW5lOwogICAgICB9CiovCiAgICAgIGlmICh0aGlzLmZvbGRhYmxlKHRhcmdldCkpCiAgICAgIHsKICAgICAgICB0YXJnZXQuZm9sZGFibGUgPSB0cnVlOwogICAgICAgIHRhcmdldC5vbmZvY3VzID0gZnVuY3Rpb24gKCkge3czY19zbGlkeS5vdXRsaW5lID0gdGhpczt9OwogICAgICAgIHRhcmdldC5vbmJsdXIgPSBmdW5jdGlvbiAoKSB7dzNjX3NsaWR5Lm91dGxpbmUgPSBudWxsO307CgogICAgICAgIGlmICghdGFyZ2V0LmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSkKICAgICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoInRhYmluZGV4IiwgIjAiKTsKCiAgICAgICAgaWYgKHRoaXMuaGFzX2NsYXNzKHRhcmdldCwgImV4cGFuZCIpKQogICAgICAgICAgdGhpcy51bmZvbGQodGFyZ2V0KTsKICAgICAgICBlbHNlCiAgICAgICAgICB0aGlzLmZvbGQodGFyZ2V0KTsKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICB0aGlzLmFkZF9jbGFzcyh0YXJnZXQsICJub2ZvbGQiKTsKICAgICAgICB0YXJnZXQudmlzaWJsZSA9IHRydWU7CiAgICAgICAgdGFyZ2V0LmZvbGRhYmxlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9LAoKICBmb2xkYWJsZTogZnVuY3Rpb24gKGl0ZW0pIHsKICAgIGlmICghaXRlbSB8fCBpdGVtLm5vZGVUeXBlICE9IDEpCiAgICAgIHJldHVybiBmYWxzZTsKCiAgICB2YXIgbm9kZSA9IGl0ZW0uZmlyc3RDaGlsZDsKCiAgICB3aGlsZSAobm9kZSkKICAgIHsKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSAmJiB0aGlzLmlzX2Jsb2NrKG5vZGUpKQogICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIC8vICMjIyBDSEVDSyBNRSAjIyMgc3dpdGNoIHRvIGFkZC9yZW1vdmUgImhpZGRlbiIgY2xhc3MKICBmb2xkOiBmdW5jdGlvbiAoaXRlbSkgewogICAgaWYgKGl0ZW0pCiAgICB7CiAgICAgIHRoaXMucmVtb3ZlX2NsYXNzKGl0ZW0sICJ1bmZvbGRlZCIpOwogICAgICB0aGlzLmFkZF9jbGFzcyhpdGVtLCAiZm9sZGVkIik7CiAgICB9CgogICAgdmFyIG5vZGUgPSBpdGVtID8gaXRlbS5maXJzdENoaWxkIDogbnVsbDsKCiAgICB3aGlsZSAobm9kZSkKICAgIHsKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSAmJiB0aGlzLmlzX2Jsb2NrKG5vZGUpKSAvLyBlbGVtZW50CiAgICAgIHsKICAgICAgICAgdzNjX3NsaWR5LmFkZF9jbGFzcyhub2RlLCAiaGlkZGVuIik7CiAgICAgIH0KCiAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwogICAgfQoKICAgIGl0ZW0udmlzaWJsZSA9IGZhbHNlOwogIH0sCgogIC8vICMjIyBDSEVDSyBNRSAjIyMgc3dpdGNoIHRvIGFkZC9yZW1vdmUgImhpZGRlbiIgY2xhc3MKICB1bmZvbGQ6IGZ1bmN0aW9uIChpdGVtKSB7CiAgICBpZiAoaXRlbSkKICAgIHsKICAgICAgdGhpcy5hZGRfY2xhc3MoaXRlbSwgInVuZm9sZGVkIik7CiAgICAgIHRoaXMucmVtb3ZlX2NsYXNzKGl0ZW0sICJmb2xkZWQiKTsKICAgIH0KCiAgICB2YXIgbm9kZSA9IGl0ZW0gPyBpdGVtLmZpcnN0Q2hpbGQgOiBudWxsOwoKICAgIHdoaWxlIChub2RlKQogICAgewogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxICYmIHRoaXMuaXNfYmxvY2sobm9kZSkpIC8vIGVsZW1lbnQKICAgICAgewogICAgICAgIHczY19zbGlkeS5yZW1vdmVfY2xhc3Mobm9kZSwgImhpZGRlbiIpOwogICAgICB9CgogICAgICBub2RlID0gbm9kZS5uZXh0U2libGluZzsKICAgIH0KCiAgICBpdGVtLnZpc2libGUgPSB0cnVlOwogIH0sCgogIG91dGxpbmVfY2xpY2s6IGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoIWUpCiAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgdmFyIHJpZ2h0Y2xpY2sgPSBmYWxzZTsKICAgIHZhciB0YXJnZXQgPSB3M2Nfc2xpZHkuZ2V0X3RhcmdldChlKTsKCiAgICB3aGlsZSAodGFyZ2V0ICYmIHRhcmdldC52aXNpYmxlID09IHVuZGVmaW5lZCkKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CgogICAgaWYgKCF0YXJnZXQpCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGlmIChlLndoaWNoKQogICAgICByaWdodGNsaWNrID0gKGUud2hpY2ggPT0gMyk7CiAgICBlbHNlIGlmIChlLmJ1dHRvbikKICAgICAgcmlnaHRjbGljayA9IChlLmJ1dHRvbiA9PSAyKTsKCiAgICBpZiAoIXJpZ2h0Y2xpY2sgJiYgdGFyZ2V0LnZpc2libGUgIT0gdW5kZWZpbmVkKQogICAgewogICAgICBpZiAodGFyZ2V0LmZvbGRhYmxlKQogICAgICB7CiAgICAgICAgaWYgKHRhcmdldC52aXNpYmxlKQogICAgICAgICAgdzNjX3NsaWR5LmZvbGQodGFyZ2V0KTsKICAgICAgICBlbHNlCiAgICAgICAgICB3M2Nfc2xpZHkudW5mb2xkKHRhcmdldCk7CiAgICAgIH0KCiAgICAgIHczY19zbGlkeS5zdG9wX3Byb3BhZ2F0aW9uKGUpOwogICAgICBlLmNhbmNlbCA9IHRydWU7CiAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwKCiAgYWRkX2luaXRpYWxfcHJvbXB0OiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgcHJvbXB0ID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiZGl2Iik7CiAgICBwcm9tcHQuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJpbml0aWFsX3Byb21wdCIpOwoKICAgIHZhciBwMSA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoInAiKTsKICAgIHByb21wdC5hcHBlbmRDaGlsZChwMSk7CiAgICBwMS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImhlbHAiKTsKCiAgICBpZiAodGhpcy5rZXlib2FyZGxlc3MpCiAgICAgIHAxLmlubmVySFRNTCA9ICJzd2lwZSBsZWZ0IHRvIG1vdmUgdG8gbmV4dCBzbGlkZSI7CiAgICBlbHNlCiAgICAgIHAxLmlubmVySFRNTCA9ICJTcGFjZSwgUmlnaHQgQXJyb3cgb3Igc3dpcGUgbGVmdCB0byBtb3ZlIHRvICIgKwogICAgICAgICAgICAgICAgICAgICAibmV4dCBzbGlkZSwgY2xpY2sgaGVscCBiZWxvdyBmb3IgbW9yZSBkZXRhaWxzIjsKCiAgICB0aGlzLmFkZF9saXN0ZW5lcihwcm9tcHQsICJjbGljayIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQocHJvbXB0KTsKICAgICAgdzNjX3NsaWR5LnN0b3BfcHJvcGFnYXRpb24oZSk7CiAgICAKICAgICAgaWYgKGUuY2FuY2VsICE9IHVuZGVmaW5lZCkKICAgICAgICBlLmNhbmNlbCA9IHRydWU7CiAgICAgIAogICAgICBpZiAoZS5yZXR1cm5WYWx1ZSAhPSB1bmRlZmluZWQpCiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwogICAgICAKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7CgogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9tcHQpOwogICAgdGhpcy5pbml0aWFsX3Byb21wdCA9IHByb21wdDsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChwcm9tcHQpO30sIDUwMDApOwogIH0sCgogIGFkZF90b29sYmFyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgY291bnRlciwgcGFnZTsKCiAgICAgdGhpcy50b29sYmFyID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiZGl2Iik7CiAgICAgdGhpcy50b29sYmFyLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAidG9vbGJhciIpOwoKICAgICAvLyBhIHJlYXNvbmFibHkgYmVoYXZlZCBicm93c2VyCiAgICAgaWYgKHRoaXMubnNfcG9zIHx8ICF0aGlzLmllNikKICAgICB7CiAgICAgICB2YXIgcmlnaHQgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJkaXYiKTsKICAgICAgIHJpZ2h0LnNldEF0dHJpYnV0ZSgic3R5bGUiLCAiZmxvYXQ6IHJpZ2h0OyB0ZXh0LWFsaWduOiByaWdodCIpOwoKICAgICAgIGNvdW50ZXIgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIikKICAgICAgIGNvdW50ZXIuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgic2xpZGUiKSArICIgbi9tIjsKICAgICAgIHJpZ2h0LmFwcGVuZENoaWxkKGNvdW50ZXIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKHJpZ2h0KTsKCiAgICAgICB2YXIgbGVmdCA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImRpdiIpOwogICAgICAgbGVmdC5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgInRleHQtYWxpZ246IGxlZnQiKTsKCiAgICAgICAvLyBnbG9iYWwgZW5kIG9mIHNsaWRlIGluZGljYXRvcgogICAgICAgdGhpcy5lb3MgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIik7CiAgICAgICB0aGlzLmVvcy5pbm5lckhUTUwgPSAiKiAiOwogICAgICAgbGVmdC5hcHBlbmRDaGlsZCh0aGlzLmVvcyk7CgogICAgICAgdmFyIGhlbHAgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJhIik7CiAgICAgICBoZWxwLnNldEF0dHJpYnV0ZSgiaHJlZiIsIHRoaXMuaGVscF9wYWdlKTsKICAgICAgIGhlbHAuc2V0QXR0cmlidXRlKCJ0aXRsZSIsIHRoaXMubG9jYWxpemUodGhpcy5oZWxwX3RleHQpKTsKICAgICAgIGhlbHAuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgiaGVscD8iKTsKICAgICAgIGxlZnQuYXBwZW5kQ2hpbGQoaGVscCk7CiAgICAgICBoZWxwLnN0eWxlLmRpc3BsYXk9Im5vbmUiOyAKICAgICAgIHRoaXMuaGVscF9hbmNob3IgPSBoZWxwOyAgLy8gc2F2ZSBmb3IgZm9jdXMgaGFjawoKICAgICAgIHZhciBnYXAxID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiAiKTsKICAgICAgIGxlZnQuYXBwZW5kQ2hpbGQoZ2FwMSk7CgogICAgICAgdmFyIGNvbnRlbnRzID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiYSIpOwogICAgICAgY29udGVudHMuc2V0QXR0cmlidXRlKCJocmVmIiwgImphdmFzY3JpcHQ6dzNjX3NsaWR5LnRvZ2dsZV90YWJsZV9vZl9jb250ZW50cygpIik7CiAgICAgICBjb250ZW50cy5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGhpcy5sb2NhbGl6ZSgidGFibGUgb2YgY29udGVudHMiKSk7CiAgICAgICBjb250ZW50cy5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKCJDb250ZW50cyIpOwogICAgICAgbGVmdC5hcHBlbmRDaGlsZChjb250ZW50cyk7CgogICAgICAgdmFyIGdhcDIgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiICIpOwogICAgICAgbGVmdC5hcHBlbmRDaGlsZChnYXAyKTsKCiAgICAgICB2YXIgY29weXJpZ2h0ID0gdGhpcy5maW5kX2NvcHlyaWdodCgpOwoKICAgICAgIGlmIChjb3B5cmlnaHQpCiAgICAgICB7CiAgICAgICAgIHZhciBzcGFuID0gdGhpcy5jcmVhdGVfZWxlbWVudCgic3BhbiIpOwogICAgICAgICBzcGFuLmNsYXNzTmFtZSA9ICJjb3B5cmlnaHQiOwogICAgICAgICBzcGFuLmlubmVySFRNTCA9IGNvcHlyaWdodDsKICAgICAgICAgbGVmdC5hcHBlbmRDaGlsZChzcGFuKTsKICAgICAgIH0KCiAgICAgICB0aGlzLnRvb2xiYXIuc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsICIwIik7CiAgICAgICB0aGlzLnRvb2xiYXIuYXBwZW5kQ2hpbGQobGVmdCk7CiAgICAgfQogICAgIGVsc2UgLy8gSUU2IHNvIG5lZWQgdG8gd29yayBhcm91bmQgaXRzIHBvb3IgQ1NTIHN1cHBvcnQKICAgICB7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUucG9zaXRpb24gPSAodGhpcy5pZTcgPyAiZml4ZWQiIDogImFic29sdXRlIik7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUuekluZGV4ID0gIjIwMCI7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUud2lkdGggPSAiOTkuOSUiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLmhlaWdodCA9ICIxLjJlbSI7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUudG9wID0gImF1dG8iOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLmJvdHRvbSA9ICIwIjsKICAgICAgIHRoaXMudG9vbGJhci5zdHlsZS5sZWZ0ID0gIjAiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLnJpZ2h0ID0gIjAiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLnRleHRBbGlnbiA9ICJsZWZ0IjsKICAgICAgIHRoaXMudG9vbGJhci5zdHlsZS5mb250U2l6ZSA9ICI2MCUiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLmNvbG9yID0gInJlZCI7CiAgICAgICB0aGlzLnRvb2xiYXIuYm9yZGVyV2lkdGggPSAwOwogICAgICAgdGhpcy50b29sYmFyLmNsYXNzTmFtZSA9ICJ0b29sYmFyIjsKICAgICAgIHRoaXMudG9vbGJhci5zdHlsZS5iYWNrZ3JvdW5kID0gInJnYigyNDAsMjQwLDI0MCkiOwoKICAgICAgIC8vIHdvdWxkIGxpa2UgdG8gaGF2ZSBoZWxwIHRleHQgbGVmdCBhbGlnbmVkCiAgICAgICAvLyBhbmQgcGFnZSBjb3VudGVyIHJpZ2h0IGFsaWduZWQsIGZsb2F0aW5nCiAgICAgICAvLyBkaXYncyBkb24ndCB3b3JrLCBzbyBpbnN0ZWFkIHVzZSBuZXN0ZWQKICAgICAgIC8vIGFic29sdXRlbHkgcG9zaXRpb25lZCBkaXYncy4KCiAgICAgICB2YXIgc3AgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIik7CiAgICAgICBzcC5pbm5lckhUTUwgPSAiJm5ic3A7Jm5ic3A7KiZuYnNwOyI7CiAgICAgICB0aGlzLnRvb2xiYXIuYXBwZW5kQ2hpbGQoc3ApOwogICAgICAgdGhpcy5lb3MgPSBzcDsgIC8vIGVuZCBvZiBzbGlkZSBpbmRpY2F0b3IKCiAgICAgICB2YXIgaGVscCA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImEiKTsKICAgICAgIGhlbHAuc2V0QXR0cmlidXRlKCJocmVmIiwgdGhpcy5oZWxwX3BhZ2UpOwogICAgICAgaGVscC5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGhpcy5sb2NhbGl6ZSh0aGlzLmhlbHBfdGV4dCkpOwogICAgICAgaGVscC5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKCJoZWxwPyIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKGhlbHApOwogICAgICAgdGhpcy5oZWxwX2FuY2hvciA9IGhlbHA7ICAvLyBzYXZlIGZvciBmb2N1cyBoYWNrCgogICAgICAgdmFyIGdhcDEgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiICIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKGdhcDEpOwoKICAgICAgIHZhciBjb250ZW50cyA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImEiKTsKICAgICAgIGNvbnRlbnRzLnNldEF0dHJpYnV0ZSgiaHJlZiIsICJqYXZhc2NyaXB0OnRvZ2dsZVRhYmxlT2ZDb250ZW50cygpIik7CiAgICAgICBjb250ZW50cy5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGhpcy5sb2NhbGl6ZSgidGFibGUgb2YgY29udGVudHMiLmxvY2FsaXplKSk7CiAgICAgICBjb250ZW50cy5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKCJjb250ZW50cz8iKTsKICAgICAgIHRoaXMudG9vbGJhci5hcHBlbmRDaGlsZChjb250ZW50cyk7CgogICAgICAgdmFyIGdhcDIgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiICIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKGdhcDIpOwoKICAgICAgIHZhciBjb3B5cmlnaHQgPSB0aGlzLmZpbmRfY29weXJpZ2h0KCk7CgogICAgICAgaWYgKGNvcHlyaWdodCkKICAgICAgIHsKICAgICAgICAgdmFyIHNwYW4gPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIik7CiAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gY29weXJpZ2h0OwogICAgICAgICBzcGFuLnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICAgc3Bhbi5zdHlsZS5tYXJnaW5MZWZ0ID0gIjAuNWVtIjsKICAgICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKHNwYW4pOwogICAgICAgfQoKICAgICAgIGNvdW50ZXIgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJkaXYiKQogICAgICAgY291bnRlci5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICAgICBjb3VudGVyLnN0eWxlLndpZHRoID0gImF1dG8iOyAvLyIyMCUiOwogICAgICAgY291bnRlci5zdHlsZS5oZWlnaHQgPSAiMS4yZW0iOwogICAgICAgY291bnRlci5zdHlsZS50b3AgPSAiYXV0byI7CiAgICAgICBjb3VudGVyLnN0eWxlLmJvdHRvbSA9IDA7CiAgICAgICBjb3VudGVyLnN0eWxlLnJpZ2h0ID0gIjAiOwogICAgICAgY291bnRlci5zdHlsZS50ZXh0QWxpZ24gPSAicmlnaHQiOwogICAgICAgY291bnRlci5zdHlsZS5jb2xvciA9ICJyZWQiOwogICAgICAgY291bnRlci5zdHlsZS5iYWNrZ3JvdW5kID0gInJnYigyNDAsMjQwLDI0MCkiOwoKICAgICAgIGNvdW50ZXIuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgic2xpZGUiKSArICIgbi9tIjsKICAgICAgIHRoaXMudG9vbGJhci5hcHBlbmRDaGlsZChjb3VudGVyKTsKICAgICB9CgogICAgIC8vIGVuc3VyZSB0aGF0IGNsaWNrIGlzbid0IHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwYWdlCiAgICAgdGhpcy50b29sYmFyLm9uY2xpY2sgPQogICAgICAgICBmdW5jdGlvbiAoZSkgewogICAgICAgICAgIGlmICghZSkKICAgICAgICAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDsKCiAgICAgICAgICAgaWYgKCF0YXJnZXQgJiYgZS5zcmNFbGVtZW50KQogICAgICAgICAgICAgdGFyZ2V0ID0gZS5zcmNFbGVtZW50OwoKICAgICAgICAgICAvLyB3b3JrIGFyb3VuZCBTYWZhcmkgYnVnCiAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQubm9kZVR5cGUgPT0gMykKICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwoKICAgICAgICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihlKTsKCiAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPSAiYSIpCiAgICAgICAgICAgICB3M2Nfc2xpZHkubW91c2VfYnV0dG9uX2NsaWNrKGUpOwogICAgICAgICB9OwoKICAgICB0aGlzLnNsaWRlX251bWJlcl9lbGVtZW50ID0gY291bnRlcjsKICAgICB0aGlzLnNldF9lb3Nfc3RhdHVzKGZhbHNlKTsKICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMudG9vbGJhcik7CiAgfSwKCiAgLy8gd3lzaXd5ZyBlZGl0b3JzIG1ha2UgaXQgaGFyZCB0byB1c2UgZGl2IGVsZW1lbnRzCiAgLy8gZS5nLiBhbWF5YSBsb3NlcyB0aGUgZGl2IHdoZW4geW91IGNvcHkgYW5kIHBhc3RlCiAgLy8gdGhpcyBmdW5jdGlvbiB3cmFwcyBkaXYgZWxlbWVudHMgYXJvdW5kIGltcGxpY2l0CiAgLy8gc2xpZGVzIHdoaWNoIHN0YXJ0IHdpdGggYW4gaDEgZWxlbWVudCBhbmQgY29udGludWUKICAvLyB1cCB0byB0aGUgbmV4dCBoZWFkaW5nIG9yIGRpdiBlbGVtZW50CiAgd3JhcF9pbXBsaWNpdF9zbGlkZXM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBpLCBoZWFkaW5nLCBub2RlLCBuZXh0LCBkaXY7CiAgICB2YXIgaGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDEiKTsKCiAgICBpZiAoIWhlYWRpbmdzKQogICAgICByZXR1cm47CgogICAgZm9yIChpID0gMDsgaSA8IGhlYWRpbmdzLmxlbmd0aDsgKytpKQogICAgewogICAgICBoZWFkaW5nID0gaGVhZGluZ3NbaV07CgogICAgICBpZiAoaGVhZGluZy5wYXJlbnROb2RlICE9IGRvY3VtZW50LmJvZHkpCiAgICAgICAgY29udGludWU7CgogICAgICBub2RlID0gaGVhZGluZy5uZXh0U2libGluZzsKCiAgICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB0aGlzLmFkZF9jbGFzcyhkaXYsICJzbGlkZSIpOwogICAgICBkb2N1bWVudC5ib2R5LnJlcGxhY2VDaGlsZChkaXYsIGhlYWRpbmcpOwogICAgICBkaXYuYXBwZW5kQ2hpbGQoaGVhZGluZyk7CgogICAgICB3aGlsZSAobm9kZSkKICAgICAgewogICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEpIC8vIGFuIGVsZW1lbnQKICAgICAgICB7CiAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT0gIkgxIiB8fCBub2RlLm5vZGVOYW1lID09ICJoMSIpCiAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT0gIkRJViIgfHwgbm9kZS5ub2RlTmFtZSA9PSAiZGl2IikKICAgICAgICAgICB7CiAgICAgICAgICAgICBpZiAodGhpcy5oYXNfY2xhc3Mobm9kZSwgInNsaWRlIikpCiAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgIGlmICh0aGlzLmhhc19jbGFzcyhub2RlLCAiaGFuZG91dCIpKQogICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBuZXh0ID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgICBub2RlID0gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgICBkaXYuYXBwZW5kQ2hpbGQobm9kZSk7CiAgICAgICAgbm9kZSA9IG5leHQ7CiAgICAgIH0gCiAgICB9CiAgfSwKCiAgYXR0YWNoX3RvdWNoX2hhbmRlcnM6IGZ1bmN0aW9uKHNsaWRlcykKICB7CiAgICB2YXIgaSwgc2xpZGU7CgogICAgZm9yIChpID0gMDsgaSA8IHNsaWRlcy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgc2xpZGUgPSBzbGlkZXNbaV07CiAgICAgIHRoaXMuYWRkX2xpc3RlbmVyKHNsaWRlLCAidG91Y2hzdGFydCIsIHRoaXMudG91Y2hzdGFydCk7CiAgICAgIHRoaXMuYWRkX2xpc3RlbmVyKHNsaWRlLCAidG91Y2htb3ZlIiwgdGhpcy50b3VjaG1vdmUpOwogICAgICB0aGlzLmFkZF9saXN0ZW5lcihzbGlkZSwgInRvdWNoZW5kIiwgdGhpcy50b3VjaGVuZCk7CiAgICB9CiAgfSwKCi8vIHJldHVybiBuZXcgYXJyYXkgb2YgYWxsIHNsaWRlcwogIGNvbGxlY3Rfc2xpZGVzOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2xpZGVzID0gbmV3IEFycmF5KCk7CiAgICB2YXIgZGl2cyA9IGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImRpdiIpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGl2cy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgZGl2ID0gZGl2cy5pdGVtKGkpOwoKICAgICAgaWYgKHRoaXMuaGFzX2NsYXNzKGRpdiwgInNsaWRlIikpCiAgICAgIHsKICAgICAgICAvLyBhZGQgc2xpZGUgdG8gY29sbGVjdGlvbgogICAgICAgIHNsaWRlc1tzbGlkZXMubGVuZ3RoXSA9IGRpdjsKCiAgICAgICAgLy8gaGlkZSBlYWNoIHNsaWRlIGFzIGl0IGlzIGZvdW5kCiAgICAgICAgdGhpcy5hZGRfY2xhc3MoZGl2LCAiaGlkZGVuIik7CgogICAgICAgIC8vIGFkZCBkdW1teSA8YnIvPiBhdCBlbmQgZm9yIHNjcm9sbGluZyBoYWNrCiAgICAgICAgdmFyIG5vZGUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnIiKTsKICAgICAgICBkaXYuYXBwZW5kQ2hpbGQobm9kZTEpOwogICAgICAgIHZhciBub2RlMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJyIik7CiAgICAgICAgZGl2LmFwcGVuZENoaWxkKG5vZGUyKTsKICAgICAgfQogICAgICBlbHNlIGlmICh0aGlzLmhhc19jbGFzcyhkaXYsICJiYWNrZ3JvdW5kIikpCiAgICAgIHsgIC8vIHdvcmsgYXJvdW5kIGZvciBGaXJlZm94IFNWRyByZWxvYWQgYnVnCiAgICAgICAgLy8gd2hpY2ggb3RoZXJ3aXNlIHJlcGxhY2VzIDFzdCBTVkcgZ3JhcGhpYyB3aXRoIDJuZAogICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgfQogICAgfQoKICAgIHRoaXMuc2xpZGVzID0gc2xpZGVzOwogIH0sCgogIC8vIHJldHVybiBuZXcgYXJyYXkgb2YgYWxsIDxkaXYgY2xhc3M9ImhhbmRvdXQiPgogIGNvbGxlY3Rfbm90ZXM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBub3RlcyA9IG5ldyBBcnJheSgpOwogICAgdmFyIGRpdnMgPSBkb2N1bWVudC5ib2R5LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJkaXYiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpdnMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIGRpdiA9IGRpdnMuaXRlbShpKTsKCiAgICAgIGlmICh0aGlzLmhhc19jbGFzcyhkaXYsICJoYW5kb3V0IikpCiAgICAgIHsKICAgICAgICAvLyBhZGQgbm90ZSB0byBjb2xsZWN0aW9uCiAgICAgICAgbm90ZXNbbm90ZXMubGVuZ3RoXSA9IGRpdjsKCiAgICAgICAgLy8gYW5kIGhpZGUgaXQKICAgICAgICB0aGlzLmFkZF9jbGFzcyhkaXYsICJoaWRkZW4iKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMubm90ZXMgPSBub3RlczsKICB9LAoKICAvLyByZXR1cm4gbmV3IGFycmF5IG9mIGFsbCA8ZGl2IGNsYXNzPSJiYWNrZ3JvdW5kIj4KICAvLyBpbmNsdWRpbmcgbmFtZWQgYmFja2dyb3VuZHMgZS5nLiBjbGFzcz0iYmFja2dyb3VuZCB0aXRsZXBhZ2UiCiAgY29sbGVjdF9iYWNrZ3JvdW5kczogZnVuY3Rpb24gKCkgewogICAgdmFyIGJhY2tncm91bmRzID0gbmV3IEFycmF5KCk7CiAgICB2YXIgZGl2cyA9IGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImRpdiIpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGl2cy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgZGl2ID0gZGl2cy5pdGVtKGkpOwoKICAgICAgaWYgKHRoaXMuaGFzX2NsYXNzKGRpdiwgImJhY2tncm91bmQiKSkKICAgICAgewogICAgICAgIC8vIGFkZCBiYWNrZ3JvdW5kIHRvIGNvbGxlY3Rpb24KICAgICAgICBiYWNrZ3JvdW5kc1tiYWNrZ3JvdW5kcy5sZW5ndGhdID0gZGl2OwoKICAgICAgICAvLyBhbmQgaGlkZSBpdAogICAgICAgIHRoaXMuYWRkX2NsYXNzKGRpdiwgImhpZGRlbiIpOwogICAgICB9CiAgICB9CgogICAgdGhpcy5iYWNrZ3JvdW5kcyA9IGJhY2tncm91bmRzOwogIH0sCgogIC8vIHNldCBjbGljayBoYW5kbGVycyBvbiBhbGwgYW5jaG9ycwogIHBhdGNoX2FuY2hvcnM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdzNjX3NsaWR5OwogICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgLy8gY29tcGFyZSB0aGlzLmhyZWYgd2l0aCBsb2NhdGlvbi5ocmVmCiAgICAgIC8vIGZvciBsaW5rIHRvIGFub3RoZXIgc2xpZGUgaW4gdGhpcyBkb2MKCiAgICAgIGlmIChzZWxmLnBhZ2VfYWRkcmVzcyh0aGlzLmhyZWYpID09IHNlbGYucGFnZV9hZGRyZXNzKGxvY2F0aW9uLmhyZWYpKQogICAgICB7CiAgICAgICAgLy8geWVzLCBzbyBmaW5kIG5ldyBzbGlkZSBudW1iZXIKICAgICAgICB2YXIgbmV3c2xpZGVudW0gPSBzZWxmLmZpbmRfc2xpZGVfbnVtYmVyKHRoaXMuaHJlZik7CgogICAgICAgIGlmIChuZXdzbGlkZW51bSAhPSBzZWxmLnNsaWRlX251bWJlcikKICAgICAgICB7CiAgICAgICAgICB2YXIgc2xpZGUgPSBzZWxmLnNsaWRlc1tzZWxmLnNsaWRlX251bWJlcl07CiAgICAgICAgICBzZWxmLmhpZGVfc2xpZGUoc2xpZGUpOwogICAgICAgICAgc2VsZi5zbGlkZV9udW1iZXIgPSBuZXdzbGlkZW51bTsKICAgICAgICAgIHNsaWRlID0gc2VsZi5zbGlkZXNbc2VsZi5zbGlkZV9udW1iZXJdOwogICAgICAgICAgc2VsZi5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgICAgIHNlbGYuc2V0X2xvY2F0aW9uKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGVsc2UKICAgICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihldmVudCk7CgovLyAgICAgIGVsc2UgaWYgKHRoaXMudGFyZ2V0ID09IG51bGwpCi8vICAgICAgICBsb2NhdGlvbi5ocmVmID0gdGhpcy5ocmVmOwoKICAgICAgdGhpcy5ibHVyKCk7CiAgICAgIHNlbGYuZGlzYWJsZV9zbGlkZV9jbGljayA9IHRydWU7CiAgICB9OwoKICAgIHZhciBhbmNob3JzID0gZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5jaG9ycy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKQogICAgICAgIGFuY2hvcnNbaV0uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBoYW5kbGVyLCBmYWxzZSk7CiAgICAgIGVsc2UKICAgICAgICBhbmNob3JzW2ldLmF0dGFjaEV2ZW50KCJvbmNsaWNrIiwgaGFuZGxlcik7CiAgICB9CiAgfSwKCiAgLy8gIyMjIENIRUNLIE1FICMjIyBzZWUgd2hpY2ggZnVuY3Rpb25zIGFyZSBpbnZva2VkIHZpYSBzZXRUaW1lb3V0CiAgLy8gZWl0aGVyIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkgZm9yIHVzZSBvZiB3M2Nfc2xpZHkgdnMgdGhpcwogIHNob3dfc2xpZGVfbnVtYmVyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdGltZXIgPSB3M2Nfc2xpZHkuZ2V0X3RpbWVyKCk7CiAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyX2VsZW1lbnQuaW5uZXJIVE1MID0gdGltZXIgKyB3M2Nfc2xpZHkubG9jYWxpemUoInNsaWRlIikgKyAiICIgKwogICAgICAgICAgICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyICsgMSkgKyAiLyIgKyB3M2Nfc2xpZHkuc2xpZGVzLmxlbmd0aDsKICB9LAoKICAvLyBldmVyeSAyMDBtUyBjaGVjayBpZiB0aGUgbG9jYXRpb24gaGFzIGJlZW4gY2hhbmdlZCBhcyBhCiAgLy8gcmVzdWx0IG9mIHRoZSB1c2VyIGFjdGl2YXRpbmcgdGhlIEJhY2sgYnV0dG9uL21lbnUgaXRlbQogIC8vIGRvZXNuJ3Qgd29yayBmb3IgT3BlcmEgPCA5LjUKICBjaGVja19sb2NhdGlvbjogZnVuY3Rpb24gKCkgewogICAgdmFyIGhhc2ggPSBsb2NhdGlvbi5oYXNoOwoKICAgIGlmICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID4gMCAmJiAoaGFzaCA9PSAiIiB8fCBoYXNoID09ICIjIikpCiAgICAgIHczY19zbGlkeS5nb3RvX3NsaWRlKDApOwogICAgZWxzZSBpZiAoaGFzaC5sZW5ndGggPiAyICYmIGhhc2ggIT0gIiMoIisodzNjX3NsaWR5LnNsaWRlX251bWJlcisxKSsiKSIpCiAgICB7CiAgICAgIHZhciBudW0gPSBwYXJzZUludChsb2NhdGlvbi5oYXNoLnN1YnN0cigyKSk7CgogICAgICBpZiAoIWlzTmFOKG51bSkpCiAgICAgICAgdzNjX3NsaWR5LmdvdG9fc2xpZGUobnVtLTEpOwogICAgfQoKICAgIGlmICh3M2Nfc2xpZHkudGltZV9sZWZ0ICYmIHczY19zbGlkeS5zbGlkZV9udW1iZXIgPiAwKQogICAgewogICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZV9udW1iZXIoKTsKCiAgICAgIGlmICh3M2Nfc2xpZHkudGltZV9sZWZ0ID4gMCkKICAgICAgICB3M2Nfc2xpZHkudGltZV9sZWZ0IC09IDIwMDsKICAgIH0gCiAgfSwKCiAgZ2V0X3RpbWVyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdGltZXIgPSAiIjsKICAgIGlmICh3M2Nfc2xpZHkudGltZV9sZWZ0KQogICAgewogICAgICB2YXIgbWlucywgc2VjczsKICAgICAgc2VjcyA9IE1hdGguZmxvb3IodzNjX3NsaWR5LnRpbWVfbGVmdC8xMDAwKTsKICAgICAgbWlucyA9IE1hdGguZmxvb3Ioc2VjcyAvIDYwKTsKICAgICAgc2VjcyA9IHNlY3MgJSA2MDsKICAgICAgdGltZXIgPSAobWlucyA/IG1pbnMrIm0iIDogIiIpICsgc2VjcyArICJzICI7CiAgICB9CgogICAgcmV0dXJuIHRpbWVyOwogIH0sCgogIC8vIHRoaXMgZG9lc24ndCBwdXNoIGxvY2F0aW9uIG9udG8gaGlzdG9yeSBzdGFjayBmb3IgSUUKICAvLyBmb3Igd2hpY2ggYSBoaWRkZW4gaWZyYW1lIGhhY2sgaXMgbmVlZGVkOiBsb2FkIHBhZ2UgaW50bwogIC8vIHRoZSBpZnJhbWUgd2l0aCBzY3JpcHQgdGhhdCBzZXQncyBwYXJlbnQncyBsb2NhdGlvbi5oYXNoCiAgLy8gYnV0IHRoYXQgd29uJ3Qgd29yayBmb3Igc3RhbmRhbG9uZSB1c2UgdW5sZXNzIHdlIGNhbgogIC8vIGNyZWF0ZSB0aGUgcGFnZSBkeW5hbWljYWxseSB2aWEgYSBqYXZhc2NyaXB0OiBVUkwKICAvLyAjIyMgdXNlIGhpc3RvcnkucHVzaFN0YXRlIGlmIGF2YWlsYWJsZQogIHNldF9sb2NhdGlvbjogZnVuY3Rpb24gKCkgewogICAgIHZhciB1cmkgPSB3M2Nfc2xpZHkucGFnZV9hZGRyZXNzKGxvY2F0aW9uLmhyZWYpOwogICAgIHZhciBoYXNoID0gIiMoIiArICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyKzEpICsgIikiOwoKICAgICBpZiAodzNjX3NsaWR5LnNsaWRlX251bWJlciA+PSAwKQogICAgICAgdXJpID0gdXJpICsgaGFzaDsKCiAgICAgaWYgKHR5cGVvZihoaXN0b3J5LnB1c2hTdGF0ZSkgIT0gInVuZGVmaW5lZCIgJiYgbG9jYXRpb24ucHJvdG9jb2wgIT09ICJmaWxlOiIpCiAgICAgewogICAgICAgZG9jdW1lbnQudGl0bGUgPSB3M2Nfc2xpZHkudGl0bGUgKyAiICgiICsgKHczY19zbGlkeS5zbGlkZV9udW1iZXIrMSkgKyAiKSI7CiAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZSgwLCBkb2N1bWVudC50aXRsZSwgaGFzaCk7CiAgICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZV9udW1iZXIoKTsKICAgICAgIHczY19zbGlkeS5ub3RpZnlfb2JzZXJ2ZXJzKCk7CiAgICAgICByZXR1cm47CiAgICAgfQoKICAgICBpZiAodzNjX3NsaWR5LmllICYmICh3M2Nfc2xpZHkuaWU2IHx8IHczY19zbGlkeS5pZTcpKQogICAgICAgdzNjX3NsaWR5LnB1c2hfaGFzaChoYXNoKTsKCiAgICAgaWYgKHVyaSAhPSBsb2NhdGlvbi5ocmVmKSAvLyAmJiAha2h0bWwKICAgICAgICBsb2NhdGlvbi5ocmVmID0gdXJpOwoKICAgICBpZiAodGhpcy5raHRtbCkKICAgICAgICBoYXNoID0gIigiICsgKHczY19zbGlkeS5zbGlkZV9udW1iZXIrMSkgKyAiKSI7CgogICAgIGlmICghdGhpcy5pZSAmJiBsb2NhdGlvbi5oYXNoICE9IGhhc2ggJiYgbG9jYXRpb24uaGFzaCAhPSAiIikKICAgICAgIGxvY2F0aW9uLmhhc2ggPSBoYXNoOwoKICAgICBkb2N1bWVudC50aXRsZSA9IHczY19zbGlkeS50aXRsZSArICIgKCIgKyAodzNjX3NsaWR5LnNsaWRlX251bWJlcisxKSArICIpIjsKICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZV9udW1iZXIoKTsKICAgICB3M2Nfc2xpZHkubm90aWZ5X29ic2VydmVycygpOwogIH0sCgogIG5vdGlmeV9vYnNlcnZlcnM6IGZ1bmN0aW9uICgpCiAgewogICAgdmFyIHNsaWRlID0gdGhpcy5zbGlkZXNbdGhpcy5zbGlkZV9udW1iZXJdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyArK2kpCiAgICAgIHRoaXMub2JzZXJ2ZXJzW2ldKHRoaXMuc2xpZGVfbnVtYmVyKzEsIHRoaXMuZmluZF9oZWFkaW5nKHNsaWRlKS5pbm5lclRleHQsIGxvY2F0aW9uLmhyZWYpOwogIH0sCgogIGFkZF9vYnNlcnZlcjogZnVuY3Rpb24gKG9ic2VydmVyKQogIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIGlmIChvYnNlcnZlciA9PSB0aGlzLm9ic2VydmVyc1tpXSkKICAgICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7CiAgfSwKCiAgcmVtb3ZlX29ic2VydmVyOiBmdW5jdGlvbiAobykKICB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJzLmxlbmd0aDsgKytpKQogICAgewogICAgICBpZiAob2JzZXJ2ZXIgPT0gdGhpcy5vYnNlcnZlcnNbaV0pCiAgICAgIHsKICAgICAgICB0aGlzLm9ic2VydmVycy5zcGxpY2UoaSwxKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0sCgogIHBhZ2VfYWRkcmVzczogZnVuY3Rpb24gKHVyaSkgewogICAgdmFyIGkgPSB1cmkuaW5kZXhPZigiIyIpOwoKICAgIGlmIChpIDwgMCkKICAgICAgaSA9IHVyaS5pbmRleE9mKCIlMjMiKTsKCiAgICAvLyBjaGVjayBpZiBhbmNob3IgaXMgZW50aXJlIHBhZ2UKCiAgICBpZiAoaSA8IDApCiAgICAgIHJldHVybiB1cmk7ICAvLyB5ZXMKCiAgICByZXR1cm4gdXJpLnN1YnN0cigwLCBpKTsKICB9LAoKICAvLyBvbmx5IHVzZWQgZm9yIElFNiBhbmQgSUU3CiAgb25fZnJhbWVfbG9hZGVkOiBmdW5jdGlvbiAoaGFzaCkgewogICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7CiAgICB2YXIgdXJpID0gdzNjX3NsaWR5LnBhZ2VfYWRkcmVzcyhsb2NhdGlvbi5ocmVmKTsKICAgIGxvY2F0aW9uLmhyZWYgPSB1cmkgKyBoYXNoOwogIH0sCgogIC8vIGhpc3RvcnkgaGFjayB3aXRoIHRoYW5rcyB0byBCZXJ0cmFuZCBMZSBSb3kKICBwdXNoX2hhc2g6IGZ1bmN0aW9uIChoYXNoKSB7CiAgICBpZiAoaGFzaCA9PSAiIikgaGFzaCA9ICIjKDEpIjsKICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBoYXNoOwoKICAgIHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGlzdG9yeUZyYW1lIikuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICAgIGRvYy5vcGVuKCJqYXZhc2NyaXB0Oic8aHRtbD48L2h0bWw+JyIpOwogICAgZG9jLndyaXRlKCI8aHRtbD48aGVhZD48c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj53aW5kb3cucGFyZW50LnczY19zbGlkeS5vbl9mcmFtZV9sb2FkZWQoJyIrCiAgICAgIChoYXNoKSArICInKTs8L3NjcmlwdD48L2hlYWQ+PGJvZHk+aGVsbG8gbXVtPC9ib2R5PjwvaHRtbD4iKTsKICAgICAgZG9jLmNsb3NlKCk7CiAgfSwKCiAgLy8gZmluZCBjdXJyZW50IHNsaWRlIGJhc2VkIHVwb24gbG9jYXRpb24KICAvLyBmaXJzdCBmaW5kIHRhcmdldCBhbmNob3IgYW5kIHRoZW4gbG9vawogIC8vIGZvciBhc3NvY2lhdGVkIGRpdiBlbGVtZW50IGVuY2xvc2luZyBpdAogIC8vIGZpbmFsbHkgbWFwIHRoYXQgdG8gc2xpZGUgbnVtYmVyCiAgZmluZF9zbGlkZV9udW1iZXI6IGZ1bmN0aW9uICh1cmkpIHsKICAgIC8vIGZpcnN0IGdldCBhbmNob3IgZnJvbSBwYWdlIGxvY2F0aW9uCgogICAgdmFyIGkgPSB1cmkuaW5kZXhPZigiIyIpOwoKICAgIC8vIGNoZWNrIGlmIGFuY2hvciBpcyBlbnRpcmUgcGFnZQogICAgaWYgKGkgPCAwKQogICAgICByZXR1cm4gMDsgIC8vIHllcwoKICAgIHZhciBhbmNob3IgPSB1bmVzY2FwZSh1cmkuc3Vic3RyKGkrMSkpOwoKICAgIC8vIG5vdyB1c2UgYW5jaG9yIGFzIFhNTCBJRCB0byBmaW5kIHRhcmdldAogICAgdmFyIHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFuY2hvcik7CgogICAgaWYgKCF0YXJnZXQpCiAgICB7CiAgICAgIC8vIGRvZXMgYW5jaG9yIGxvb2sgbGlrZSAiKDIpIiBmb3Igc2xpZGUgMiA/PwogICAgICAvLyB3aGVyZSBmaXJzdCBzbGlkZSBpcyAoMSkKICAgICAgdmFyIHJlID0gL1woKFxkKStcKS87CgogICAgICBpZiAoYW5jaG9yLm1hdGNoKHJlKSkKICAgICAgewogICAgICAgIHZhciBudW0gPSBwYXJzZUludChhbmNob3Iuc3Vic3RyaW5nKDEsIGFuY2hvci5sZW5ndGgtMSkpOwoKICAgICAgICBpZiAobnVtID4gdGhpcy5zbGlkZXMubGVuZ3RoKQogICAgICAgICAgbnVtID0gMTsKCiAgICAgICAgaWYgKC0tbnVtIDwgMCkKICAgICAgICAgIG51bSA9IDA7CgogICAgICAgIHJldHVybiBudW07CiAgICAgIH0KCiAgICAgIC8vIGFjY2VwdCBbMl0gZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5CiAgICAgIHJlID0gL1xbKFxkKStcXS87CgogICAgICBpZiAoYW5jaG9yLm1hdGNoKHJlKSkKICAgICAgewogICAgICAgICB2YXIgbnVtID0gcGFyc2VJbnQoYW5jaG9yLnN1YnN0cmluZygxLCBhbmNob3IubGVuZ3RoLTEpKTsKCiAgICAgICAgIGlmIChudW0gPiB0aGlzLnNsaWRlcy5sZW5ndGgpCiAgICAgICAgICAgIG51bSA9IDE7CgogICAgICAgICBpZiAoLS1udW0gPCAwKQogICAgICAgICAgICBudW0gPSAwOwoKICAgICAgICAgcmV0dXJuIG51bTsKICAgICAgfQoKICAgICAgLy8gb2ggZGVhciB1bmtub3duIGFuY2hvcgogICAgICByZXR1cm4gMDsKICAgIH0KCiAgICAvLyBzZWFyY2ggZm9yIGVuY2xvc2luZyBzbGlkZQoKICAgIHdoaWxlICh0cnVlKQogICAgewogICAgICAvLyBicm93c2VyIGNvZXJjZXMgaHRtbCBlbGVtZW50cyB0byB1cHBlcmNhc2UhCiAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PSAiZGl2IiAmJgogICAgICAgICAgICB0aGlzLmhhc19jbGFzcyh0YXJnZXQsICJzbGlkZSIpKQogICAgICB7CiAgICAgICAgLy8gZm91bmQgdGhlIHNsaWRlIGVsZW1lbnQKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgLy8gb3RoZXJ3aXNlIHRyeSBwYXJlbnQgZWxlbWVudCBpZiBhbnkKCiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwoKICAgICAgaWYgKCF0YXJnZXQpCiAgICAgIHsKICAgICAgICByZXR1cm4gMDsgICAvLyBubyBsdWNrIQogICAgICB9CiAgICB9OwoKICAgIGZvciAoaSA9IDA7IGkgPCBzbGlkZXMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIGlmIChzbGlkZXNbaV0gPT0gdGFyZ2V0KQogICAgICAgIHJldHVybiBpOyAgLy8gc3VjY2VzcwogICAgfQoKICAgIC8vIG9oIGRlYXIgc3RpbGwgbm8gbHVjawogICAgcmV0dXJuIDA7CiAgfSwKCiAgcHJldmlvdXNfc2xpZGU6IGZ1bmN0aW9uIChpbmNyZW1lbnRhbCkgewogICAgaWYgKCF3M2Nfc2xpZHkudmlld19hbGwpCiAgICB7CiAgICAgIHZhciBzbGlkZTsKCiAgICAgIGlmICgoaW5jcmVtZW50YWwgfHwgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9PSAwKSAmJiB3M2Nfc2xpZHkubGFzdF9zaG93biAhPSBudWxsKQogICAgICB7CiAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSB3M2Nfc2xpZHkuaGlkZV9wcmV2aW91c19pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKTsKICAgICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXMoZmFsc2UpOwogICAgICB9CiAgICAgIGVsc2UgaWYgKHczY19zbGlkeS5zbGlkZV9udW1iZXIgPiAwKQogICAgICB7CiAgICAgICAgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgIHczY19zbGlkeS5oaWRlX3NsaWRlKHNsaWRlKTsKCiAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IHczY19zbGlkeS5zbGlkZV9udW1iZXIgLSAxOwogICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICB3M2Nfc2xpZHkuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJ2aXNpYmxlIik7CiAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSB3M2Nfc2xpZHkucHJldmlvdXNfaW5jcmVtZW50YWxfaXRlbShudWxsKTsKICAgICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXModHJ1ZSk7CiAgICAgICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgICB9CgogICAgICB3M2Nfc2xpZHkuc2V0X2xvY2F0aW9uKCk7CgogICAgICBpZiAoIXczY19zbGlkeS5uc19wb3MpCiAgICAgICAgdzNjX3NsaWR5LnJlZnJlc2hfdG9vbGJhcigyMDApOwogICAgfQogIH0sCgogIG5leHRfc2xpZGU6IGZ1bmN0aW9uIChpbmNyZW1lbnRhbCkgewogICAgaWYgKCF3M2Nfc2xpZHkudmlld19hbGwpCiAgICB7CiAgICAgIHZhciBzbGlkZSwgbGFzdCA9IHczY19zbGlkeS5sYXN0X3Nob3duOwoKICAgICAgaWYgKGluY3JlbWVudGFsIHx8IHczY19zbGlkeS5zbGlkZV9udW1iZXIgPT0gdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxKQogICAgICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IHczY19zbGlkeS5yZXZlYWxfbmV4dF9pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKTsKCiAgICAgIGlmICgoIWluY3JlbWVudGFsIHx8IHczY19zbGlkeS5sYXN0X3Nob3duID09IG51bGwpICYmCiAgICAgICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyIDwgdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxKQogICAgICB7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwoKICAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IHczY19zbGlkeS5zbGlkZV9udW1iZXIgKyAxOwogICAgICAgICBzbGlkZSA9IHczY19zbGlkeS5zbGlkZXNbdzNjX3NsaWR5LnNsaWRlX251bWJlcl07CiAgICAgICAgIHczY19zbGlkeS5sYXN0X3Nob3duID0gbnVsbDsKICAgICAgICAgdzNjX3NsaWR5LnNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbCgiaGlkZGVuIik7CiAgICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgfQogICAgICBlbHNlIGlmICghdzNjX3NsaWR5Lmxhc3Rfc2hvd24pCiAgICAgIHsKICAgICAgICAgaWYgKGxhc3QgJiYgaW5jcmVtZW50YWwpCiAgICAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSBsYXN0OwogICAgICB9CgogICAgICB3M2Nfc2xpZHkuc2V0X2xvY2F0aW9uKCk7CgogICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXMoIXczY19zbGlkeS5uZXh0X2luY3JlbWVudGFsX2l0ZW0odzNjX3NsaWR5Lmxhc3Rfc2hvd24pKTsKCiAgICAgIGlmICghdzNjX3NsaWR5Lm5zX3BvcykKICAgICAgICAgdzNjX3NsaWR5LnJlZnJlc2hfdG9vbGJhcigyMDApOwogICAgIH0KICB9LAoKICAvLyB0byBmaXJzdCBzbGlkZSB3aXRoIG5vdGhpbmcgcmV2ZWFsZWQKICAvLyBpLmUuIHN0YXRlIGF0IHN0YXJ0IG9mIHByZXNlbnRhdGlvbgogIGZpcnN0X3NsaWRlOiBmdW5jdGlvbiAoKSB7CiAgICAgaWYgKCF3M2Nfc2xpZHkudmlld19hbGwpCiAgICAgewogICAgICAgdmFyIHNsaWRlOwoKICAgICAgIGlmICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyICE9IDApCiAgICAgICB7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwoKICAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IDA7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSBudWxsOwogICAgICAgICB3M2Nfc2xpZHkuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJoaWRkZW4iKTsKICAgICAgICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgICAgfQoKICAgICAgIHczY19zbGlkeS5zZXRfZW9zX3N0YXR1cygKICAgICAgICAgIXczY19zbGlkeS5uZXh0X2luY3JlbWVudGFsX2l0ZW0odzNjX3NsaWR5Lmxhc3Rfc2hvd24pKTsKICAgICAgIHczY19zbGlkeS5zZXRfbG9jYXRpb24oKTsKICAgICB9CiAgfSwKCiAgLy8gZ290byBsYXN0IHNsaWRlIHdpdGggZXZlcnl0aGluZyByZXZlYWxlZAogIC8vIGkuZS4gc3RhdGUgYXQgZW5kIG9mIHByZXNlbnRhdGlvbgogIGxhc3Rfc2xpZGU6IGZ1bmN0aW9uICgpIHsKICAgIGlmICghdzNjX3NsaWR5LnZpZXdfYWxsKQogICAgewogICAgICB2YXIgc2xpZGU7CgogICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IG51bGw7IC8vcmV2ZWFsTmV4dEl0ZW0obGFzdFNob3duKTsKCiAgICAgIGlmICh3M2Nfc2xpZHkubGFzdF9zaG93biA9PSBudWxsICYmCiAgICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyIDwgdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxKQogICAgICB7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID0gdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxOwogICAgICAgICBzbGlkZSA9IHczY19zbGlkeS5zbGlkZXNbdzNjX3NsaWR5LnNsaWRlX251bWJlcl07CiAgICAgICAgIHczY19zbGlkeS5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoInZpc2libGUiKTsKICAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSB3M2Nfc2xpZHkucHJldmlvdXNfaW5jcmVtZW50YWxfaXRlbShudWxsKTsKCiAgICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICAgdzNjX3NsaWR5LnNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbCgidmlzaWJsZSIpOwogICAgICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IHczY19zbGlkeS5wcmV2aW91c19pbmNyZW1lbnRhbF9pdGVtKG51bGwpOwogICAgICB9CgogICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXModHJ1ZSk7CiAgICAgIHczY19zbGlkeS5zZXRfbG9jYXRpb24oKTsKICAgIH0KICB9LAoKCiAgLy8gIyMjIGNoZWNrIHRoaXMgYW5kIGNvbnNpZGVyIGFkZC9yZW1vdmUgY2xhc3MKICBzZXRfZW9zX3N0YXR1czogZnVuY3Rpb24gKHN0YXRlKSB7CiAgICBpZiAodGhpcy5lb3MpCiAgICAgIHRoaXMuZW9zLnN0eWxlLmNvbG9yID0gKHN0YXRlID8gInJnYigyNDAsMjQwLDI0MCkiIDogInJlZCIpOwogIH0sCgogIC8vIGZpcnN0IHNsaWRlIGlzIDAKICBnb3RvX3NsaWRlOiBmdW5jdGlvbiAobnVtKSB7CiAgICAvL2FsZXJ0KCJnb2luZyB0byBzbGlkZSAiICsgKG51bSsxKSk7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IG51bTsKICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgIHczY19zbGlkeS5sYXN0X3Nob3duID0gbnVsbDsKICAgIHczY19zbGlkeS5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoImhpZGRlbiIpOwogICAgdzNjX3NsaWR5LnNldF9lb3Nfc3RhdHVzKCF3M2Nfc2xpZHkubmV4dF9pbmNyZW1lbnRhbF9pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKSk7CiAgICBkb2N1bWVudC50aXRsZSA9IHczY19zbGlkeS50aXRsZSArICIgKCIgKyAodzNjX3NsaWR5LnNsaWRlX251bWJlcisxKSArICIpIjsKICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgIHczY19zbGlkeS5zaG93X3NsaWRlX251bWJlcigpOwogIH0sCgoKICBzaG93X3NsaWRlOiBmdW5jdGlvbiAoc2xpZGUpIHsKICAgIHRoaXMuc3luY19iYWNrZ3JvdW5kKHNsaWRlKTsKICAgIHRoaXMucmVtb3ZlX2NsYXNzKHNsaWRlLCAiaGlkZGVuIik7CgogICAgLy8gd29yayBhcm91bmQgSUU5IG9iamVjdCByZW5kZXJpbmcgYnVnCiAgICBzZXRUaW1lb3V0KCJ3aW5kb3cuc2Nyb2xsVG8oMCwwKTsiLCAxKTsKICB9LAoKICBoaWRlX3NsaWRlOiBmdW5jdGlvbiAoc2xpZGUpIHsKICAgIHRoaXMuYWRkX2NsYXNzKHNsaWRlLCAiaGlkZGVuIik7CiAgfSwKCiAgc2V0X2ZvY3VzOiBmdW5jdGlvbiAoZWxlbWVudCkKICB7CiAgICBpZiAoZWxlbWVudCkKICAgICAgZWxlbWVudC5mb2N1cygpOwogICAgZWxzZQogICAgewogICAgICB3M2Nfc2xpZHkuaGVscF9hbmNob3IuZm9jdXMoKTsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgdzNjX3NsaWR5LmhlbHBfYW5jaG9yLmJsdXIoKTsKICAgICAgfSwgMSk7CiAgICB9CiAgfSwKCiAgLy8gc2hvdyBqdXN0IHRoZSBiYWNrZ3JvdW5kcyBwZXJ0aW5lbnQgdG8gdGhpcyBzbGlkZQogIC8vIHdoZW4gc2xpZGUgYmFja2dyb3VuZC1jb2xvciBpcyB0cmFuc3BhcmVudAogIC8vIHRoaXMgc2hvdWxkIG5vdyB3b3JrIHdpdGggcmdiYSBjb2xvciB2YWx1ZXMKICBzeW5jX2JhY2tncm91bmQ6IGZ1bmN0aW9uIChzbGlkZSkgewogICAgdmFyIGJhY2tncm91bmQ7CiAgICB2YXIgYmdDb2xvcjsKCiAgICBpZiAoc2xpZGUuY3VycmVudFN0eWxlKQogICAgICBiZ0NvbG9yID0gc2xpZGUuY3VycmVudFN0eWxlWyJiYWNrZ3JvdW5kQ29sb3IiXTsKICAgIGVsc2UgaWYgKGRvY3VtZW50LmRlZmF1bHRWaWV3KQogICAgewogICAgICB2YXIgc3R5bGVzID0gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShzbGlkZSxudWxsKTsKCiAgICAgIGlmIChzdHlsZXMpCiAgICAgICAgYmdDb2xvciA9IHN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKCJiYWNrZ3JvdW5kLWNvbG9yIik7CiAgICAgIGVsc2UgLy8gYnJva2VuIGltcGxlbWVudGF0aW9uIHByb2JhYmx5IGR1ZSBTYWZhcmkgb3IgS29ucXVlcm9yCiAgICAgIHsKICAgICAgICAvL2FsZXJ0KCJkZWZlY3RpdmUgaW1wbGVtZW50YXRpb24gb2YgZ2V0Q29tcHV0ZWRTdHlsZSgpIik7CiAgICAgICAgYmdDb2xvciA9ICJ0cmFuc3BhcmVudCI7CiAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgICAgYmdDb2xvciA9PSAidHJhbnNwYXJlbnQiOwoKICAgIGlmIChiZ0NvbG9yID09ICJ0cmFuc3BhcmVudCIgfHwKICAgICAgICBiZ0NvbG9yLmluZGV4T2YoInJnYmEiKSA+PSAwIHx8CiAgICAgICAgYmdDb2xvci5pbmRleE9mKCJvcGFjaXR5IikgPj0gMCkKICAgIHsKICAgICAgdmFyIHNsaWRlQ2xhc3MgPSB0aGlzLmdldF9jbGFzc19saXN0KHNsaWRlKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5iYWNrZ3JvdW5kcy5sZW5ndGg7IGkrKykKICAgICAgewogICAgICAgIGJhY2tncm91bmQgPSB0aGlzLmJhY2tncm91bmRzW2ldOwoKICAgICAgICB2YXIgYmdDbGFzcyA9IHRoaXMuZ2V0X2NsYXNzX2xpc3QoYmFja2dyb3VuZCk7CgogICAgICAgIGlmICh0aGlzLm1hdGNoaW5nX2JhY2tncm91bmQoc2xpZGVDbGFzcywgYmdDbGFzcykpCiAgICAgICAgICB0aGlzLnJlbW92ZV9jbGFzcyhiYWNrZ3JvdW5kLCAiaGlkZGVuIik7CiAgICAgICAgZWxzZQogICAgICAgICAgdGhpcy5hZGRfY2xhc3MoYmFja2dyb3VuZCwgImhpZGRlbiIpOwogICAgICB9CiAgICB9CiAgICBlbHNlIC8vIGZvcmNpYmx5IGhpZGUgYWxsIGJhY2tncm91bmRzCiAgICAgIHRoaXMuaGlkZV9iYWNrZ3JvdW5kcygpOwogIH0sCgogIGhpZGVfYmFja2dyb3VuZHM6IGZ1bmN0aW9uICgpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5iYWNrZ3JvdW5kcy5sZW5ndGg7IGkrKykKICAgIHsKICAgICAgYmFja2dyb3VuZCA9IHRoaXMuYmFja2dyb3VuZHNbaV07CiAgICAgIHRoaXMuYWRkX2NsYXNzKGJhY2tncm91bmQsICJoaWRkZW4iKTsKICAgIH0KICB9LAoKICAvLyBjb21wYXJlIGNsYXNzZXMgZm9yIHNsaWRlIGFuZCBiYWNrZ3JvdW5kCiAgbWF0Y2hpbmdfYmFja2dyb3VuZDogZnVuY3Rpb24gKHNsaWRlQ2xhc3MsIGJnQ2xhc3MpIHsKICAgIHZhciBpLCBjb3VudCwgcGF0dGVybiwgcmVzdWx0OwoKICAgIC8vIGRlZmluZSBwYXR0ZXJuIGFzIHJlZ3VsYXIgZXhwcmVzc2lvbgogICAgcGF0dGVybiA9IC9cdysvZzsKCiAgICAvLyBjaGVjayBiYWNrZ3JvdW5kIGNsYXNzIG5hbWVzCiAgICByZXN1bHQgPSBiZ0NsYXNzLm1hdGNoKHBhdHRlcm4pOwoKICAgIGZvciAoaSA9IGNvdW50ID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykKICAgIHsKICAgICAgaWYgKHJlc3VsdFtpXSA9PSAiaGlkZGVuIikKICAgICAgICBjb250aW51ZTsKCiAgICAgIGlmIChyZXN1bHRbaV0gPT0gImJhY2tncm91bmQiKQoJY29udGludWU7CgogICAgICArK2NvdW50OwogICAgfQoKICAgIGlmIChjb3VudCA9PSAwKSAgLy8gZGVmYXVsdCBtYXRjaAogICAgICByZXR1cm4gdHJ1ZTsKCiAgICAvLyBjaGVjayBmb3IgbWF0Y2hlcyBhbmQgcGxhY2UgcmVzdWx0IGluIGFycmF5CiAgICByZXN1bHQgPSBzbGlkZUNsYXNzLm1hdGNoKHBhdHRlcm4pOwoKICAgIC8vIG5vdyBjaGVjayBpZiBkZXNpcmVkIG5hbWUgaXMgcHJlc2VudCBmb3IgYmFja2dyb3VuZAogICAgZm9yIChpID0gY291bnQgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKQogICAgewogICAgICBpZiAocmVzdWx0W2ldID09ICJoaWRkZW4iKQogICAgICAgIGNvbnRpbnVlOwoKICAgICAgaWYgKHRoaXMuaGFzX3Rva2VuKGJnQ2xhc3MsIHJlc3VsdFtpXSkpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIHJlc2l6ZWQ6IGZ1bmN0aW9uICgpIHsKICAgICB2YXIgd2lkdGggPSAwOwoKICAgICBpZiAoIHR5cGVvZiggd2luZG93LmlubmVyV2lkdGggKSA9PSAnbnVtYmVyJyApCiAgICAgICB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOyAgLy8gTm9uIElFIGJyb3dzZXIKICAgICBlbHNlIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKQogICAgICAgd2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7ICAvLyBJRTYKICAgICBlbHNlIGlmIChkb2N1bWVudC5ib2R5ICYmIGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGgpCiAgICAgICB3aWR0aCA9IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7IC8vIElFNAoKICAgICB2YXIgaGVpZ2h0ID0gMDsKCiAgICAgaWYgKCB0eXBlb2YoIHdpbmRvdy5pbm5lckhlaWdodCApID09ICdudW1iZXInICkKICAgICAgIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDsgIC8vIE5vbiBJRSBicm93c2VyCiAgICAgZWxzZSBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpCiAgICAgICBoZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OyAgLy8gSUU2CiAgICAgZWxzZSBpZiAoZG9jdW1lbnQuYm9keSAmJiBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCkKICAgICAgIGhlaWdodCA9IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0OyAvLyBJRTQKCiAgICAgaWYgKGhlaWdodCAmJiAod2lkdGgvaGVpZ2h0ID4gMS4wNSoxMDI0Lzc2OCkpCiAgICAgewogICAgICAgd2lkdGggPSBoZWlnaHQgKiAxMDI0LjAvNzY4OwogICAgIH0KCiAgICAgLy8gSUUgZmlyZXMgb25yZXNpemUgZXZlbiB3aGVuIG9ubHkgZm9udCBzaXplIGlzIGNoYW5nZWQhCiAgICAgLy8gc28gd2UgZG8gYSBjaGVjayB0byBhdm9pZCBibG9ja2luZyA8IGFuZCA+IGFjdGlvbnMKICAgICBpZiAod2lkdGggIT0gdzNjX3NsaWR5Lmxhc3Rfd2lkdGggfHwgaGVpZ2h0ICE9IHczY19zbGlkeS5sYXN0X2hlaWdodCkKICAgICB7CiAgICAgICBpZiAod2lkdGggPj0gMTEwMCkKICAgICAgICAgdzNjX3NsaWR5LnNpemVfaW5kZXggPSA1OyAgICAvLyA0CiAgICAgICBlbHNlIGlmICh3aWR0aCA+PSAxMDAwKQogICAgICAgICB3M2Nfc2xpZHkuc2l6ZV9pbmRleCA9IDQ7ICAgIC8vIDMKICAgICAgIGVsc2UgaWYgKHdpZHRoID49IDgwMCkKICAgICAgICAgdzNjX3NsaWR5LnNpemVfaW5kZXggPSAzOyAgICAvLyAyCiAgICAgICBlbHNlIGlmICh3aWR0aCA+PSA2MDApCiAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ID0gMjsgICAgLy8gMQogICAgICAgZWxzZSBpZiAod2lkdGgpCiAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ID0gMDsKCiAgICAgICAvLyBhZGQgaW4gZm9udCBzaXplIGFkanVzdG1lbnQgZnJvbSBtZXRhIGVsZW1lbnQgZS5nLgogICAgICAgLy8gPG1ldGEgbmFtZT0iZm9udC1zaXplLWFkanVzdG1lbnQiIGNvbnRlbnQ9Ii0yIiAvPgogICAgICAgLy8gdXNlZnVsIHdoZW4gc2xpZGVzIGhhdmUgdG9vIG11Y2ggY29udGVudCA7LSkKCiAgICAgICBpZiAoMCA8PSB3M2Nfc2xpZHkuc2l6ZV9pbmRleCArIHczY19zbGlkeS5zaXplX2FkanVzdG1lbnQgJiYKICAgICAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ICsgdzNjX3NsaWR5LnNpemVfYWRqdXN0bWVudCA8IHczY19zbGlkeS5zaXplcy5sZW5ndGgpCiAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ID0gdzNjX3NsaWR5LnNpemVfaW5kZXggKyB3M2Nfc2xpZHkuc2l6ZV9hZGp1c3RtZW50OwoKICAgICAgIC8vIGVuYWJsZXMgY3Jvc3MgYnJvd3NlciB1c2Ugb2YgcmVsYXRpdmUgd2lkdGgvaGVpZ2h0CiAgICAgICAvLyBvbiBvYmplY3QgZWxlbWVudHMgZm9yIHVzZSB3aXRoIFNWRyBhbmQgRmxhc2ggbWVkaWEKICAgICAgIHczY19zbGlkeS5hZGp1c3Rfb2JqZWN0X2RpbWVuc2lvbnMod2lkdGgsIGhlaWdodCk7CgogICAgICAgaWYgKGRvY3VtZW50LmJvZHkuc3R5bGUuZm9udFNpemUgIT0gdzNjX3NsaWR5LnNpemVzW3czY19zbGlkeS5zaXplX2luZGV4XSkKICAgICAgIHsKICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5mb250U2l6ZSA9IHczY19zbGlkeS5zaXplc1t3M2Nfc2xpZHkuc2l6ZV9pbmRleF07CiAgICAgICB9CgogICAgICAgdzNjX3NsaWR5Lmxhc3Rfd2lkdGggPSB3aWR0aDsKICAgICAgIHczY19zbGlkeS5sYXN0X2hlaWdodCA9IGhlaWdodDsKCiAgICAgICAvLyBmb3JjZSByZWZsb3cgdG8gd29yayBhcm91bmQgTW96aWxsYSBidWcKICAgICAgIGlmICh3M2Nfc2xpZHkubnNfcG9zKQogICAgICAgewogICAgICAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgICB3M2Nfc2xpZHkuaGlkZV9zbGlkZShzbGlkZSk7CiAgICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgIH0KCiAgICAgICAvLyBmb3JjZSBjb3JyZWN0IHBvc2l0aW9uaW5nIG9mIHRvb2xiYXIKICAgICAgIHczY19zbGlkeS5yZWZyZXNoX3Rvb2xiYXIoMjAwKTsKICAgICB9CiAgfSwKCiAgc2Nyb2xsZWQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3M2Nfc2xpZHkudG9vbGJhciAmJiAhdzNjX3NsaWR5Lm5zX3BvcyAmJiAhdzNjX3NsaWR5LmllNykKICAgIHsKICAgICAgdzNjX3NsaWR5LmhhY2tfb2Zmc2V0ID0gdzNjX3NsaWR5LnNjcm9sbF94X29mZnNldCgpOwogICAgICAvLyBoaWRlIHRvb2xiYXIKICAgICAgdzNjX3NsaWR5LnRvb2xiYXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCiAgICAgIC8vIG1ha2UgaXQgcmVhcHBlYXIgbGF0ZXIKICAgICAgaWYgKHczY19zbGlkeS5zY3JvbGxoYWNrID09IDAgJiYgIXczY19zbGlkeS52aWV3X2FsbCkKICAgICAgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge3czY19zbGlkeS5zaG93X3Rvb2xiYXIoKTsgfSwgMTAwMCk7CiAgICAgICAgdzNjX3NsaWR5LnNjcm9sbGhhY2sgPSAxOwogICAgICB9CiAgICB9CiAgfSwKCiAgaGlkZV90b29sYmFyOiBmdW5jdGlvbiAoKSB7CiAgICB3M2Nfc2xpZHkuYWRkX2NsYXNzKHczY19zbGlkeS50b29sYmFyLCAiaGlkZGVuIik7CiAgICB3aW5kb3cuZm9jdXMoKTsKICB9LAoKICAvLyB1c2VkIHRvIGVuc3VyZSBJRSByZWZyZXNoZXMgdG9vbGJhciBpbiBjb3JyZWN0IHBvc2l0aW9uCiAgcmVmcmVzaF90b29sYmFyOiBmdW5jdGlvbiAoaW50ZXJ2YWwpIHsKICAgIGlmICghdzNjX3NsaWR5Lm5zX3BvcyAmJiAhdzNjX3NsaWR5LmllNykKICAgIHsKICAgICAgdzNjX3NsaWR5LmhpZGVfdG9vbGJhcigpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHt3M2Nfc2xpZHkuc2hvd190b29sYmFyKCk7fSwgaW50ZXJ2YWwpOwogICAgfQogIH0sCgogIC8vIHJlc3RvcmVzIHRvb2xiYXIgYWZ0ZXIgc2hvcnQgZGVsYXkKICBzaG93X3Rvb2xiYXI6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3M2Nfc2xpZHkud2FudF90b29sYmFyKQogICAgewogICAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCiAgICAgIGlmICghdzNjX3NsaWR5Lm5zX3BvcykKICAgICAgewogICAgICAgIC8vIGFkanVzdCBwb3NpdGlvbiB0byBhbGxvdyBmb3Igc2Nyb2xsaW5nCiAgICAgICAgdmFyIHhvZmZzZXQgPSB3M2Nfc2xpZHkuc2Nyb2xsX3hfb2Zmc2V0KCk7CiAgICAgICAgdzNjX3NsaWR5LnRvb2xiYXIuc3R5bGUubGVmdCA9IHhvZmZzZXQ7CiAgICAgICAgdzNjX3NsaWR5LnRvb2xiYXIuc3R5bGUucmlnaHQgPSB4b2Zmc2V0OwoKICAgICAgICAvLyBkZXRlcm1pbmUgdmVydGljYWwgc2Nyb2xsIG9mZnNldAogICAgICAgIC8vdmFyIHlvZmZzZXQgPSBzY3JvbGxZT2Zmc2V0KCk7CgogICAgICAgIC8vIGJvdHRvbSBpcyBkb2MgaGVpZ2h0IC0gd2luZG93IGhlaWdodCAtIHNjcm9sbCBvZmZzZXQKICAgICAgICAvL3ZhciBib3R0b20gPSBkb2N1bWVudEhlaWdodCgpIC0gbGFzdEhlaWdodCAtIHlvZmZzZXQKCiAgICAgICAgLy9pZiAoeW9mZnNldCA+IDAgfHwgZG9jdW1lbnRIZWlnaHQoKSA+IGxhc3RIZWlnaHQpCiAgICAgICAgLy8gICBib3R0b20gKz0gMTY7ICAvLyBhbGxvdyBmb3IgaGVpZ2h0IG9mIHNjcm9sbGJhcgoKICAgICAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5ib3R0b20gPSAwOyAvL2JvdHRvbTsKICAgICAgfQoKICAgICAgdzNjX3NsaWR5LnJlbW92ZV9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpOwogICAgfQoKICAgIHczY19zbGlkeS5zY3JvbGxoYWNrID0gMDsKCgogICAgLy8gc2V0IHRoZSBrZXlib2FyZCBmb2N1cyB0byB0aGUgaGVscCBsaW5rIG9uIHRoZQogICAgLy8gdG9vbGJhciB0byBlbnN1cmUgdGhhdCBkb2N1bWVudCBoYXMgdGhlIGZvY3VzCiAgICAvLyBJRSBkb2Vzbid0IGFsd2F5cyB3b3JrIHdpdGggd2luZG93LmZvY3VzKCkKICAgIC8vIGFuZCB0aGlzIGhhY2sgaGFzIGJlbmVmaXQgb2YgRW50ZXIgZm9yIGhlbHAKCiAgICB0cnkKICAgIHsKICAgICAgaWYgKCF3M2Nfc2xpZHkub3BlcmEpCiAgICAgICAgdzNjX3NsaWR5LnNldF9mb2N1cygpOwogICAgfQogICAgY2F0Y2ggKGUpCiAgICB7CiAgICB9CiAgfSwKCi8vIGludm9rZWQgdmlhIEYga2V5CiAgdG9nZ2xlX3Rvb2xiYXI6IGZ1bmN0aW9uICgpIHsKICAgIGlmICghdzNjX3NsaWR5LnZpZXdfYWxsKQogICAgewogICAgICBpZiAodzNjX3NsaWR5Lmhhc19jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpKQogICAgICB7CiAgICAgICAgdzNjX3NsaWR5LnJlbW92ZV9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpCiAgICAgICAgdzNjX3NsaWR5LndhbnRfdG9vbGJhciA9IDE7CiAgICAgIH0KICAgICAgZWxzZQogICAgICB7CiAgICAgICAgdzNjX3NsaWR5LmFkZF9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpCiAgICAgICAgdzNjX3NsaWR5LndhbnRfdG9vbGJhciA9IDA7CiAgICAgIH0KICAgIH0KICB9LAoKICBzY3JvbGxfeF9vZmZzZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3aW5kb3cucGFnZVhPZmZzZXQpCiAgICAgIHJldHVybiBzZWxmLnBhZ2VYT2Zmc2V0OwoKICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgCiAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCkKICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0OwoKICAgIGlmIChkb2N1bWVudC5ib2R5KQogICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwoKICAgIHJldHVybiAwOwogIH0sCgogIHNjcm9sbF95X29mZnNldDogZnVuY3Rpb24gKCkgewogICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCkKICAgICAgcmV0dXJuIHNlbGYucGFnZVlPZmZzZXQ7CgogICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiAKICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApCiAgICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wOwoKICAgIGlmIChkb2N1bWVudC5ib2R5KQogICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CgogICAgcmV0dXJuIDA7CiAgfSwKCiAgLy8gbG9va2luZyBmb3IgYSB3YXkgdG8gZGV0ZXJtaW5lIGhlaWdodCBvZiBzbGlkZSBjb250ZW50CiAgLy8gdGhlIHNsaWRlIGl0c2VsZiBpcyBzZXQgdG8gdGhlIGhlaWdodCBvZiB0aGUgd2luZG93CiAgb3B0aW1pemVfZm9udF9zaXplOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwoKICAgIC8vdmFyIGRoID0gZG9jdW1lbnRIZWlnaHQoKTsgLy9nZXREb2NIZWlnaHQoZG9jdW1lbnQpOwogICAgdmFyIGRoID0gc2xpZGUuc2Nyb2xsSGVpZ2h0OwogICAgdmFyIHdoID0gZ2V0V2luZG93SGVpZ2h0KCk7CiAgICB2YXIgdSA9IDEwMCAqIGRoIC8gd2g7CgogICAgYWxlcnQoIndpbmRvdyB1dGlsaXphdGlvbiA9ICIgKyB1ICsgIiUgKGRvYyAiCiAgICAgICsgZGggKyAiIHdpbiAiICsgd2ggKyAiKSIpOwogIH0sCgogIC8vIGZyb20gZG9jdW1lbnQgb2JqZWN0CiAgZ2V0X2RvY19oZWlnaHQ6IGZ1bmN0aW9uIChkb2MpIHsKICAgIGlmICghZG9jKQogICAgICBkb2MgPSBkb2N1bWVudDsKCiAgICBpZiAoZG9jICYmIGRvYy5ib2R5ICYmIGRvYy5ib2R5Lm9mZnNldEhlaWdodCkKICAgICAgcmV0dXJuIGRvYy5ib2R5Lm9mZnNldEhlaWdodDsgIC8vIG5zL2dlY2tvIHN5bnRheAoKICAgIGlmIChkb2MgJiYgZG9jLmJvZHkgJiYgZG9jLmJvZHkuc2Nyb2xsSGVpZ2h0KQogICAgICByZXR1cm4gZG9jLmJvZHkuc2Nyb2xsSGVpZ2h0OwoKICAgIGFsZXJ0KCJjb3VsZG4ndCBkZXRlcm1pbmUgZG9jdW1lbnQgaGVpZ2h0Iik7CiAgfSwKCiAgZ2V0X3dpbmRvd19oZWlnaHQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICggdHlwZW9mKCB3aW5kb3cuaW5uZXJIZWlnaHQgKSA9PSAnbnVtYmVyJyApCiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQ7ICAvLyBOb24gSUUgYnJvd3NlcgoKICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkKICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7ICAvLyBJRTYKCiAgICBpZiAoZG9jdW1lbnQuYm9keSAmJiBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCkKICAgICAgcmV0dXJuIGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0OyAvLyBJRTQKICB9LAoKICBkb2N1bWVudF9oZWlnaHQ6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzaCwgb2g7CgogICAgc2ggPSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodDsKICAgIG9oID0gZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQ7CgogICAgaWYgKHNoICYmIG9oKQogICAgewogICAgICByZXR1cm4gKHNoID4gb2ggPyBzaCA6IG9oKTsKICAgIH0KCiAgICAvLyBubyBpZGVhIQogICAgcmV0dXJuIDA7CiAgfSwKCiAgc21hbGxlcjogZnVuY3Rpb24gKCkgewogICAgaWYgKHczY19zbGlkeS5zaXplX2luZGV4ID4gMCkKICAgIHsKICAgICAgLS13M2Nfc2xpZHkuc2l6ZV9pbmRleDsKICAgIH0KCiAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgZG9jdW1lbnQuYm9keS5zdHlsZS5mb250U2l6ZSA9IHczY19zbGlkeS5zaXplc1t3M2Nfc2xpZHkuc2l6ZV9pbmRleF07CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7dzNjX3NsaWR5LnNob3dfdG9vbGJhcigpOyB9LCA1MCk7CiAgfSwKCiAgYmlnZ2VyOiBmdW5jdGlvbiAoKSB7CiAgICBpZiAodzNjX3NsaWR5LnNpemVfaW5kZXggPCB3M2Nfc2xpZHkuc2l6ZXMubGVuZ3RoIC0gMSkKICAgIHsKICAgICAgKyt3M2Nfc2xpZHkuc2l6ZV9pbmRleDsKICAgIH0KCiAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgZG9jdW1lbnQuYm9keS5zdHlsZS5mb250U2l6ZSA9IHczY19zbGlkeS5zaXplc1t3M2Nfc2xpZHkuc2l6ZV9pbmRleF07CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7dzNjX3NsaWR5LnNob3dfdG9vbGJhcigpOyB9LCA1MCk7CiAgfSwKCiAgLy8gZW5hYmxlcyBjcm9zcyBicm93c2VyIHVzZSBvZiByZWxhdGl2ZSB3aWR0aC9oZWlnaHQKICAvLyBvbiBvYmplY3QgZWxlbWVudHMgZm9yIHVzZSB3aXRoIFNWRyBhbmQgRmxhc2ggbWVkaWEKICAvLyB3aXRoIHRoYW5rcyB0byBJdmFuIEhlcm1hbiBmb3IgdGhlIHN1Z2dlc3Rpb24KICBhZGp1c3Rfb2JqZWN0X2RpbWVuc2lvbnM6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7CiAgICBmb3IoIHZhciBpID0gMDsgaSA8IHczY19zbGlkeS5vYmplY3RzLmxlbmd0aDsgaSsrICkKICAgIHsKICAgICAgdmFyIG9iaiA9IHRoaXMub2JqZWN0c1tpXTsKICAgICAgdmFyIG1pbWVUeXBlID0gb2JqLmdldEF0dHJpYnV0ZSgidHlwZSIpOwoKICAgICAgaWYgKG1pbWVUeXBlID09ICJpbWFnZS9zdmcreG1sIiB8fCBtaW1lVHlwZSA9PSAiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giKQogICAgICB7CiAgICAgICAgaWYgKCAhb2JqLmluaXRpYWxXaWR0aCApIAogICAgICAgICAgb2JqLmluaXRpYWxXaWR0aCA9IG9iai5nZXRBdHRyaWJ1dGUoIndpZHRoIik7CgogICAgICAgIGlmICggIW9iai5pbml0aWFsSGVpZ2h0ICkgCiAgICAgICAgICBvYmouaW5pdGlhbEhlaWdodCA9IG9iai5nZXRBdHRyaWJ1dGUoImhlaWdodCIpOwoKICAgICAgICBpZiAoIG9iai5pbml0aWFsV2lkdGggJiYgb2JqLmluaXRpYWxXaWR0aC5jaGFyQXQob2JqLmluaXRpYWxXaWR0aC5sZW5ndGgtMSkgPT0gIiUiICkKICAgICAgICB7CiAgICAgICAgICB2YXIgdyA9IHBhcnNlSW50KG9iai5pbml0aWFsV2lkdGguc2xpY2UoMCwgb2JqLmluaXRpYWxXaWR0aC5sZW5ndGgtMSkpOwogICAgICAgICAgdmFyIG5ld1cgPSB3aWR0aCAqICh3LzEwMC4wKTsKICAgICAgICAgIG9iai5zZXRBdHRyaWJ1dGUoIndpZHRoIixuZXdXKTsKICAgICAgICB9CgogICAgICAgIGlmICggb2JqLmluaXRpYWxIZWlnaHQgJiYKICAgICAgICAgICAgIG9iai5pbml0aWFsSGVpZ2h0LmNoYXJBdChvYmouaW5pdGlhbEhlaWdodC5sZW5ndGgtMSkgPT0gIiUiICkKICAgICAgICB7CiAgICAgICAgICB2YXIgaCA9IHBhcnNlSW50KG9iai5pbml0aWFsSGVpZ2h0LnNsaWNlKDAsIG9iai5pbml0aWFsSGVpZ2h0Lmxlbmd0aC0xKSk7CiAgICAgICAgICB2YXIgbmV3SCA9IGhlaWdodCAqIChoLzEwMC4wKTsKICAgICAgICAgIG9iai5zZXRBdHRyaWJ1dGUoImhlaWdodCIsIG5ld0gpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCgogIC8vIG5lZWRlZCBmb3IgT3BlcmEgdG8gaW5oaWJpdCBkZWZhdWx0IGJlaGF2aW9yCiAgLy8gc2luY2UgT3BlcmEgZGVsaXZlcnMga2V5UHJlc3MgZXZlbiBpZiBrZXlEb3duCiAgLy8gd2FzIGNhbmNlbGxlZAogIGtleV9wcmVzczogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICBpZiAoIWV2ZW50KQogICAgICBldmVudCA9IHdpbmRvdy5ldmVudDsKCiAgICBpZiAoIXczY19zbGlkeS5rZXlfd2FudGVkKQogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgLy8gIFNlZSBlLmcuIGh0dHA6Ly93d3cucXVpcmtzbW9kZS5vcmcvanMvZXZlbnRzL2tleXMuaHRtbCBmb3Iga2V5Y29kZXMKICBrZXlfZG93bjogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB2YXIga2V5LCB0YXJnZXQsIHRhZzsKCiAgICB3M2Nfc2xpZHkua2V5X3dhbnRlZCA9IHRydWU7CgogICAgaWYgKCFldmVudCkKICAgICAgZXZlbnQgPSB3aW5kb3cuZXZlbnQ7CgogICAgLy8ga2x1ZGdlIGFyb3VuZCBOUy9JRSBkaWZmZXJlbmNlcyAKICAgIGlmICh3aW5kb3cuZXZlbnQpCiAgICB7CiAgICAgIGtleSA9IHdpbmRvdy5ldmVudC5rZXlDb2RlOwogICAgICB0YXJnZXQgPSB3aW5kb3cuZXZlbnQuc3JjRWxlbWVudDsKICAgIH0KICAgIGVsc2UgaWYgKGV2ZW50LndoaWNoKQogICAgewogICAgICBrZXkgPSBldmVudC53aGljaDsKICAgICAgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OwogICAgfQogICAgZWxzZQogICAgICByZXR1cm4gdHJ1ZTsgLy8gWWlrZXMhIHVua25vd24gYnJvd3NlcgoKICAgIC8vIGlnbm9yZSBldmVudCBpZiBrZXkgdmFsdWUgaXMgemVybwogICAgLy8gYXMgZm9yIGFsdCBvbiBPcGVyYSBhbmQgS29ucXVlcm9yCiAgICBpZiAoIWtleSkKICAgICAgIHJldHVybiB0cnVlOwoKICAgIC8vIGF2b2lkIGludGVyZmVyaW5nIHdpdGgga2V5c3Ryb2tlCiAgICAvLyBiZWhhdmlvciBmb3Igbm9uLXNsaWR5IGNocm9tZSBlbGVtZW50cwogICAgaWYgKCF3M2Nfc2xpZHkuc2xpZHlfY2hyb21lKHRhcmdldCkgJiYKICAgICAgICB3M2Nfc2xpZHkuc3BlY2lhbF9lbGVtZW50KHRhcmdldCkpCiAgICAgIHJldHVybiB0cnVlOwoKICAgIC8vIGNoZWNrIGZvciBjb25jdXJyZW50IGNvbnRyb2wvY29tbWFuZC9hbHQga2V5CiAgICAvLyBidXQgYXJlIHRoZXNlIG9ubHkgcHJlc2VudCBvbiBtb3VzZSBldmVudHM/CgogICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQuYWx0S2V5IHx8IGV2ZW50Lm1ldGFLZXkpCiAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAvLyBkaXNtaXNzIHRhYmxlIG9mIGNvbnRlbnRzIGlmIHZpc2libGUKICAgIGlmICh3M2Nfc2xpZHkuaXNfc2hvd25fdG9jKCkgJiYga2V5ICE9IDkgJiYga2V5ICE9IDE2ICYmIGtleSAhPSAzOCAmJiBrZXkgIT0gNDApCiAgICB7CiAgICAgIHczY19zbGlkeS5oaWRlX3RhYmxlX29mX2NvbnRlbnRzKHRydWUpOwoKICAgICAgaWYgKGtleSA9PSAyNyB8fCBrZXkgPT0gODQgfHwga2V5ID09IDY3KQogICAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KCiAgICBpZiAoa2V5ID09IDM0KSAvLyBQYWdlIERvd24KICAgIHsKICAgICAgaWYgKHczY19zbGlkeS52aWV3X2FsbCkKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgIHczY19zbGlkeS5uZXh0X3NsaWRlKGZhbHNlKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDMzKSAvLyBQYWdlIFVwCiAgICB7CiAgICAgIGlmICh3M2Nfc2xpZHkudmlld19hbGwpCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICB3M2Nfc2xpZHkucHJldmlvdXNfc2xpZGUoZmFsc2UpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMzIpIC8vIHNwYWNlIGJhcgogICAgewogICAgICB3M2Nfc2xpZHkubmV4dF9zbGlkZSh0cnVlKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDM3KSAvLyBMZWZ0IGFycm93CiAgICB7CiAgICAgIHczY19zbGlkeS5wcmV2aW91c19zbGlkZSghZXZlbnQuc2hpZnRLZXkpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMzYpIC8vIEhvbWUKICAgIHsKICAgICAgdzNjX3NsaWR5LmZpcnN0X3NsaWRlKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSAzNSkgLy8gRW5kCiAgICB7CiAgICAgIHczY19zbGlkeS5sYXN0X3NsaWRlKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSAzOSkgLy8gUmlnaHQgYXJyb3cKICAgIHsKICAgICAgdzNjX3NsaWR5Lm5leHRfc2xpZGUoIWV2ZW50LnNoaWZ0S2V5KTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDEzKSAvLyBFbnRlcgogICAgewogICAgICBpZiAodzNjX3NsaWR5Lm91dGxpbmUpCiAgICAgIHsKICAgICAgICBpZiAodzNjX3NsaWR5Lm91dGxpbmUudmlzaWJsZSkKICAgICAgICAgIHczY19zbGlkeS5mb2xkKHczY19zbGlkeS5vdXRsaW5lKTsKICAgICAgICBlbHNlCiAgICAgICAgICB3M2Nfc2xpZHkudW5mb2xkKHczY19zbGlkeS5vdXRsaW5lKTsKICAgICAgICAgIAogICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgICB9CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMTg4KSAgLy8gPCBmb3Igc21hbGxlciBmb250cwogICAgewogICAgICB3M2Nfc2xpZHkuc21hbGxlcigpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMTkwKSAgLy8gPiBmb3IgbGFyZ2VyIGZvbnRzCiAgICB7CiAgICAgIHczY19zbGlkeS5iaWdnZXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDE4OSB8fCBrZXkgPT0gMTA5KSAgLy8gLSBmb3Igc21hbGxlciBmb250cwogICAgewogICAgICB3M2Nfc2xpZHkuc21hbGxlcigpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMTg3IHx8IGtleSA9PSAxOTEgfHwga2V5ID09IDEwNykgIC8vID0gKyAgZm9yIGxhcmdlciBmb250cwogICAgewogICAgICB3M2Nfc2xpZHkuYmlnZ2VyKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA4MykgIC8vIFMgZm9yIHNtYWxsZXIgZm9udHMKICAgIHsKICAgICAgdzNjX3NsaWR5LnNtYWxsZXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDY2KSAgLy8gQiBmb3IgbGFyZ2VyIGZvbnRzCiAgICB7CiAgICAgIHczY19zbGlkeS5iaWdnZXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDkwKSAgLy8gWiBmb3IgbGFzdCBzbGlkZQogICAgewogICAgICB3M2Nfc2xpZHkubGFzdF9zbGlkZSgpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gNzApICAvLyBGIGZvciB0b2dnbGUgdG9vbGJhcgogICAgewogICAgICB3M2Nfc2xpZHkudG9nZ2xlX3Rvb2xiYXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDY1KSAgLy8gQSBmb3IgdG9nZ2xlIHZpZXcgc2luZ2xlL2FsbCBzbGlkZXMKICAgIHsKICAgICAgdzNjX3NsaWR5LnRvZ2dsZV92aWV3KCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA3NSkgIC8vIHRvZ2dsZSBhY3Rpb24gb2YgbGVmdCBjbGljayBmb3IgbmV4dCBwYWdlCiAgICB7CiAgICAgIHczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkID0gIXczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkOwogICAgICB2YXIgYWxlcnRfbXNnID0gKHczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkID8KICAgICAgICAgICAgICAgICJlbmFibGVkIiA6ICJkaXNhYmxlZCIpICsgICIgbW91c2UgY2xpY2sgYWR2YW5jZSI7CgogICAgICBhbGVydCh3M2Nfc2xpZHkubG9jYWxpemUoYWxlcnRfbXNnKSk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA4NCB8fCBrZXkgPT0gNjcpICAvLyBUIG9yIEMgZm9yIHRhYmxlIG9mIGNvbnRlbnRzCiAgICB7CiAgICAgIGlmICh3M2Nfc2xpZHkudG9jKQogICAgICAgIHczY19zbGlkeS50b2dnbGVfdGFibGVfb2ZfY29udGVudHMoKTsKCiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA3MikgLy8gSCBmb3IgaGVscAogICAgewogICAgICB3aW5kb3cubG9jYXRpb24gPSB3M2Nfc2xpZHkuaGVscF9wYWdlOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICAvL2Vsc2UgYWxlcnQoImtleSBjb2RlIGlzICIrIGtleSk7CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgLy8gc2FmZSBmb3IgYm90aCB0ZXh0L2h0bWwgYW5kIGFwcGxpY2F0aW9uL3hodG1sK3htbAogIGNyZWF0ZV9lbGVtZW50OiBmdW5jdGlvbiAobmFtZSkgewogICAgaWYgKHRoaXMueGh0bWwgJiYgKHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMgIT0gJ3VuZGVmaW5lZCcpKQogICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiwgbmFtZSkKCiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTsKICB9LAoKICBnZXRfZWxlbWVudF9zdHlsZTogZnVuY3Rpb24gKGVsZW0sIElFU3R5bGVQcm9wLCBDU1NTdHlsZVByb3ApIHsKICAgIGlmIChlbGVtLmN1cnJlbnRTdHlsZSkKICAgIHsKICAgICAgcmV0dXJuIGVsZW0uY3VycmVudFN0eWxlW0lFU3R5bGVQcm9wXTsKICAgIH0KICAgIGVsc2UgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKQogICAgewogICAgICB2YXIgY29tcFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbSwgIiIpOwogICAgICByZXR1cm4gY29tcFN0eWxlLmdldFByb3BlcnR5VmFsdWUoQ1NTU3R5bGVQcm9wKTsKICAgIH0KICAgIHJldHVybiAiIjsKICB9LAoKICAvLyB0aGUgc3RyaW5nIHN0ciBpcyBhIHdoaXRlc3BhY2Ugc2VwYXJhdGVkIGxpc3Qgb2YgdG9rZW5zCiAgLy8gdGVzdCBpZiBzdHIgY29udGFpbnMgYSBwYXJ0aWN1bGFyIHRva2VuLCBlLmcuICJzbGlkZSIKICBoYXNfdG9rZW46IGZ1bmN0aW9uIChzdHIsIHRva2VuKSB7CiAgICBpZiAoc3RyKQogICAgewogICAgICAvLyBkZWZpbmUgcGF0dGVybiBhcyByZWd1bGFyIGV4cHJlc3Npb24KICAgICAgdmFyIHBhdHRlcm4gPSAvXHcrL2c7CgogICAgICAvLyBjaGVjayBmb3IgbWF0Y2hlcwogICAgICAvLyBwbGFjZSByZXN1bHQgaW4gYXJyYXkKICAgICAgdmFyIHJlc3VsdCA9IHN0ci5tYXRjaChwYXR0ZXJuKTsKCiAgICAgIC8vIG5vdyBjaGVjayBpZiBkZXNpcmVkIHRva2VuIGlzIHByZXNlbnQKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspCiAgICAgIHsKICAgICAgICBpZiAocmVzdWx0W2ldID09IHRva2VuKQogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwKCiAgZ2V0X2NsYXNzX2xpc3Q6IGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICBpZiAodHlwZW9mIGVsZW1lbnQuY2xhc3NOYW1lICE9ICd1bmRlZmluZWQnKQogICAgICByZXR1cm4gZWxlbWVudC5jbGFzc05hbWU7CgogICAgcmV0dXJuIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpOwogIH0sCgogIGhhc19jbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIG5hbWUpIHsKICAgIGlmIChlbGVtZW50Lm5vZGVUeXBlICE9IDEpCiAgICAgIHJldHVybiBmYWxzZTsKCiAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cCgiKF58ICkiICsgbmFtZSArICJcVyoiKTsKCiAgICBpZiAodHlwZW9mIGVsZW1lbnQuY2xhc3NOYW1lICE9ICd1bmRlZmluZWQnKQogICAgICByZXR1cm4gcmVnZXhwLnRlc3QoZWxlbWVudC5jbGFzc05hbWUpOwoKICAgIHJldHVybiByZWdleHAudGVzdChlbGVtZW50LmdldEF0dHJpYnV0ZSgiY2xhc3MiKSk7CiAgfSwKCiAgcmVtb3ZlX2NsYXNzOiBmdW5jdGlvbiAoZWxlbWVudCwgbmFtZSkgewogICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoIihefCApIiArIG5hbWUgKyAiXFcqIik7CiAgICB2YXIgY2xzdmFsID0gIiI7CgogICAgaWYgKHR5cGVvZiBlbGVtZW50LmNsYXNzTmFtZSAhPSAndW5kZWZpbmVkJykKICAgIHsKICAgICAgY2xzdmFsID0gZWxlbWVudC5jbGFzc05hbWU7CgogICAgICBpZiAoY2xzdmFsKQogICAgICB7CiAgICAgICAgY2xzdmFsID0gY2xzdmFsLnJlcGxhY2UocmVnZXhwLCAiIik7CiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbHN2YWw7CiAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgY2xzdmFsID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImNsYXNzIik7CgogICAgICBpZiAoY2xzdmFsKQogICAgICB7CiAgICAgICAgY2xzdmFsID0gY2xzdmFsLnJlcGxhY2UocmVnZXhwLCAiIik7CiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgY2xzdmFsKTsKICAgICAgfQogICAgfQogIH0sCgogIGFkZF9jbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIG5hbWUpIHsKICAgIGlmICghdGhpcy5oYXNfY2xhc3MoZWxlbWVudCwgbmFtZSkpCiAgICB7CiAgICAgIGlmICh0eXBlb2YgZWxlbWVudC5jbGFzc05hbWUgIT0gJ3VuZGVmaW5lZCcpCiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgKz0gIiAiICsgbmFtZTsKICAgICAgZWxzZQogICAgICB7CiAgICAgICAgdmFyIGNsc3ZhbCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpOwogICAgICAgIGNsc3ZhbCA9IGNsc3ZhbCA/IGNsc3ZhbCArICIgIiArIG5hbWUgOiBuYW1lOwogICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCJjbGFzcyIsIGNsc3ZhbCk7CiAgICAgIH0KICAgIH0KICB9LAoKICAvLyBIVE1MIGVsZW1lbnRzIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCBjbGFzcz0iaW5jcmVtZW50YWwiCiAgLy8gbm90ZSB0aGF0IHlvdSBjYW4gYWxzbyBwdXQgdGhlIGNsYXNzIG9uIGNvbnRhaW5lcnMgbGlrZQogIC8vIHVwLCBvbCwgZGwsIGFuZCBkaXYgdG8gbWFrZSB0aGVpciBjb250ZW50cyBhcHBlYXIKICAvLyBpbmNyZW1lbnRhbGx5LiBVcHBlciBjYXNlIGlzIHVzZWQgc2luY2UgdGhpcyBpcyB3aGF0CiAgLy8gYnJvd3NlcnMgcmVwb3J0IGZvciBIVE1MIG5vZGUgbmFtZXMgKHRleHQvaHRtbCkuCiAgaW5jcmVtZW50YWxfZWxlbWVudHM6IG51bGwsCiAgb2theV9mb3JfaW5jcmVtZW50YWw6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICBpZiAoIXRoaXMuaW5jcmVtZW50YWxfZWxlbWVudHMpCiAgICB7CiAgICAgIHZhciBpbmNsaXN0ID0gbmV3IEFycmF5KCk7CiAgICAgIGluY2xpc3RbInAiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbInByZSJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsibGkiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImJsb2NrcXVvdGUiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImR0Il0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJkZCJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsiaDIiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImgzIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJoNCJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsiaDUiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImg2Il0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJzcGFuIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJhZGRyZXNzIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJ0YWJsZSJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsidHIiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbInRoIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJ0ZCJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsiaW1nIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJvYmplY3QiXSA9IHRydWU7CiAgICAgIHRoaXMuaW5jcmVtZW50YWxfZWxlbWVudHMgPSBpbmNsaXN0OwogICAgfQogICAgcmV0dXJuIHRoaXMuaW5jcmVtZW50YWxfZWxlbWVudHNbbmFtZS50b0xvd2VyQ2FzZSgpXTsKICB9LAoKICBuZXh0X2luY3JlbWVudGFsX2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICB2YXIgYnIgPSB0aGlzLmlzX3hodG1sID8gImJyIiA6ICJCUiI7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwoKICAgIGZvciAoOzspCiAgICB7CiAgICAgIG5vZGUgPSB3M2Nfc2xpZHkubmV4dF9ub2RlKHNsaWRlLCBub2RlKTsKCiAgICAgIGlmIChub2RlID09IG51bGwgfHwgbm9kZS5wYXJlbnROb2RlID09IG51bGwpCiAgICAgICAgYnJlYWs7CgogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxKSAgLy8gRUxFTUVOVAogICAgICB7CiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT0gYnIpCiAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgaWYgKHczY19zbGlkeS5oYXNfY2xhc3Mobm9kZSwgImluY3JlbWVudGFsIikKICAgICAgICAgICAgICYmIHczY19zbGlkeS5va2F5X2Zvcl9pbmNyZW1lbnRhbChub2RlLm5vZGVOYW1lKSkKICAgICAgICAgIHJldHVybiBub2RlOwoKICAgICAgICBpZiAodzNjX3NsaWR5Lmhhc19jbGFzcyhub2RlLnBhcmVudE5vZGUsICJpbmNyZW1lbnRhbCIpCiAgICAgICAgICAgICAmJiAhdzNjX3NsaWR5Lmhhc19jbGFzcyhub2RlLCAibm9uLWluY3JlbWVudGFsIikpCiAgICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBub2RlOwogIH0sCgogIHByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICB2YXIgYnIgPSB0aGlzLmlzX3hodG1sID8gImJyIiA6ICJCUiI7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwoKICAgIGZvciAoOzspCiAgICB7CiAgICAgIG5vZGUgPSB3M2Nfc2xpZHkucHJldmlvdXNfbm9kZShzbGlkZSwgbm9kZSk7CgogICAgICBpZiAobm9kZSA9PSBudWxsIHx8IG5vZGUucGFyZW50Tm9kZSA9PSBudWxsKQogICAgICAgIGJyZWFrOwoKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSkKICAgICAgewogICAgICAgIGlmIChub2RlLm5vZGVOYW1lID09IGJyKQogICAgICAgICAgY29udGludWU7CgogICAgICAgIGlmICh3M2Nfc2xpZHkuaGFzX2NsYXNzKG5vZGUsICJpbmNyZW1lbnRhbCIpCiAgICAgICAgICAgICAmJiB3M2Nfc2xpZHkub2theV9mb3JfaW5jcmVtZW50YWwobm9kZS5ub2RlTmFtZSkpCiAgICAgICAgICByZXR1cm4gbm9kZTsKCiAgICAgICAgaWYgKHczY19zbGlkeS5oYXNfY2xhc3Mobm9kZS5wYXJlbnROb2RlLCAiaW5jcmVtZW50YWwiKQogICAgICAgICAgICAgJiYgIXczY19zbGlkeS5oYXNfY2xhc3Mobm9kZSwgIm5vbi1pbmNyZW1lbnRhbCIpKQogICAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbm9kZTsKICB9LAoKICAvLyBzZXQgdmlzaWJpbGl0eSBmb3IgYWxsIGVsZW1lbnRzIG9uIGN1cnJlbnQgc2xpZGUgd2l0aAogIC8vIGEgcGFyZW50IGVsZW1lbnQgd2l0aCBhdHRyaWJ1dGUgY2xhc3M9ImluY3JlbWVudGFsIgogIHNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICB2YXIgbm9kZSA9IHRoaXMubmV4dF9pbmNyZW1lbnRhbF9pdGVtKG51bGwpOwoKICAgIGlmICh2YWx1ZSA9PSAiaGlkZGVuIikKICAgIHsKICAgICAgd2hpbGUgKG5vZGUpCiAgICAgIHsKICAgICAgICB3M2Nfc2xpZHkuYWRkX2NsYXNzKG5vZGUsICJpbnZpc2libGUiKTsKICAgICAgICBub2RlID0gdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbShub2RlKTsKICAgICAgfQogICAgfQogICAgZWxzZSAvLyB2YWx1ZSA9PSAidmlzaWJsZSIKICAgIHsKICAgICAgd2hpbGUgKG5vZGUpCiAgICAgIHsKICAgICAgICB3M2Nfc2xpZHkucmVtb3ZlX2NsYXNzKG5vZGUsICJpbnZpc2libGUiKTsKICAgICAgICBub2RlID0gdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbShub2RlKTsKICAgICAgfQogICAgfQogIH0sCgogIC8vIHJldmVhbCB0aGUgbmV4dCBoaWRkZW4gaXRlbSBvbiB0aGUgc2xpZGUKICAvLyBub2RlIGlzIG51bGwgb3IgdGhlIG5vZGUgdGhhdCB3YXMgbGFzdCByZXZlYWxlZAogIHJldmVhbF9uZXh0X2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICBub2RlID0gdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbShub2RlKTsKCiAgICBpZiAobm9kZSAmJiBub2RlLm5vZGVUeXBlID09IDEpICAvLyBhbiBlbGVtZW50CiAgICAgIHczY19zbGlkeS5yZW1vdmVfY2xhc3Mobm9kZSwgImludmlzaWJsZSIpOwoKICAgIHJldHVybiBub2RlOwogIH0sCgogIC8vIGV4YWN0IGludmVyc2Ugb2YgcmV2ZWFsTmV4dEl0ZW0obm9kZSkKICBoaWRlX3ByZXZpb3VzX2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICBpZiAobm9kZSAmJiBub2RlLm5vZGVUeXBlID09IDEpICAvLyBhbiBlbGVtZW50CiAgICAgIHczY19zbGlkeS5hZGRfY2xhc3Mobm9kZSwgImludmlzaWJsZSIpOwoKICAgIHJldHVybiB0aGlzLnByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW0obm9kZSk7CiAgfSwKCiAgLy8gbGVmdCB0byByaWdodCB0cmF2ZXJzYWwgb2Ygcm9vdCdzIGNvbnRlbnQKICBuZXh0X25vZGU6IGZ1bmN0aW9uIChyb290LCBub2RlKSB7CiAgICBpZiAobm9kZSA9PSBudWxsKQogICAgICByZXR1cm4gcm9vdC5maXJzdENoaWxkOwoKICAgIGlmIChub2RlLmZpcnN0Q2hpbGQpCiAgICAgIHJldHVybiBub2RlLmZpcnN0Q2hpbGQ7CgogICAgaWYgKG5vZGUubmV4dFNpYmxpbmcpCiAgICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nOwoKICAgIGZvciAoOzspCiAgICB7CiAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7CgogICAgICBpZiAoIW5vZGUgfHwgbm9kZSA9PSByb290KQogICAgICAgIGJyZWFrOwoKICAgICAgaWYgKG5vZGUgJiYgbm9kZS5uZXh0U2libGluZykKICAgICAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZzsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9LAoKICAvLyByaWdodCB0byBsZWZ0IHRyYXZlcnNhbCBvZiByb290J3MgY29udGVudAogIHByZXZpb3VzX25vZGU6IGZ1bmN0aW9uIChyb290LCBub2RlKSB7CiAgICBpZiAobm9kZSA9PSBudWxsKQogICAgewogICAgICBub2RlID0gcm9vdC5sYXN0Q2hpbGQ7CgogICAgICBpZiAobm9kZSkKICAgICAgewogICAgICAgIHdoaWxlIChub2RlLmxhc3RDaGlsZCkKICAgICAgICAgIG5vZGUgPSBub2RlLmxhc3RDaGlsZDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5vZGU7CiAgICB9CgogICAgaWYgKG5vZGUucHJldmlvdXNTaWJsaW5nKQogICAgewogICAgICBub2RlID0gbm9kZS5wcmV2aW91c1NpYmxpbmc7CgogICAgICB3aGlsZSAobm9kZS5sYXN0Q2hpbGQpCiAgICAgICAgbm9kZSA9IG5vZGUubGFzdENoaWxkOwoKICAgICAgcmV0dXJuIG5vZGU7CiAgICB9CgogICAgaWYgKG5vZGUucGFyZW50Tm9kZSAhPSByb290KQogICAgICByZXR1cm4gbm9kZS5wYXJlbnROb2RlOwoKICAgIHJldHVybiBudWxsOwogIH0sCgogIHByZXZpb3VzX3NpYmxpbmdfZWxlbWVudDogZnVuY3Rpb24gKGVsKSB7CiAgICBlbCA9IGVsLnByZXZpb3VzU2libGluZzsKCiAgICB3aGlsZSAoZWwgJiYgZWwubm9kZVR5cGUgIT0gMSkKICAgICAgZWwgPSBlbC5wcmV2aW91c1NpYmxpbmc7CgogICAgcmV0dXJuIGVsOwogIH0sCgogIG5leHRfc2libGluZ19lbGVtZW50OiBmdW5jdGlvbiAoZWwpIHsKICAgIGVsID0gZWwubmV4dFNpYmxpbmc7CgogICAgd2hpbGUgKGVsICYmIGVsLm5vZGVUeXBlICE9IDEpCiAgICAgIGVsID0gZWwubmV4dFNpYmxpbmc7CgogICAgcmV0dXJuIGVsOwogIH0sCgogIGZpcnN0X2NoaWxkX2VsZW1lbnQ6IGZ1bmN0aW9uIChlbCkgewogICAgdmFyIG5vZGU7CgogICAgZm9yIChub2RlID0gZWwuZmlyc3RDaGlsZDsgbm9kZTsgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpCiAgICB7CiAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEpCiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIG5vZGU7CiAgfSwKCiAgZmlyc3RfdGFnOiBmdW5jdGlvbiAoZWxlbWVudCwgdGFnKSB7CiAgICB2YXIgbm9kZTsKCiAgICBpZiAoIXRoaXMuaXNfeGh0bWwpCiAgICAgIHRhZyA9IHRhZy50b1VwcGVyQ2FzZSgpOwoKICAgIGZvciAobm9kZSA9IGVsZW1lbnQuZmlyc3RDaGlsZDsgbm9kZTsgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpCiAgICB7CiAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEgJiYgbm9kZS5ub2RlTmFtZSA9PSB0YWcpCiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIG5vZGU7CiAgfSwKCiAgaGlkZV9zZWxlY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSAvLyBGaXJlZm94LCBDaHJvbWl1bSwgU2FmYXJpLCBPcGVyYQogICAgewogICAgICB2YXIgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOwoKICAgICAgaWYgKHNlbGVjdGlvbi5yYW5nZUNvdW50ID4gMCkKICAgICAgewogICAgICAgIHZhciByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApOwogICAgICAgIHJhbmdlLmNvbGxhcHNlIChmYWxzZSk7CiAgICAgIH0KICAgIH0KICAgIGVsc2UgLy8gSW50ZXJuZXQgRXhwbG9yZXIKICAgIHsKICAgICAgdmFyIHRleHRSYW5nZSA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSAoKTsKICAgICAgdGV4dFJhbmdlLmNvbGxhcHNlIChmYWxzZSk7CiAgICB9CiAgfSwKCiAgZ2V0X3NlbGVjdGVkX3RleHQ6IGZ1bmN0aW9uICgpIHsKICAgIHRyeQogICAgewogICAgICBpZiAod2luZG93LmdldFNlbGVjdGlvbikKICAgICAgICByZXR1cm4gd2luZG93LmdldFNlbGVjdGlvbigpLnRvU3RyaW5nKCk7CgogICAgICBpZiAoZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKQogICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpOwoKICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikKICAgICAgICByZXR1cm4gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dDsKICAgIH0KICAgIGNhdGNoIChlKQogICAgewogICAgfQoKICAgIHJldHVybiAiIjsKICB9LAoKICAvLyBtYWtlIG5vdGUgb2YgbGVuZ3RoIG9mIHNlbGVjdGVkIHRleHQKICAvLyBhcyB0aGlzIGV2YWx1YXRlcyB0byB6ZXJvIGluIGNsaWNrIGV2ZW50CiAgbW91c2VfYnV0dG9uX3VwOiBmdW5jdGlvbiAoZSkgewogICAgdzNjX3NsaWR5LnNlbGVjdGVkX3RleHRfbGVuID0gdzNjX3NsaWR5LmdldF9zZWxlY3RlZF90ZXh0KCkubGVuZ3RoOwogIH0sCgogIG1vdXNlX2J1dHRvbl9kb3duOiBmdW5jdGlvbiAoZSkgewogICAgdzNjX3NsaWR5LnNlbGVjdGVkX3RleHRfbGVuID0gdzNjX3NsaWR5LmdldF9zZWxlY3RlZF90ZXh0KCkubGVuZ3RoOwogICAgdzNjX3NsaWR5Lm1vdXNlX3ggPSBlLmNsaWVudFg7CiAgICB3M2Nfc2xpZHkubW91c2VfeSA9IGUuY2xpZW50WTsKICB9LAoKICAvLyByaWdodCBtb3VzZSBidXR0b24gY2xpY2sgaXMgcmVzZXJ2ZWQgZm9yIGNvbnRleHQgbWVudXMKICAvLyBpdCBpcyBtb3JlIHJlbGlhYmxlIHRvIGRldGVjdCByaWdodGNsaWNrIHRoYW4gbGVmdGNsaWNrCiAgbW91c2VfYnV0dG9uX2NsaWNrOiBmdW5jdGlvbiAoZSkgewogICAgaWYgKCFlKQogICAgICB2YXIgZSA9IHdpbmRvdy5ldmVudDsKCiAgICBpZiAoTWF0aC5hYnMoZS5jbGllbnRYIC13M2Nfc2xpZHkubW91c2VfeCkgKwogICAgICAgIE1hdGguYWJzKGUuY2xpZW50WSAtdzNjX3NsaWR5Lm1vdXNlX3kpID4gMTApCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGlmICh3M2Nfc2xpZHkuc2VsZWN0ZWRfdGV4dF9sZW4gPiAwKQogICAgICByZXR1cm4gdHJ1ZTsKCiAgICB2YXIgcmlnaHRjbGljayA9IGZhbHNlOwogICAgdmFyIGxlZnRjbGljayA9IGZhbHNlOwogICAgdmFyIG1pZGRsZWNsaWNrID0gZmFsc2U7CiAgICB2YXIgdGFyZ2V0OwoKICAgIGlmICghZSkKICAgICAgdmFyIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgaWYgKGUudGFyZ2V0KQogICAgICB0YXJnZXQgPSBlLnRhcmdldDsKICAgIGVsc2UgaWYgKGUuc3JjRWxlbWVudCkKICAgICAgdGFyZ2V0ID0gZS5zcmNFbGVtZW50OwoKICAgIC8vIHdvcmsgYXJvdW5kIFNhZmFyaSBidWcKICAgIGlmICh0YXJnZXQubm9kZVR5cGUgPT0gMykKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CgogICAgaWYgKGUud2hpY2gpIC8vIGFsbCBicm93c2VycyBleGNlcHQgSUUKICAgIHsKICAgICAgbGVmdGNsaWNrID0gKGUud2hpY2ggPT0gMSk7CiAgICAgIG1pZGRsZWNsaWNrID0gKGUud2hpY2ggPT0gMik7CiAgICAgIHJpZ2h0Y2xpY2sgPSAoZS53aGljaCA9PSAzKTsKICAgIH0KICAgIGVsc2UgaWYgKGUuYnV0dG9uKQogICAgewogICAgICAvLyBLb25xdWVyb3IgZ2l2ZXMgMSBmb3IgbGVmdCwgNCBmb3IgbWlkZGxlCiAgICAgIC8vIElFNiBnaXZlcyAwIGZvciBsZWZ0IGFuZCBub3QgMSBhcyBJIGV4cGVjdGVkCgogICAgICBpZiAoZS5idXR0b24gPT0gNCkKICAgICAgICBtaWRkbGVjbGljayA9IHRydWU7CgogICAgICAvLyBhbGwgYnJvd3NlcnMgYWdyZWUgb24gMiBmb3IgcmlnaHQgYnV0dG9uCiAgICAgIHJpZ2h0Y2xpY2sgPSAoZS5idXR0b24gPT0gMik7CiAgICB9CiAgICBlbHNlCiAgICAgIGxlZnRjbGljayA9IHRydWU7CgogICAgaWYgKHczY19zbGlkeS5zZWxlY3RlZF90ZXh0X2xlbiA+IDApCiAgICB7CiAgICAgIHczY19zbGlkeS5zdG9wX3Byb3BhZ2F0aW9uKGUpOwogICAgICBlLmNhbmNlbCA9IHRydWU7CiAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIGRpc21pc3MgdGFibGUgb2YgY29udGVudHMKICAgIHczY19zbGlkeS5oaWRlX3RhYmxlX29mX2NvbnRlbnRzKGZhbHNlKTsKCiAgICAvLyBjaGVjayBpZiB0YXJnZXQgaXMgc29tZXRoaW5nIHRoYXQgcHJvYmFibHkgd2FudCdzIGNsaWNrcwogICAgLy8gZS5nLiBhLCBlbWJlZCwgb2JqZWN0LCBpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgb3B0aW9uCiAgICB2YXIgdGFnID0gdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgogICAgaWYgKHczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkICYmIGxlZnRjbGljayAmJgogICAgICAgICF3M2Nfc2xpZHkuc3BlY2lhbF9lbGVtZW50KHRhcmdldCkgJiYKICAgICAgICAhdGFyZ2V0Lm9uY2xpY2spCiAgICB7CiAgICAgIHczY19zbGlkeS5uZXh0X3NsaWRlKHRydWUpOwogICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihlKTsKICAgICAgZS5jYW5jZWwgPSB0cnVlOwogICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICBzcGVjaWFsX2VsZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICBpZiAodGhpcy5oYXNfY2xhc3MoZWxlbWVudCwgIm5vbi1pbnRlcmFjdGl2ZSIpKQogICAgICByZXR1cm4gZmFsc2U7CgogICAgdmFyIHRhZyA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICByZXR1cm4gZWxlbWVudC5vbmtleWRvd24gfHwKICAgICAgZWxlbWVudC5vbmNsaWNrIHx8CiAgICAgIHRhZyA9PSAiYSIgfHwKICAgICAgdGFnID09ICJlbWJlZCIgfHwKICAgICAgdGFnID09ICJvYmplY3QiIHx8CiAgICAgIHRhZyA9PSAidmlkZW8iIHx8CiAgICAgIHRhZyA9PSAiYXVkaW8iIHx8CiAgICAgIHRhZyA9PSAic3ZnIiB8fAogICAgICB0YWcgPT0gImNhbnZhcyIgfHwKICAgICAgdGFnID09ICJpbnB1dCIgfHwKICAgICAgdGFnID09ICJ0ZXh0YXJlYSIgfHwKICAgICAgdGFnID09ICJzZWxlY3QiIHx8CiAgICAgIHRhZyA9PSAib3B0aW9uIjsKICB9LAoKICBzbGlkeV9jaHJvbWU6IGZ1bmN0aW9uIChlbCkgewogICAgd2hpbGUgKGVsKQogICAgewogICAgICBpZiAoZWwgPT0gdzNjX3NsaWR5LnRvYyB8fAogICAgICAgICAgZWwgPT0gdzNjX3NsaWR5LnRvb2xiYXIgfHwKICAgICAgICAgIHczY19zbGlkeS5oYXNfY2xhc3MoZWwsICJvdXRsaW5lIikpCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICBlbCA9IGVsLnBhcmVudE5vZGU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIGdldF9rZXk6IGZ1bmN0aW9uIChlKQogIHsKICAgIHZhciBrZXk7CgogICAgLy8ga2x1ZGdlIGFyb3VuZCBOUy9JRSBkaWZmZXJlbmNlcyAKICAgIGlmICh0eXBlb2Ygd2luZG93LmV2ZW50ICE9ICJ1bmRlZmluZWQiKQogICAgICBrZXkgPSB3aW5kb3cuZXZlbnQua2V5Q29kZTsKICAgIGVsc2UgaWYgKGUud2hpY2gpCiAgICAgIGtleSA9IGUud2hpY2g7CgogICAgcmV0dXJuIGtleTsKICB9LAoKICBnZXRfdGFyZ2V0OiBmdW5jdGlvbiAoZSkgewogICAgdmFyIHRhcmdldDsKCiAgICBpZiAoIWUpCiAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgaWYgKGUudGFyZ2V0KQogICAgICB0YXJnZXQgPSBlLnRhcmdldDsKICAgIGVsc2UgaWYgKGUuc3JjRWxlbWVudCkKICAgICAgdGFyZ2V0ID0gZS5zcmNFbGVtZW50OwoKICAgIGlmICh0YXJnZXQubm9kZVR5cGUgIT0gMSkKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CgogICAgcmV0dXJuIHRhcmdldDsKICB9LAoKICAvLyBkb2VzIGRpc3BsYXkgcHJvcGVydHkgcHJvdmlkZSBjb3JyZWN0IGRlZmF1bHRzPwogIGlzX2Jsb2NrOiBmdW5jdGlvbiAoZWxlbSkgewogICAgdmFyIHRhZyA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICByZXR1cm4gdGFnID09ICJvbCIgfHwgdGFnID09ICJ1bCIgfHwgdGFnID09ICJwIiB8fCB0YWcgPT0gImRsIiB8fAogICAgICAgICAgIHRhZyA9PSAibGkiIHx8IHRhZyA9PSAidGFibGUiIHx8IHRhZyA9PSAicHJlIiB8fAogICAgICAgICAgIHRhZyA9PSAiaDEiIHx8IHRhZyA9PSAiaDIiIHx8IHRhZyA9PSAiaDMiIHx8CiAgICAgICAgICAgdGFnID09ICJoNCIgfHwgdGFnID09ICJoNSIgfHwgdGFnID09ICJoNiIgfHwKICAgICAgICAgICB0YWcgPT0gImJsb2NrcXVvdGUiIHx8IHRhZyA9PSAiYWRkcmVzcyI7IAogIH0sCgogIGFkZF9saXN0ZW5lcjogZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7CiAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpCiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpOwogICAgZWxzZQogICAgICBlbGVtZW50LmF0dGFjaEV2ZW50KCJvbiIrZXZlbnQsIGhhbmRsZXIpOwogIH0sCgogIC8vIHVzZWQgdG8gcHJldmVudCBldmVudCBwcm9wYWdhdGlvbiBmcm9tIGZpZWxkIGNvbnRyb2xzCiAgc3RvcF9wcm9wYWdhdGlvbjogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICBldmVudCA9IGV2ZW50ID8gZXZlbnQgOiB3aW5kb3cuZXZlbnQ7CiAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlOyAgLy8gZm9yIElFCgogICAgaWYgKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikKICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgY2FuY2VsOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGlmIChldmVudCkKICAgIHsKICAgICAgIGV2ZW50LmNhbmNlbCA9IHRydWU7CiAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlOwoKICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KQogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICB9CgogICAgdzNjX3NsaWR5LmtleV93YW50ZWQgPSBmYWxzZTsKICAgIHJldHVybiBmYWxzZTsKICB9LAoKLy8gZm9yIGVhY2ggbGFuZ3VhZ2UgZGVmaW5lIGFuIGFzc29jaWF0aXZlIGFycmF5Ci8vIGFuZCBhbHNvIHRoZSBoZWxwIHRleHQgd2hpY2ggaXMgbG9uZ2VyCgogIHN0cmluZ3NfZXM6IHsKICAgICJzbGlkZSI6InDDoWcuIiwKICAgICJoZWxwPyI6IkF5dWRhIiwKICAgICJjb250ZW50cz8iOiLDjW5kaWNlIiwKICAgICJ0YWJsZSBvZiBjb250ZW50cyI6InRhYmxhIGRlIGNvbnRlbmlkb3MiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoiVGFibGEgZGUgQ29udGVuaWRvcyIsCiAgICAicmVzdGFydCBwcmVzZW50YXRpb24iOiJSZWluaWNpYXIgcHJlc2VudGFjacOzbiIsCiAgICAicmVzdGFydD8iOiJJbmljaW8iCiAgfSwKICBoZWxwX2VzOgogICAgIlV0aWxpY2UgZWwgcmF0w7NuLCBiYXJyYSBlc3BhY2lhZG9yYSwgdGVjbGFzIEl6ZGEvRGNoYSwgIiArCiAgICAibyBSZSBww6FnIHkgQXYgcMOhZy4gVXNlIFMgeSBCIHBhcmEgY2FtYmlhciBlbCB0YW1hw7FvIGRlIGZ1ZW50ZS4iLAoKICBzdHJpbmdzX2NhOiB7CiAgICAic2xpZGUiOiJww6BnLi4iLAogICAgImhlbHA/IjoiQWp1ZGEiLAogICAgImNvbnRlbnRzPyI6IsONbmRleCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJ0YXVsYSBkZSBjb250aW5ndXRzIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IlRhdWxhIGRlIENvbnRpbmd1dHMiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiUmVpbmljaWFyIHByZXNlbnRhY2nDsyIsCiAgICAicmVzdGFydD8iOiJJbmljaSIKICB9LAogIGhlbHBfY2E6CiAgICAiVXRpbGl0emkgZWwgcmF0b2zDrSwgYmFycmEgZXNwYWlhZG9yYSwgdGVjbGVzIEVzcS4vRHRhLiAiICsKICAgICJvIFJlIHDDoGcgeSBBdiBww6BnLiBVc2kgUyBpIEIgcGVyIGNhbnZpYXIgZ3JhbmTDoHJpYSBkZSBmb250LiIsCgogIHN0cmluZ3NfY3M6IHsKICAgICJzbGlkZSI6InNuw61tZWsiLAogICAgImhlbHA/IjoibsOhcG92xJtkYSIsCiAgICAiY29udGVudHM/Ijoib2JzYWgiLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoib2JzYWggcHJlemVudGFjZSIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiJPYnNhaCBwcmV6ZW50YWNlIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6Inpub3Z1IHNwdXN0aXQgcHJlemVudGFjaSIsCiAgICAicmVzdGFydD8iOiJyZXN0YXJ0IgogIH0sCiAgaGVscF9jczoKICAgICJQcmV6ZW50YWNpIG3Fr8W+ZXRlIHByb2Now6F6ZXQgcG9tb2PDrSBrbGlrbnV0w60gbXnFoWksIG1lemVybsOta3UsICIgKwogICAgIsWhaXBlayB2bGV2byBhIHZwcmF2byBuZWJvIGtsw6F2ZXMgUGFnZVVwIGEgUGFnZURvd24uIFDDrXNtbyBzZSAiICsKICAgICJkw6EgenbEm3TFoWl0IGEgem1lbsWhaXQgcG9tb2PDrSBrbMOhdmVzIEIgYSBTLiIsCgogIHN0cmluZ3Nfbmw6IHsKICAgICJzbGlkZSI6InBhZ2luYSIsCiAgICAiaGVscD8iOiJIZWxwPyIsCiAgICAiY29udGVudHM/IjoiSW5ob3VkPyIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJpbmhvdWRzb3BnYXZlIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IkluaG91ZHNvcGdhdmUiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiaGVyc3RhcnQgcHJlc2VudGF0aWUiLAogICAgInJlc3RhcnQ/IjoiSGVyc3RhcnQ/IgogIH0sCiAgaGVscF9ubDoKICAgICAiTmF2aWdlZXIgZC5tLnYuIGhldCBtdWlzLCBzcGF0aWViYXIsIExpbmtzL1JlY2h0cyB0b2V0c2VuLCAiICsKICAgICAib2YgUGdVcCBlbiBQZ0RuLiBHZWJydWlrIFMgZW4gQiBvbSBkZSBrYXJha3Rlcmdyb290dGUgdGUgdmVyYW5kZXJlbi4iLAoKICBzdHJpbmdzX2RlOiB7CiAgICAic2xpZGUiOiJTZWl0ZSIsCiAgICAiaGVscD8iOiJIaWxmZSIsCiAgICAiY29udGVudHM/Ijoiw5xiZXJzaWNodCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJJbmhhbHRzdmVyemVpY2huaXMiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoiSW5oYWx0c3ZlcnplaWNobmlzIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6IlByw6RzZW50YXRpb24gbmV1IHN0YXJ0ZW4iLAogICAgInJlc3RhcnQ/IjoiTmV1c3RhcnQiCiAgfSwKICBoZWxwX2RlOgogICAgIkJlbnV0emVuIFNpZSBkaWUgTWF1cywgTGVlcnNjaGxhZywgZGllIEN1cnNvcnRhc3RlbiBsaW5rcy9yZWNodHMgb2RlciAiICsKICAgICJQYWdlIHVwL1BhZ2UgRG93biB6dW0gV2VjaHNlbG4gZGVyIFNlaXRlbiB1bmQgUyB1bmQgQiBmw7xyIGRpZSBTY2hyaWZ0Z3LDtnNzZS4iLAoKICBzdHJpbmdzX3BsOiB7CiAgICAic2xpZGUiOiJzbGFqZCIsCiAgICAiaGVscD8iOiJwb21vYz8iLAogICAgImNvbnRlbnRzPyI6InNwaXMgdHJlxZtjaT8iLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoic3BpcyB0cmXFm2NpIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IlNwaXMgVHJlxZtjaSIsCiAgICAicmVzdGFydCBwcmVzZW50YXRpb24iOiJSZXN0YXJ0dWogcHJlemVudGFjasSZIiwKICAgICJyZXN0YXJ0PyI6InJlc3RhcnQ/IgogIH0sCiAgaGVscF9wbDoKICAgICJabWllbmlhaiBzbGFqZHkga2xpa2FqxIVjIG15c3rEhSwgbmFjaXNrYWrEhWMgc3BhY2rEmSwgc3RyemHFgmtpIGxld28vcHJhd28iICsKICAgICJsdWIgUGdVcCAvIFBnRG4uIFXFvHlqIGtsYXdpc3p5IFMgaSBCLCBhYnkgem1pZW5pxIcgcm96bWlhciBjemN6aW9ua2kuIiwKCiAgc3RyaW5nc19mcjogewogICAgInNsaWRlIjoicGFnZSIsCiAgICAiaGVscD8iOiJBaWRlIiwKICAgICJjb250ZW50cz8iOiJJbmRleCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJ0YWJsZSBkZXMgbWF0acOocmVzIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IlRhYmxlIGRlcyBtYXRpw6hyZXMiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiUmVjb21tZW5jZXIgbCdleHBvc8OpIiwKICAgICJyZXN0YXJ0PyI6IkTDqWJ1dCIKICB9LAogIGhlbHBfZnI6CiAgICAiTmF2aWd1ZXogYXZlYyBsYSBzb3VyaXMsIGxhIGJhcnJlIGQnZXNwYWNlLCBsZXMgZmzDqGNoZXMgIiArCiAgICAiZ2F1Y2hlL2Ryb2l0ZSBvdSBsZXMgdG91Y2hlcyBQZyBVcCwgUGcgRG4uIFV0aWxpc2V6ICIgKwogICAgImxlcyB0b3VjaGVzIFMgZXQgQiBwb3VyIG1vZGlmaWVyIGxhIHRhaWxsZSBkZSBsYSBwb2xpY2UuIiwKCiAgc3RyaW5nc19odTogewogICAgInNsaWRlIjoib2xkYWwiLAogICAgImhlbHA/Ijoic2Vnw610c8OpZyIsCiAgICAiY29udGVudHM/IjoidGFydGFsb20iLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoidGFydGFsb21qZWd5esOpayIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiJUYXJ0YWxvbWplZ3l6w6lrIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6ImJlbXV0YXTDsyDDumpyYWluZMOtdMOhc2EiLAogICAgInJlc3RhcnQ/Ijoiw7pqcmFpbmTDrXTDoXMiCiAgfSwKICBoZWxwX2h1OgogICAgIkF6IG9sZGFsYWsga8O2enRpIGzDqXBrZWTDqXNoZXoga2F0dGludHNvbiBheiBlZ8OpcnJlbCwgdmFneSAiICsKICAgICJoYXN6bsOhbGphIGEgc3rDs2vDtnosIGEgYmFsLCB2YWd5IGEgam9iYiBuecOtbCwgaWxsZXR2ZSBhIFBhZ2UgRG93biwgIiArCiAgICAiUGFnZSBVcCBiaWxsZW50ecWxa2V0LiBBeiBTIMOpcyBhIEIgYmlsbGVudHnFsWtrZWwgdsOhbHRvenRhdGhhdGphICIgKwogICAgImEgc3rDtnZlZyBtw6lyZXTDqXQuIiwKCiAgc3RyaW5nc19pdDogewogICAgInNsaWRlIjoicGFnLiIsCiAgICAiaGVscD8iOiJBaXV0byIsCiAgICAiY29udGVudHM/IjoiSW5kaWNlIiwKICAgICJ0YWJsZSBvZiBjb250ZW50cyI6ImluZGljZSIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiJJbmRpY2UiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiUmljb21pbmNpYXJlIGxhIHByZXNlbnRhemlvbmUiLAogICAgInJlc3RhcnQ/IjoiSW5pemlvIgogIH0sCiAgaGVscF9pdDoKICAgICJOYXZpZ2FyZSBjb24gbW91c2UsIGJhcnJhIHNwYXppbywgZnJlY2NlIHNpbmlzdHJhL2Rlc3RyYSBvICIgKwogICAgIlBnVXAgZSBQZ0RuLiBVc2FyZSBTIGUgQiBwZXIgY2FtYmlhcmUgbGEgZGltZW5zaW9uZSBkZWkgY2FyYXR0ZXJpLiIsCgogIHN0cmluZ3NfZWw6IHsKICAgICJzbGlkZSI6Is+DzrXOu86vzrTOsSIsCiAgICAiaGVscD8iOiLOss6/zq7OuM61zrnOsTsiLAogICAgImNvbnRlbnRzPyI6Is+AzrXPgc65zrXPh8+MzrzOtc69zrE7IiwKICAgICJ0YWJsZSBvZiBjb250ZW50cyI6Is+Azq/Ovc6xzrrOsc+CIM+AzrXPgc65zrXPh86/zrzOrc69z4nOvSIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiLOoM6vzr3Osc66zrHPgiDOoM61z4HOuc61z4fOv868zq3Ovc+Jzr0iLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoizrXPgM6xzr3Otc66zrrOr869zrfPg863IM+AzrHPgc6/z4XPg86vzrHPg863z4IiLAogICAgInJlc3RhcnQ/IjoizrXPgM6xzr3Otc66zrrOr869zrfPg863OyIKICB9LAogIGhlbHBfZWw6CiAgICAizqDOu86/zrfOs863zrjOtc6vz4TOtSDOvM61IM+Ezr8gzrrOu86vzrogz4TOv8+FIM+Azr/Ovc+EzrnOus65zr/PjSwgz4TOvyBzcGFjZSwgz4TOsSDOss6tzrvOtyDOsc+BzrnPg8+EzrXPgc6sL860zrXOvs65zqwsICIgKwogICAgIs6uIFBhZ2UgVXAgzrrOsc65IFBhZ2UgRG93bi4gzqfPgc63z4POuc68zr/PgM6/zrnOrs+Dz4TOtSDPhM6xIM+AzrvOrs66z4TPgc6xIFMgzrrOsc65IEIgzrPOuc6xIM69zrEgzrHOu867zqzOvs61z4TOtSAiICsKICAgICLPhM6/IM68zq3Os861zrjOv8+CIM+EzrfPgiDOs8+BzrHOvM68zrHPhM6/z4POtc65z4HOrM+CLiIsCgogIHN0cmluZ3NfamE6IHsKICAgICJzbGlkZSI6IuOCueODqeOCpOODiSIsCiAgICAiaGVscD8iOiLjg5jjg6vjg5ciLAogICAgImNvbnRlbnRzPyI6IuebruasoSIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiLnm67mrKHjgpLooajnpLoiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoi55uu5qyhIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6IuacgOWIneOBi+OCieWGjeeUnyIsCiAgICAicmVzdGFydD8iOiLmnIDliJ3jgYvjgokiCiAgfSwKICBoZWxwX2phOgogICAgICLjg57jgqbjgrnlt6bjgq/jg6rjg4Pjgq8g44O7IOOCueODmuODvOOCuSDjg7sg5bem5Y+z44Kt44O8ICIgKwogICAgICLjgb7jgZ/jga8gUGFnZSBVcCDjg7sgUGFnZSBEb3du44Gn5pON5L2c77yMIFMg44O7IELjgafjg5Xjgqnjg7Pjg4jjgrXjgqTjgrrlpInmm7QiLAoKICBzdHJpbmdzX3poOiB7CiAgICAic2xpZGUiOiLlubvnga/niYciLAogICAgImhlbHA/Ijoi5biu5YqpPyIsCiAgICAiY29udGVudHM/Ijoi5YaF5a65PyIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiLnm67lvZUiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoi55uu5b2VIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6IumHjeaWsOWQr+WKqOWxleekuiIsCiAgICAicmVzdGFydD8iOiLph43mlrDlkK/liqg/IgogIH0sCiAgaGVscF96aDoKICAgICLnlKjpvKDmoIfngrnlh7ssIOepuuagvOadoSwg5bem5Y+z566t5aS0LCBQZyBVcCDlkowgUGcgRG4g5a+86IiqLiAiICsKICAgICLnlKggUywgQiDmlLnlj5jlrZfkvZPlpKflsI8uIiwKCiAgc3RyaW5nc19ydTogewogICAgInNsaWRlIjoi0YHQu9Cw0LnQtCIsCiAgICAiaGVscD8iOiLQv9C+0LzQvtGJ0Yw/IiwKICAgICJjb250ZW50cz8iOiLRgdC+0LTQtdGA0LbQsNC90LjQtT8iLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoi0L7Qs9C70LDQstC70LXQvdC40LUiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoi0J7Qs9C70LDQstC70LXQvdC40LUiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoi0L/QtdGA0LXQt9Cw0L/Rg9GB0YLQuNGC0Ywg0L/RgNC10LfQtdC90YLQsNGG0LjRjiIsCiAgICAicmVzdGFydD8iOiLQv9C10YDQtdC30LDQv9GD0YHQuj8iCiAgfSwKICBoZWxwX3J1OgogICAgItCf0LXRgNC10LzQtdGJ0LDQudGC0LXRgdGMINC60LvQuNC60LDRjyDQvNGL0YjQutC+0LksINC40YHQv9C+0LvRjNC30YPRjyDQutC70LDQstC40YjRgyDQv9GA0L7QsdC10LssINGB0YLRgNC10LvQutC4IiArCiAgICAi0LLQu9C10LLQvi/QstC/0YDQsNCy0L4g0LjQu9C4IFBnIFVwINC4IFBnIERuLiDQmtC70LDQstC40YjQuCBTINC4IEIg0LzQtdC90Y/RjtGCINGA0LDQt9C80LXRgCDRiNGA0LjRhNGC0LAuIiwKCiAgc3RyaW5nc19zdjogewogICAgInNsaWRlIjoic2lkYSIsCiAgICAiaGVscD8iOiJoasOkbHAiLAogICAgImNvbnRlbnRzPyI6ImlubmVow6VsbCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJpbm5laMOlbGxzZsO2cnRlY2tuaW5nIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IklubmVow6VsbHNmw7ZydGVja25pbmciLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoidmlzYSBwcmVzZW50YXRpb25lbiBmcsOlbiBiw7ZyamFuIiwKICAgICJyZXN0YXJ0PyI6ImLDtnJqYSBvbSIKICB9LAogIGhlbHBfc3Y6CiAgICAiQmzDpGRkcmEgbWVkIGV0dCBrbGljayBtZWQgdsOkbnN0cmEgbXVza25hcHBlbiwgbWVsbGFuc2xhZ3N0YW5nZW50ZW4sICIgKwogICAgInbDpG5zdGVyLSBvY2ggaMO2Z2VycGlsdGFuZ2VudGVybmEgZWxsZXIgdGFuZ2VudGVybmEgUGcgVXAsIFBnIERuLiAiICsKICAgICJBbnbDpG5kIHRhbmdlbnRlcm5hIFMgb2NoIEIgZsO2ciBhdHQgw6RuZHJhIHRleHRlbnMgc3Rvcmxlay4iLAoKICBzdHJpbmdzOiB7IH0sCgogIGxvY2FsaXplOiBmdW5jdGlvbiAoc3JjKSB7CiAgICBpZiAoc3JjID09ICIiKQogICAgICByZXR1cm4gc3JjOwoKICAgICAvLyB0cnkgZnVsbCBsYW5ndWFnZSBjb2RlLCBlLmcuIGVuLVVTCiAgICAgdmFyIHMsIGxvb2t1cCA9IHczY19zbGlkeS5zdHJpbmdzW3czY19zbGlkeS5sYW5nXTsKCiAgICAgaWYgKGxvb2t1cCkKICAgICB7CiAgICAgICBzID0gbG9va3VwW3NyY107CgogICAgICAgaWYgKHMpCiAgICAgICAgcmV0dXJuIHM7CiAgICAgfQoKICAgICAvLyBzdHJpcCBjb3VudHJ5IGNvZGUgc3VmZml4LCBlLmcuCiAgICAgLy8gdHJ5IGVuIGlmIHVuZGVmaW5lZCBmb3IgZW4tVVMKICAgICB2YXIgbGcgPSB3M2Nfc2xpZHkubGFuZy5zcGxpdCgiLSIpOwoKICAgICBpZiAobGcubGVuZ3RoID4gMSkKICAgICB7CiAgICAgICBsb29rdXAgPSB3M2Nfc2xpZHkuc3RyaW5nc1tsZ1swXV07CgogICAgICAgaWYgKGxvb2t1cCkKICAgICAgIHsKICAgICAgICAgcyA9IGxvb2t1cFtzcmNdOwoKICAgICAgICAgaWYgKHMpCiAgICAgICAgICByZXR1cm4gczsKICAgICAgIH0KICAgICB9CgogICAgIC8vIG90aGVyd2lzZSBzdHJpbmcgYXMgaXMKICAgICByZXR1cm4gc3JjOwogIH0sCgogIGluaXRfbG9jYWxpemF0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaTE4biA9IHczY19zbGlkeTsKICAgIHZhciBoZWxwX3RleHQgPSB3M2Nfc2xpZHkuaGVscF90ZXh0OwoKICAgIC8vIGVhY2ggc3VjaCBsYW5ndWFnZSBhcnJheSBpcyBkZWNsYXJlZCBpbiB0aGUgbG9jYWxpemUgYXJyYXkKICAgIC8vIHRoaXMgaXMgdXNlZCBhcyBpbiAgdzNjX3NsaWR5LmxvY2FsaXplKCJmb28iKTsKICAgIHRoaXMuc3RyaW5ncyA9IHsKICAgICAgImVzIjp0aGlzLnN0cmluZ3NfZXMsCiAgICAgICJjYSI6dGhpcy5zdHJpbmdzX2NhLAogICAgICAiY3MiOnRoaXMuc3RyaW5nc19jcywKICAgICAgIm5sIjp0aGlzLnN0cmluZ3NfbmwsCiAgICAgICJkZSI6dGhpcy5zdHJpbmdzX2RlLAogICAgICAicGwiOnRoaXMuc3RyaW5nc19wbCwKICAgICAgImZyIjp0aGlzLnN0cmluZ3NfZnIsCiAgICAgICJodSI6dGhpcy5zdHJpbmdzX2h1LAogICAgICAiaXQiOnRoaXMuc3RyaW5nc19pdCwKICAgICAgImVsIjp0aGlzLnN0cmluZ3NfZWwsCiAgICAgICJqcCI6dGhpcy5zdHJpbmdzX2phLAogICAgICAiemgiOnRoaXMuc3RyaW5nc196aCwKICAgICAgInJ1Ijp0aGlzLnN0cmluZ3NfcnUsCiAgICAgICJzdiI6dGhpcy5zdHJpbmdzX3N2CiAgICB9LAoKICAgIGkxOG4uc3RyaW5nc19lc1toZWxwX3RleHRdID0gaTE4bi5oZWxwX2VzOwogICAgaTE4bi5zdHJpbmdzX2NhW2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfY2E7CiAgICBpMThuLnN0cmluZ3NfY3NbaGVscF90ZXh0XSA9IGkxOG4uaGVscF9jczsKICAgIGkxOG4uc3RyaW5nc19ubFtoZWxwX3RleHRdID0gaTE4bi5oZWxwX25sOwogICAgaTE4bi5zdHJpbmdzX2RlW2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfZGU7CiAgICBpMThuLnN0cmluZ3NfcGxbaGVscF90ZXh0XSA9IGkxOG4uaGVscF9wbDsKICAgIGkxOG4uc3RyaW5nc19mcltoZWxwX3RleHRdID0gaTE4bi5oZWxwX2ZyOwogICAgaTE4bi5zdHJpbmdzX2h1W2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfaHU7CiAgICBpMThuLnN0cmluZ3NfaXRbaGVscF90ZXh0XSA9IGkxOG4uaGVscF9pdDsKICAgIGkxOG4uc3RyaW5nc19lbFtoZWxwX3RleHRdID0gaTE4bi5oZWxwX2VsOwogICAgaTE4bi5zdHJpbmdzX2phW2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfamE7CiAgICBpMThuLnN0cmluZ3NfemhbaGVscF90ZXh0XSA9IGkxOG4uaGVscF96aDsKICAgIGkxOG4uc3RyaW5nc19ydVtoZWxwX3RleHRdID0gaTE4bi5oZWxwX3J1OwogICAgaTE4bi5zdHJpbmdzX3N2W2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfc3Y7CgogICAgdzNjX3NsaWR5LmxhbmcgPSBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJsYW5nIik7CgogICAgaWYgKCF3M2Nfc2xpZHkubGFuZykKICAgICAgdzNjX3NsaWR5LmxhbmcgPSBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJ4bWw6bGFuZyIpOwoKICAgIGlmICghdzNjX3NsaWR5LmxhbmcpCiAgICAgIHczY19zbGlkeS5sYW5nID0gImVuIjsKICB9Cn07CgovLyBoYWNrIGZvciBiYWNrIGJ1dHRvbiBiZWhhdmlvcgppZiAodzNjX3NsaWR5LmllNiB8fCB3M2Nfc2xpZHkuaWU3KQp7CiAgZG9jdW1lbnQud3JpdGUoIjxpZnJhbWUgaWQ9J2hpc3RvcnlGcmFtZScgIiArCiAgInNyYz0namF2YXNjcmlwdDpcIjxodG1sIisiPjwvIisiaHRtbD5cIicgIiArCiAgImhlaWdodD0nMScgd2lkdGg9JzEnICIgKwogICJzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7bGVmdDotODAwcHgnPjwvaWZyYW1lPiIpOwp9CgovLyBhdHRhY2ggZXZlbnQgbGlzdGVuZXJzIGZvciBpbml0aWFsaXphdGlvbgp3M2Nfc2xpZHkuc2V0X3VwKCk7CgovLyBoaWRlIHRoZSBzbGlkZXMgYXMgc29vbiBhcyBib2R5IGVsZW1lbnQgaXMgYXZhaWxhYmxlCi8vIHRvIHJlZHVjZSBhbm5veWluZyBzY3JlZW4gbWVzcyBiZWZvcmUgdGhlIG9ubG9hZCBldmVudApzZXRUaW1lb3V0KHczY19zbGlkeS5oaWRlX3NsaWRlcywgNTApOwoK"></script>
  <script>(function() {
  if (!window.w3c_slidy) return;
  if (!window.Shiny) return;
  if (!window.$) return;
  // whenever a slide changes, tell shiny to recalculate what is displayed
  window.w3c_slidy.add_observer(function (slide_num) {
    // slide_num starts at position 1
    $(w3c_slidy.slides[slide_num - 1]).trigger("shown");
  });
})()
</script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Autocorrelation Functions in NIMBLE</h1>
  <p class="author">
NIMBLE Development Team
  </p>
  <p class="date">October 2024</p>
</div>
<div class="slide section level1">

<style>
slides > slide {
overflow-x: auto !important;
overflow-y: auto !important;
}
</style>
</div>
<div id="agenda-for-this-module" class="slide section level1">
<h1>Agenda for this module</h1>
<p>(We will very likely skip some topics due to time constraints, but
they are included in these slides anyway for your interest and
questions.)</p>
<ul>
<li><p>Spatial models (also useful as non-parametric regression
components)</p>
<ul>
<li>Conditional auto-regressive (CAR) models</li>
<li>Gaussian process models defined by correlation decaying with
distance.</li>
<li>Gaussian process models defined by spline basis functions</li>
</ul></li>
<li><p>Non-parametric distributions</p></li>
<li><p>Variable selection with indicator variables and reversible jump
MCMC (RJMCMC)</p></li>
</ul>
</div>
<div id="intrinsic-conditional-autoregressive-icar-models" class="slide section level1">
<h1>Intrinsic conditional autoregressive (ICAR) models</h1>
<p>Intuitively expressed as one-at-a-time conditionals:</p>
<p><span class="math display">\[ x_i|x_{-i} \sim N\left(\frac{1}{n_i}
\sum_{j\in N_i} x_j, \frac{1}{n_i \tau}\right) \]</span></p>
<p>The prior for each <span class="math inline">\(x_i\)</span> has:</p>
<ul>
<li>mean: the mean of its neighbors</li>
<li>variance: inversely proportional to the number of neighbors.</li>
</ul>
<p>This seems paradoxical, but it works.</p>
<p>Model code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span>N] <span class="sc">~</span> <span class="fu">dcar_normal</span>(adj[<span class="dv">1</span><span class="sc">:</span>L], weights[<span class="dv">1</span><span class="sc">:</span>L], num[<span class="dv">1</span><span class="sc">:</span>N], </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>                     tau, c, zero_mean)</span></code></pre></div>
<p>NIMBLE’s MCMC configuration will use a special sampler that updates
each <code>x[i]</code> one by one (using conditionality).</p>
</div>
<div id="icar-cont-what-does-intrinsic-mean" class="slide section level1">
<h1>ICAR (cont): What does ‘intrinsic’ mean?</h1>
<p>This is an <strong>improper prior</strong> because it does not
integrate to one.</p>
<p>The value of the prior doesn’t change if you shift all the <span class="math inline">\(x_{i}\)</span> values by a constant.</p>
<p>Thus the model implicitly includes an intercept with a flat
prior.</p>
<p>Often one would therefore exclude an overall intercept from the model
(<code>zero_mean=TRUE</code>).</p>
<p>It is usually fine to use <code>zero_mean=FALSE</code>.</p>
<p>This is also weird because the marginal prior variance of each <span class="math inline">\(x_i\)</span> is infinite, but it works.</p>
<p>(This is akin to a non-stationary (unit root) AR(1) model with <span class="math inline">\(\rho = 1\)</span>:</p>
<p><span class="math display">\[ x_i \sim N(\rho x_{i-1}, \sigma^2)
\]</span></p>
<p>which is generally frowned upon in the time series literature. But
it’s often recommended in the spatial context.)</p>
</div>
<div id="icar-cont-neighborhoodadjacency-information" class="slide section level1">
<h1>ICAR (cont): Neighborhood/adjacency information</h1>
<p>Suppose we have 4 spatial locations in a square grid:</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6OgA6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZjpmkLZmkNtmtrZmtttmtv+QOgCQZjqQttuQ2/+2ZgC2Zjq2kGa2ttu229u22/+2///bkDrbtmbbtpDb27bb////tmb/25D/27b/29v//7b//9v///9+4yCkAAAACXBIWXMAAAsSAAALEgHS3X78AAAE30lEQVR4nO3dbXcTVRhG4UltRawivr8QwZqiBQn//+c5Z5K2QdZyP6fPTOg52fsDiy/kDheZaZKS6fDe/rfhU9+Bx55AkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFAGaOijBYESf7aZCYEEyk0IJFBuQiCBchMCCZSbEEig3IRAAuUmBBIoNyGQQLkJgQTKTQgkUG5CIIFyEwIJlJsQSKDchEAC5SaOCbR9/e0wDJ99//diE++eDRcVtx6ZOCLQm+f7/2+y+mGpifXQMNCbJ/f/JefrZSZuhoaBtr+MD52fxnv/V3kg/bzExHiANQw0/uuuXky/K1SfLzBRbrddoHLvbw+s0ersz/knNsPwtF2g8eG/fwBNZ6MFgMZbvbhuF+iwm/hfIz4xPkRXLypuOTrxCYDKuTT6ZSw+sSk32gPQ9uWT+Dk6PrGjaR5o94VmFX8uHZ3Yn+KaB5qeqQyrr2YHWu+eWrUP9M2X330xDPdf0GaauNkftc0DTb19HheKTYwPzN3zhj6Aap5KhybK7e1eu3QCdPCyY5aJzZ13L0DlXB17uRqZOHhi3gvQ/TExx8Tmow84Rd8riEwI9EiAPngFPx4UM56D+gAq7yfe3e/4O6OVd6/lc9CIcna1++11/E3XEwIqD6HpRdjbXyve9zshoOlxc9t58P2ykwJ6f333bY3L2V+s7msb6PYbh5dXi000DtTkhEAC5SYEEig3IZBAuQmBBMpNCCRQbkIggXITAgmUmxBIoNyEQALlJgQSKDeRAuqjBYESf7aZCYEEyk0IJFBuQiCBchMCCZSbEEig3IRAAuUmBBIoNyGQQLkJgQTKTQgkUG5CIIFyEwI9NqB3z2o+cxue+Ofl02EYVpd/VN+hxwa0rvpQcnBi+/vd90njH9aLTRwbqHyGe3ag3WWJ9oU/7hmbODLQ9Bn32YHKrZ6Xg2u6RmP48lahiaMC7Y+EuYHKpUBuVdYVFycKTRwT6PX+Yq5zAx1edrDmCnKhieMBTSeK1Y/hy3bEJzaHh9W69hh7NEDl3/biKn5dkwdMlDYNA53/VnPhlwdMlNbtHmKvpl8XBqq8fZ449vOgpYEqLqQbm+gMqP6L2GkBlVuvvTbFKQFt658mnhTQdFX4ujM0T3QE9DCf0wGquQJqxUQ3QOUSYGcVVyaKTvQCVC4AVn1tpchEJ0DlHaH4VaprJvoAKj+SpfL5YXSiC6By/nmozykA1fyol+qJHoBu/vMBsLpXq/0DffA9DYE+bvejFnoBam5CIIFyEwIJlJsQSKDchEAC5SYEEig3IZBAuQmBBMpNCCRQbkIggXITAgmUmxBIoNyEQALlJgQSKDeRAuqj5YBOIoEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBoH8BNOkSNsV725IAAAAASUVORK5CYII=" width="144" /></p>
<p>Then we would have:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># each location has two neighbors</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>adj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>,        <span class="co"># neighbors of loc&#39;n 1</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>          <span class="dv">1</span>, <span class="dv">4</span>,         <span class="co"># neighbors of loc&#39;n 2</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>          <span class="dv">1</span>, <span class="dv">4</span>,         <span class="co"># etc.</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>          <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<p>There are various NIMBLE and R functions for producing
<code>adj</code> and <code>num</code> from shapefiles and other
geographic formats.</p>
</div>
<div id="icar-cont-example-disease-mapping" class="slide section level1">
<h1>ICAR (cont): Example: disease mapping</h1>
<ul>
<li><p>(Classic) example: hospital admissions due to respiratory disease
in 2010 from the 134 Intermediate Geographies (IG) north of the river
Clyde in the Greater Glasgow and Clyde health board.</p></li>
<li><p>Data available in the <code>CARBayesdata</code> package.</p></li>
<li><p>Transform into neighborhood information using functions from the
<code>spdep</code> package.</p></li>
<li><p>We need vectors indicating</p>
<ul>
<li>which regions are neighbors of which other regions
(<code>adj</code>),</li>
<li>weights for each pair of neighbors (<code>weights</code>),</li>
<li>the number of neighbors for each region (<code>num</code>) (to
unpack <code>adj</code> correctly).</li>
</ul></li>
<li><p>Modeled mean of the Poisson counts includes an offset for the
expected count (e.g. population size).</p></li>
<li><p>Covariate: the percentage of people defined as income-deprived in
each region.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(CARBayesdata, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning: package &#39;CARBayesdata&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(sp, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
## which was just loaded, will retire in October 2023.
## Please refer to R-spatial evolution reports for details, especially
## https://r-spatial.org/r/2023/05/15/evolution4.html.
## It may be desirable to make the sf package available;
## package maintainers should consider adding sf to Suggests:.
## The sp package is now running under evolution status 2
##      (status 2 uses the sf package in place of rgdal)</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(spdep, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## To access larger datasets in this package, install the spDataLarge
## package with: `install.packages(&#39;spDataLarge&#39;,
## repos=&#39;https://nowosad.github.io/drat/&#39;, type=&#39;source&#39;)`</code></pre>
<pre><code>## Warning: package &#39;sf&#39; was built under R version 4.3.3</code></pre>
<pre><code>## Linking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(classInt)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">## data(GGHB.IG) ## apparently no longer in CARBayesdata</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/GGHB.IG.Rda&#39;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">data</span>(respiratorydata)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>respiratorydata_sp <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> GGHB.IG, <span class="at">y =</span> respiratorydata, <span class="at">by.x =</span> <span class="st">&quot;IG&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                            <span class="at">by.y =</span> <span class="st">&quot;IZ&quot;</span>, <span class="at">all.x =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>respiratorydata_sp <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(respiratorydata_sp,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                                  <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span>))</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>) { </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="co"># This will produce an image on top of an OpenStreetMap webpage}</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>  <span class="fu">library</span>(leaflet)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="at">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>, <span class="at">domain =</span> respiratorydata_sp<span class="sc">@</span>data<span class="sc">$</span>SMR)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  map2 <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(<span class="at">data=</span>respiratorydata_sp) <span class="sc">%&gt;%</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    <span class="fu">addPolygons</span>(<span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">colors</span>(SMR), <span class="at">color=</span><span class="st">&quot;&quot;</span>, <span class="at">weight=</span><span class="dv">1</span>,</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>                <span class="at">fillOpacity =</span> <span class="fl">0.7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="fu">addLegend</span>(<span class="at">pal =</span> colors, <span class="at">values =</span> respiratorydata_sp<span class="sc">@</span>data<span class="sc">$</span>SMR, <span class="at">opacity =</span> <span class="dv">1</span>,</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>              <span class="at">title=</span><span class="st">&quot;SMR&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>    <span class="fu">addScaleBar</span>(<span class="at">position=</span><span class="st">&quot;bottomleft&quot;</span>)</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  map2</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>}</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co"># Instead, make a simple map in R</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>temp.colors<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">n =</span> <span class="dv">25</span>) {</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>  blues <span class="ot">&lt;-</span> <span class="fu">hsv</span>(<span class="at">h=</span>.<span class="dv">65</span>, <span class="at">s=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="at">length=</span>m<span class="sc">+</span><span class="dv">1</span>)[<span class="dv">1</span><span class="sc">:</span>m])</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>  reds <span class="ot">&lt;-</span> <span class="fu">hsv</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">s=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="at">length=</span>m<span class="sc">+</span><span class="dv">1</span>)[<span class="dv">1</span><span class="sc">:</span>m])</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>  <span class="fu">c</span>(blues,<span class="cf">if</span>(n<span class="sc">%%</span><span class="dv">2</span><span class="sc">!=</span><span class="dv">0</span>) <span class="st">&quot;#FFFFFF&quot;</span>, reds[m<span class="sc">:</span><span class="dv">1</span>])</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>}</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(respiratorydata_sp<span class="sc">@</span>data<span class="sc">$</span>SMR ,<span class="at">style =</span> <span class="st">&quot;fixed&quot;</span>,</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>                    <span class="at">fixedBreaks=</span><span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">1.7</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">temp.colors</span>(<span class="dv">12</span>)</span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">findColours</span>(q, pal)</span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="fu">plot</span>(respiratorydata_sp, <span class="at">col =</span> col, <span class="at">border =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">lwd =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="432" /></p>
</div>
<div id="icar-cont-neighborhoodadjacency-information-1" class="slide section level1">
<h1>ICAR (cont): Neighborhood/adjacency information</h1>
<p>We handle the neighborhood structure here with <code>nb2WB</code>
from the package <code>spdep</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>W_nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(respiratorydata_sp, <span class="at">row.names =</span>  <span class="fu">rownames</span>(respiratorydata_sp<span class="sc">@</span>data))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="do">## Determine neighborhood/adjacency information needed for neighborhood-based CAR model</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>nbInfo <span class="ot">&lt;-</span> <span class="fu">nb2WB</span>(W_nb)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># A vector of indices indicating which regions are neighbors of which.</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">head</span>(nbInfo<span class="sc">$</span>adj, <span class="at">n =</span> <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  [1]   2   3   5  87  91  93   1   3  91 113   1   2   5  11 113   6   7  10  98
## [20] 101 105 106   1   3   9  11  19  87  90 104</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># A vector of weights. In this case, all weights are 1.</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">head</span>(nbInfo<span class="sc">$</span>weights)</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># A vector of length N indicating how many neighbors each region has.</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># This helps map the adj vector to each region.</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>nbInfo<span class="sc">$</span>num</span></code></pre></div>
<pre><code>##   [1]  6  4  5  7  9  5  5  5  4  7  7 11  4  4  7  5  6  5  6 10  3  8  2  4  4
##  [26]  4  2  4  4  4  5  2  4  6  3  4  5  6  7  4  6  6  8  6  6  5  6  4  3  5
##  [51]  3  6  4  5  9  7  3  4  7  6  7  7  8  5  6  4  4  6  4  5  5  7  6  6  5
##  [76]  6  5  6  6  5  6  5  5  5 10  7  6  9  4  6  7  5  5  5  7  6  4  6  5  5
## [101]  6  6  5  5  7  6  7  7  8  5  3  6 10  5  2  3  4  5  7  4  5  8  4  4  3
## [126]  8  5  1  4  4  4  7  3  2</code></pre>
<p>Now we have the three pieces of information we need. We’re ready to
use the <code>dcar_normal</code> distribution in a nimble model.</p>
</div>
<div id="icar-cont-nimble-model" class="slide section level1">
<h1>ICAR (cont): nimble model</h1>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>code <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="co"># priors</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  beta <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">100</span>)   <span class="co"># prior for variance components based on Gelman (2006)</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="co"># latent process</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span>N] <span class="sc">~</span> <span class="fu">dcar_normal</span>(adj[<span class="dv">1</span><span class="sc">:</span>L], weights[<span class="dv">1</span><span class="sc">:</span>L], num[<span class="dv">1</span><span class="sc">:</span>N], tau, <span class="at">zero_mean =</span> <span class="dv">0</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="co"># likelihood</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    lambda[i] <span class="ot">&lt;-</span> expected[i] <span class="sc">*</span> <span class="fu">exp</span>(beta<span class="sc">*</span>z[i] <span class="sc">+</span> x[i])</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    y[i] <span class="sc">~</span> <span class="fu">dpois</span>(lambda[i])</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  }</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>})</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>z <span class="ot">&lt;-</span> respiratorydata_sp<span class="sc">$</span>incomedep</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>z <span class="ot">&lt;-</span> z <span class="sc">-</span> <span class="fu">mean</span>(z)  <span class="co"># center for improved MCMC performance</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>nregions <span class="ot">&lt;-</span> <span class="fu">nrow</span>(respiratorydata_sp)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>expected <span class="ot">&lt;-</span> respiratorydata_sp<span class="sc">$</span>expected</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>y <span class="ot">&lt;-</span> respiratorydata_sp<span class="sc">$</span>observed</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>constants <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">N =</span> nregions, <span class="at">L =</span> <span class="fu">length</span>(nbInfo<span class="sc">$</span>adj), </span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>                  <span class="at">adj =</span> nbInfo<span class="sc">$</span>adj, <span class="at">weights =</span> nbInfo<span class="sc">$</span>weights, <span class="at">num =</span> nbInfo<span class="sc">$</span>num,</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>                  <span class="at">z =</span> z, <span class="at">expected =</span> expected)</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y =</span> y)</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">x =</span> <span class="fu">rnorm</span>(nregions))</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">nimbleModel</span>(code, <span class="at">constants =</span> constants, <span class="at">data =</span> data, <span class="at">inits =</span> inits)</span></code></pre></div>
<pre><code>## Defining model</code></pre>
<pre><code>## Building model</code></pre>
<pre><code>## Setting data and initial values</code></pre>
<pre><code>## Running calculate on model
##   [Note] Any error reports that follow may simply reflect missing values in model variables.</code></pre>
<pre><code>## Checking model sizes and dimensions</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>cModel <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(model)</span></code></pre></div>
<pre><code>## Compiling
##   [Note] This may take a minute.
##   [Note] Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>conf <span class="ot">&lt;-</span> <span class="fu">configureMCMC</span>(model, <span class="at">monitors =</span> <span class="fu">c</span>(<span class="st">&#39;beta&#39;</span>, <span class="st">&#39;sigma&#39;</span>, <span class="st">&#39;x&#39;</span>))</span></code></pre></div>
<pre><code>## ===== Monitors =====
## thin = 1: beta, sigma, x
## ===== Samplers =====
## RW sampler (2)
##   - beta
##   - sigma
## CAR_normal sampler (1)
##   - x[1:134]</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>conf<span class="sc">$</span><span class="fu">printSamplers</span>()</span></code></pre></div>
<pre><code>## [1] RW sampler: beta
## [2] RW sampler: sigma
## [3] CAR_normal sampler: x[1:134]</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>MCMC <span class="ot">&lt;-</span> <span class="fu">buildMCMC</span>(conf)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>cMCMC <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(MCMC, <span class="at">project =</span> cModel)</span></code></pre></div>
<pre><code>## Compiling
##   [Note] This may take a minute.
##   [Note] Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">runMCMC</span>(cMCMC, <span class="at">niter =</span> <span class="dv">5000</span>, <span class="at">nburnin =</span> <span class="dv">1000</span>, <span class="at">thin =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## running chain 1...</code></pre>
<pre><code>## |-------------|-------------|-------------|-------------|
## |-------------------------------------------------------|</code></pre>
</div>
<div id="icar-cont-results" class="slide section level1">
<h1>ICAR (cont): Results</h1>
<p>MCMC mixing looks pretty good (not always the case for spatial
models).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;sigma&#39;</span>], <span class="at">main =</span> <span class="st">&#39;sigma&#39;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;x[5]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[5]&#39;</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;x[50]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[50]&#39;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;beta&#39;</span>], <span class="at">main =</span> <span class="st">&#39;beta&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="432" /></p>
<p>We can look at the map of the estimated relative risks. Note the
scale is very different than of the standardized mortality ratio raw
values.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>xCols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&#39;^x</span><span class="sc">\\</span><span class="st">[&#39;</span>, <span class="fu">colnames</span>(samples))</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>xEstCAR <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(samples[ , xCols])</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(xEstCAR,<span class="at">style =</span> <span class="st">&quot;fixed&quot;</span>,<span class="at">fixedBreaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">temp.colors</span>(<span class="dv">16</span>)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">findColours</span>(q, pal)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="fu">plot</span>(respiratorydata_sp, <span class="at">col =</span> col, <span class="at">border =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">lwd =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="432" /></p>
</div>
<div id="proper-car-model-we-will-not-cover-this" class="slide section level1">
<h1>Proper CAR model (we will not cover this)</h1>
<p>One can avoid the improper ICAR prior by using what looks like a time
series AR(1) model. Omitting any weights and with mean zero, the
simplest case is:</p>
<p><span class="math display">\[ x_i|x_{-i} \sim N \left(\frac{1}{n_i}
\rho \sum_{j\in N_i} x_j, \frac{1}{n_i \tau}\right) \]</span></p>
<p>The presence of <span class="math inline">\(\rho\)</span> causes the
prior to be proper (under certain constraints on <span class="math inline">\(\rho\)</span>).</p>
<p>This looks more like the usual AR(1) model with the somewhat
non-intuitive property that the prior mean is a proportion of the
average of the neighbors. The result is a model where the relationship
of <span class="math inline">\(\rho\)</span> to the spatial correlation
structure is not intuitive and even modest spatial correlation results
in very large values of <span class="math inline">\(\rho\)</span>.</p>
<p>Note: when the number of neighbors is roughly the same for all
locations the Leroux model can be seen to be approximately a variation
on this model.</p>
</div>
<div id="gaussian-processes" class="slide section level1">
<h1>Gaussian processes</h1>
<ul>
<li>Multivariate normal priors at a finite set of locations.</li>
<li>Correlation between points decays with distance by some function
with parameters to estimate.</li>
<li>No special nimble functionality if needed.</li>
<li>Sometimes used for areal data, evaluated at the centroids of the
areas.</li>
<li>More commonly used for continuous data or regularly-gridded
data.</li>
<li>For simplicity, we’ll use the example from the CAR model
(above).</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>code <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  mu0 <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">100</span>)  <span class="co"># prior for variance components based on Gelman (2006)</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  rho <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>  beta <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>  </span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>  <span class="co"># latent spatial process</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>  mu[<span class="dv">1</span><span class="sc">:</span>N] <span class="ot">&lt;-</span> mu0<span class="sc">*</span>ones[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  cov[<span class="dv">1</span><span class="sc">:</span>N, <span class="dv">1</span><span class="sc">:</span>N] <span class="ot">&lt;-</span> sigma<span class="sc">*</span>sigma<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>dists[<span class="dv">1</span><span class="sc">:</span>N, <span class="dv">1</span><span class="sc">:</span>N] <span class="sc">/</span> rho)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span>N] <span class="sc">~</span> <span class="fu">dmnorm</span>(mu[<span class="dv">1</span><span class="sc">:</span>N], <span class="at">cov =</span> cov[<span class="dv">1</span><span class="sc">:</span>N, <span class="dv">1</span><span class="sc">:</span>N])</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>  <span class="co"># likelihood</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>    lambda[i] <span class="ot">&lt;-</span> expected[i] <span class="sc">*</span> <span class="fu">exp</span>(beta<span class="sc">*</span>z[i] <span class="sc">+</span> x[i])</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>    y[i] <span class="sc">~</span> <span class="fu">dpois</span>(lambda[i])</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>  }</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>})</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>locs <span class="ot">&lt;-</span>  <span class="fu">as.matrix</span>(respiratorydata_sp<span class="sc">@</span>data[ , <span class="fu">c</span>(<span class="st">&#39;easting&#39;</span>, <span class="st">&#39;northing&#39;</span>)]) <span class="sc">/</span> <span class="fl">1e5</span></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(locs))</span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a>dists <span class="ot">&lt;-</span> dists <span class="sc">/</span> <span class="fu">max</span>(dists)  <span class="co"># normalize to max distance of 1</span></span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a>constants <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">N =</span> nregions, <span class="at">dists =</span> dists, <span class="at">ones =</span> <span class="fu">rep</span>(<span class="dv">1</span>, nregions),</span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a>                            <span class="at">z =</span> z, <span class="at">expected =</span> expected)</span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y =</span> y)</span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta =</span> <span class="dv">0</span>, <span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">rho =</span> <span class="fl">0.2</span>)</span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a><span class="do">## setup initial spatially-correlated latent process values</span></span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a>inits_cov <span class="ot">&lt;-</span> inits<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>dists <span class="sc">/</span> inits<span class="sc">$</span>rho)</span>
<span id="cb37-31"><a href="#cb37-31" tabindex="-1"></a>inits<span class="sc">$</span>x <span class="ot">&lt;-</span>  <span class="fu">t</span>(<span class="fu">chol</span>(inits_cov)) <span class="sc">%*%</span> <span class="fu">rnorm</span>(nregions)</span>
<span id="cb37-32"><a href="#cb37-32" tabindex="-1"></a>inits<span class="sc">$</span>x <span class="ot">&lt;-</span> inits<span class="sc">$</span>x[ , <span class="dv">1</span>]  <span class="co"># so can give nimble a vector rather than one-column matrix</span></span>
<span id="cb37-33"><a href="#cb37-33" tabindex="-1"></a></span>
<span id="cb37-34"><a href="#cb37-34" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">nimbleModel</span>(code, <span class="at">constants =</span> constants, <span class="at">data =</span> data, <span class="at">inits =</span> inits)</span></code></pre></div>
<pre><code>## Defining model</code></pre>
<pre><code>## Building model</code></pre>
<pre><code>## Setting data and initial values</code></pre>
<pre><code>## Running calculate on model
##   [Note] Any error reports that follow may simply reflect missing values in model variables.</code></pre>
<pre><code>## Checking model sizes and dimensions</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>cModel <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(model)</span></code></pre></div>
<pre><code>## Compiling
##   [Note] This may take a minute.
##   [Note] Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
</div>
<div id="gaussian-processes-continued-running-an-mcmc" class="slide section level1">
<h1>Gaussian processes (continued): Running an MCMC</h1>
<p>In order to improve mixing, we’ll customize a tuning parameter for
the block random walk (Metropolis) sampler on the latent spatial
values.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>conf <span class="ot">&lt;-</span> <span class="fu">configureMCMC</span>(model)</span></code></pre></div>
<pre><code>## ===== Monitors =====
## thin = 1: beta, mu0, rho, sigma
## ===== Samplers =====
## RW_block sampler (1)
##   - x[1:134] 
## RW sampler (4)
##   - mu0
##   - sigma
##   - rho
##   - beta</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>conf<span class="sc">$</span><span class="fu">addMonitors</span>(<span class="st">&#39;x&#39;</span>)</span></code></pre></div>
<pre><code>## thin = 1: beta, mu0, rho, sigma, x</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>conf<span class="sc">$</span><span class="fu">removeSamplers</span>(<span class="st">&#39;x[1:134]&#39;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="do">## Changing a tunable parameter in the adaptation of RW_block makes a big difference.</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>conf<span class="sc">$</span><span class="fu">addSampler</span>(<span class="st">&#39;x[1:134]&#39;</span>, <span class="st">&#39;RW_block&#39;</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adaptFactorExponent =</span> <span class="fl">0.25</span>))</span></code></pre></div>
<pre><code>##   [Note] Assigning an RW_block sampler to nodes with very different scales can result in low MCMC efficiency.  If all nodes assigned to RW_block are not on a similar scale, we recommend providing an informed value for the &quot;propCov&quot; control list argument, or using the &quot;barker&quot; sampler instead.</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>MCMC <span class="ot">&lt;-</span> <span class="fu">buildMCMC</span>(conf)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>cMCMC <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(MCMC, <span class="at">project =</span> cModel)</span></code></pre></div>
<pre><code>## Compiling
##   [Note] This may take a minute.
##   [Note] Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">runMCMC</span>(cMCMC, <span class="at">niter =</span> <span class="dv">10000</span>, <span class="at">nburnin =</span> <span class="dv">5000</span>, <span class="at">thin =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## running chain 1...</code></pre>
<pre><code>## |-------------|-------------|-------------|-------------|
## |-------------------------------------------------------|</code></pre>
</div>
<div id="gaussian-processes-continued-results" class="slide section level1">
<h1>Gaussian processes (continued): Results</h1>
<p>MCMC mixing could be better (often the case for spatial models), but
is not terrible. We’d want to run for longer.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;rho&#39;</span>], <span class="at">main =</span> <span class="st">&#39;rho&#39;</span>)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;sigma&#39;</span>], <span class="at">main =</span> <span class="st">&#39;sigma&#39;</span>)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;beta&#39;</span>], <span class="at">main =</span> <span class="st">&#39;beta&#39;</span>)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;x[5]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[5]&#39;</span>)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;x[50]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[50]&#39;</span>)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a><span class="fu">ts.plot</span>(samples[ , <span class="st">&#39;x[100]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[100]&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="360" /></p>
<p>We can look at the map of the estimated relative risks. Note the
scale is very different than of the standardized mortality ratio raw
values.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>xCols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&#39;^x</span><span class="sc">\\</span><span class="st">[&#39;</span>, <span class="fu">colnames</span>(samples))</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>xEstGP <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(samples[ , xCols])</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(xEstGP, <span class="at">style =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">fixedBreaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="at">by =</span> <span class="fl">0.2</span>))</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">temp.colors</span>(<span class="dv">12</span>)</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">findColours</span>(q, pal)</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a><span class="fu">plot</span>(respiratorydata_sp, <span class="at">col =</span> col, <span class="at">border =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">lwd =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="432" /></p>
</div>
<div id="large-spatial-models-and-spatial-nonstationarity" class="slide section level1">
<h1>Large spatial models and spatial nonstationarity</h1>
<p>The <code>BayesNSGP</code> package has functionality for fitting such
models efficiently based on recent advances in the literature.</p>
</div>
<div id="splines-for-spatial-models-or-other-nonparametric-regression" class="slide section level1">
<h1>Splines (for spatial models or other nonparametric regression)</h1>
<ul>
<li><p>Another kind of Gaussian process.</p></li>
<li><p><code>mgcv</code> is a major spline/GAM package and has functions
to set up pieces for use in JAGS or NIMBLE. <code>mgcv</code> can handle
all sorts of sophisticated smoothing problems, including:</p>
<ul>
<li>tensor products of space and time or of different covariates</li>
<li>cyclic splines (e.g., for seasonality, diurnal behavior)</li>
<li>monotonicity and other shape constraints</li>
<li>boundary effects</li>
</ul></li>
</ul>
<p>For example, Stoner and Economou (2020; Computational Statistics and
Data Analysis; <a href="https://arxiv.org/abs/1906.03846" class="uri">https://arxiv.org/abs/1906.03846</a>) used mgcv-based spline
terms in a NIMBLE model for precipitation, handling seasonality with
cyclic splines.</p>
</div>
<div id="splines-cont-setup-from-mgcv" class="slide section level1">
<h1>Splines (cont): setup from <code>mgcv</code></h1>
<ul>
<li>(Technical: The spline penalty matrix serves as the inverse
correlation matrix for the prior. The spline smoothing parameter is a
variance or variance ratio.)</li>
</ul>
<p><span class="math display">\[ x = B \beta \]</span></p>
<p><span class="math display">\[ \beta \sim \mbox{MVN}(0, \mbox{prec} =
Q) \]</span></p>
<ul>
<li><code>B</code> are spline basis function evaluations (obtained from
<code>mgcv</code>)</li>
<li><code>beta</code> is a coefficient vector to be estimated</li>
<li><code>Q</code> is the spline penalty matrix (obtained from
<code>mgcv</code>) times a variance parameter to be estimated.</li>
<li>Actually the <code>Q</code> provided by <code>mgcv</code> includes
some unpenalized dimensions (constant and linear) so it needs to be
split into two pieces (penalized and unpenalized).</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">40</span> <span class="co"># number of spline basis functions</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="co"># fit a simple GAM to get a sense for number of basis functions; K = 40 might be too small...</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>) {</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">log</span>(expected) <span class="sc">+</span> z <span class="sc">+</span> <span class="fu">s</span>(locs, <span class="at">k =</span> K), <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  <span class="fu">summary</span>(mod)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">type =</span> <span class="st">&#39;terms&#39;</span>)[,<span class="dv">3</span>]</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>}</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="co"># ignore z to get basis info, but that may affect initial values.</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>out <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">jagam</span>(y <span class="sc">~</span> <span class="fu">log</span>(expected) <span class="sc">+</span> <span class="fu">s</span>(locs, <span class="at">k =</span> K) <span class="sc">-</span><span class="dv">1</span>, <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>                   <span class="at">na.action =</span> na.pass, <span class="at">file =</span> <span class="st">&#39;blank.jags&#39;</span>)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>B <span class="ot">&lt;-</span> out<span class="sc">$</span>jags.data<span class="sc">$</span>X[ , <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(B)   <span class="co"># actually only 39 basis functions</span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="do">## two components of precision matrix to ensure propriety</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a><span class="do">## of prior on coeffs (see Wood (2016) J Statistical Software)</span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> out<span class="sc">$</span>jags.data<span class="sc">$</span>S1[ , <span class="dv">1</span><span class="sc">:</span>K]</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> out<span class="sc">$</span>jags.data<span class="sc">$</span>S1[ , (K<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>K)]  </span></code></pre></div>
</div>
<div id="splines-cont-setting-up-the-model" class="slide section level1">
<h1>Splines (cont): Setting up the model</h1>
<p>We’ll stick with a simple spatial model (which means this could have
simply been fit using <code>mgcv::gam</code>):</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>codeS <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>  mu0 <span class="sc">~</span> <span class="fu">dflat</span>()</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  beta_z <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) </span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>    lambda[i]  <span class="sc">~</span> <span class="fu">dgamma</span>(.<span class="dv">05</span>, .<span class="dv">005</span>)  <span class="co"># based on jagam defaults</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  <span class="co"># latent process is product of (known) spline basis and (unknown) coefficients</span></span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  <span class="co"># two components to ensure propriety of prior on coeffs</span></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>  prec[<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span><span class="sc">:</span>K] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>] <span class="sc">*</span> Q1[<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span><span class="sc">:</span>K] <span class="sc">+</span> lambda[<span class="dv">2</span>] <span class="sc">*</span> Q2[<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span><span class="sc">:</span>K]</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>  beta_x[<span class="dv">1</span><span class="sc">:</span>K] <span class="sc">~</span> <span class="fu">dmnorm</span>(zeros[<span class="dv">1</span><span class="sc">:</span>K], prec[<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span><span class="sc">:</span>K])</span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span>N] <span class="ot">&lt;-</span>  (B[<span class="dv">1</span><span class="sc">:</span>N, <span class="dv">1</span><span class="sc">:</span>K] <span class="sc">%*%</span> beta_x[<span class="dv">1</span><span class="sc">:</span>K])[,<span class="dv">1</span>]</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  </span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>  <span class="co"># likelihood</span></span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a>    mu[i] <span class="ot">&lt;-</span> expected[i] <span class="sc">*</span> <span class="fu">exp</span>(mu0 <span class="sc">+</span> beta_z<span class="sc">*</span>z[i] <span class="sc">+</span> x[i])</span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>    y[i] <span class="sc">~</span> <span class="fu">dpois</span>(mu[i])</span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>  }</span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>})</span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>constantsS <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Q1 =</span> Q1, <span class="at">Q2 =</span> Q2, <span class="at">B =</span> B, <span class="at">K =</span> K, <span class="at">N =</span> nregions, <span class="at">z =</span> z, <span class="at">zeros =</span> <span class="fu">rep</span>(<span class="dv">0</span>, K), </span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>                            <span class="at">expected =</span> expected)</span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>dataS <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y =</span> y)</span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>initsS <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta_z =</span> <span class="dv">0</span>)</span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a><span class="do">## Use inits from jagam, but note that jagam call did not use &#39;z&#39; or have an intercept</span></span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a>initsS<span class="sc">$</span>beta_x <span class="ot">&lt;-</span>  out<span class="sc">$</span>jags.ini<span class="sc">$</span>b[<span class="dv">2</span><span class="sc">:</span>(K<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a>initsS<span class="sc">$</span>mu0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a>initsS<span class="sc">$</span>lambda <span class="ot">&lt;-</span> out<span class="sc">$</span>jags.ini<span class="sc">$</span>lambda</span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb59-30"><a href="#cb59-30" tabindex="-1"></a>modelS <span class="ot">&lt;-</span> <span class="fu">nimbleModel</span>(codeS, <span class="at">constants =</span> constantsS, <span class="at">data =</span> dataS, <span class="at">inits =</span> initsS)</span></code></pre></div>
<pre><code>## Defining model</code></pre>
<pre><code>## Building model</code></pre>
<pre><code>## Setting data and initial values</code></pre>
<pre><code>## Running calculate on model
##   [Note] Any error reports that follow may simply reflect missing values in model variables.</code></pre>
<pre><code>## Checking model sizes and dimensions</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>cModelS <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(modelS)</span></code></pre></div>
<pre><code>## Compiling
##   [Note] This may take a minute.
##   [Note] Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
</div>
<div id="splines-cont-running-an-mcmc" class="slide section level1">
<h1>Splines (cont): Running an MCMC</h1>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>confS <span class="ot">&lt;-</span> <span class="fu">configureMCMC</span>(modelS)</span></code></pre></div>
<pre><code>## ===== Monitors =====
## thin = 1: beta_z, lambda, mu0
## ===== Samplers =====
## RW_block sampler (1)
##   - beta_x[1:39] 
## RW sampler (4)
##   - mu0
##   - beta_z
##   - lambda[]  (2 elements)</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>confS<span class="sc">$</span><span class="fu">removeSamplers</span>(<span class="st">&#39;beta_x[1:39]&#39;</span>)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="co"># Using non-default value of 0.25 for a tuning parameter of the adaptive block sampler </span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a><span class="co"># helps a lot compared to default NIMBLE or to JAGS</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>confS<span class="sc">$</span><span class="fu">addSampler</span>(<span class="st">&#39;beta_x[1:39]&#39;</span>, <span class="st">&#39;RW_block&#39;</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adaptFactorExponent =</span> <span class="fl">0.25</span>))</span></code></pre></div>
<pre><code>##   [Note] Assigning an RW_block sampler to nodes with very different scales can result in low MCMC efficiency.  If all nodes assigned to RW_block are not on a similar scale, we recommend providing an informed value for the &quot;propCov&quot; control list argument, or using the &quot;barker&quot; sampler instead.</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>confS<span class="sc">$</span><span class="fu">addMonitors</span>(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;beta_x&#39;</span>)</span></code></pre></div>
<pre><code>## thin = 1: beta_x, beta_z, lambda, mu0, x</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>mcmcS <span class="ot">&lt;-</span> <span class="fu">buildMCMC</span>(confS)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>cmcmcS <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(mcmcS, <span class="at">project =</span> cModelS)</span></code></pre></div>
<pre><code>## Compiling
##   [Note] This may take a minute.
##   [Note] Use &#39;showCompilerOutput = TRUE&#39; to see C++ compilation details.</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>samplesS <span class="ot">&lt;-</span> <span class="fu">runMCMC</span>(cmcmcS, <span class="at">niter =</span> <span class="dv">100000</span>, <span class="at">nburnin =</span> <span class="dv">20000</span>, <span class="at">thin =</span> <span class="dv">80</span>)</span></code></pre></div>
<pre><code>## running chain 1...</code></pre>
<pre><code>## |-------------|-------------|-------------|-------------|
## |-------------------------------------------------------|</code></pre>
</div>
<div id="splines-cont-results" class="slide section level1">
<h1>Splines (cont): Results</h1>
<p>Mixing is decent (though that was a pretty long run). One could
explore other sampling strategies.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">ts.plot</span>(samplesS[ , <span class="st">&#39;lambda[1]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;lambda[1]&#39;</span>)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a><span class="fu">ts.plot</span>(samplesS[ , <span class="st">&#39;lambda[2]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;lambda[2]&#39;</span>)</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a><span class="fu">ts.plot</span>(samplesS[ , <span class="st">&#39;beta_z&#39;</span>], <span class="at">main =</span> <span class="st">&#39;beta_z&#39;</span>)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a><span class="fu">ts.plot</span>(samplesS[ , <span class="st">&#39;x[5]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[5]&#39;</span>)</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a><span class="fu">ts.plot</span>(samplesS[ , <span class="st">&#39;x[50]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[50]&#39;</span>)</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a><span class="fu">ts.plot</span>(samplesS[ , <span class="st">&#39;x[100]&#39;</span>], <span class="at">main =</span> <span class="st">&#39;x[100]&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="432" /></p>
<p>Here are the spatial estimates. Pretty different than the CAR or GP
results. We might want to explore larger values of K.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>xCols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&#39;^x</span><span class="sc">\\</span><span class="st">[&#39;</span>, <span class="fu">colnames</span>(samplesS))</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>xEstSpl <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(samplesS[ , xCols])</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(xEstSpl, <span class="at">style =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">fixedBreaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="at">by =</span> <span class="fl">0.04</span>))</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">temp.colors</span>(<span class="dv">10</span>)</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">findColours</span>(q, pal)</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a><span class="fu">plot</span>(respiratorydata_sp, <span class="at">col =</span> col, <span class="at">border =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">lwd =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="432" /></p>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
